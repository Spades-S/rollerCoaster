{"version":3,"sources":["../../../../www/static/cropper/cropper.esm.js"],"names":["DEFAULTS","viewMode","dragMode","aspectRatio","NaN","data","preview","responsive","restore","checkCrossOrigin","checkOrientation","modal","guides","center","highlight","background","autoCrop","autoCropArea","movable","rotatable","scalable","zoomable","zoomOnTouch","zoomOnWheel","wheelZoomRatio","cropBoxMovable","cropBoxResizable","toggleDragModeOnDblclick","minCanvasWidth","minCanvasHeight","minCropBoxWidth","minCropBoxHeight","minContainerWidth","minContainerHeight","ready","cropstart","cropmove","cropend","crop","zoom","TEMPLATE","REGEXP_DATA_URL_HEAD","REGEXP_USERAGENT","navigator","window","IS_SAFARI_OR_UIWEBVIEW","test","userAgent","fromCharCode","String","isNumber","n","isNaN","isUndefined","toArray","obj","offset","args","push","slice","apply","proxy","fn","context","_len","arguments","length","Array","_key","_len2","args2","_key2","concat","objectKeys","keys","each","key","isCrossOriginURL","url","parts","match","location","protocol","hostname","port","addTimestamp","timestamp","Date","getTime","indexOf","getImageSize","image","callback","naturalWidth","naturalHeight","newImage","document","createElement","onload","load","width","height","src","getTransform","options","transforms","translateX","translateY","rotate","scaleX","scaleY","join","getRotatedSizes","isReversed","deg","Math","abs","degree","arc","PI","sinArc","sin","cosArc","cos","newWidth","newHeight","getSourceCanvas","canvas","getContext","dstX","dstY","dstWidth","dstHeight","advanced","canvasWidth","canvasHeight","rotated","fillColor","fillStyle","fillRect","save","translate","scale","imageSmoothingEnabled","imageSmoothingQuality","drawImage","floor","getStringFromCharCode","dataView","start","str","i","getUint8","getOrientation","arrayBuffer","DataView","byteLength","orientation","exifIDCode","tiffOffset","firstIFDOffset","littleEndian","endianness","app1Start","ifdStart","getUint16","getUint32","setUint16","dataURLToArrayBuffer","dataURL","base64","replace","binary","atob","ArrayBuffer","Uint8Array","charCodeAt","arrayBufferToDataURL","btoa","render$1","render","self","initContainer","initCanvas","initCropBox","renderCanvas","cropped","renderCropBox","$this","$element","$container","$cropper","hidden","addClass","removeClass","css","container","max","Number","containerWidth","containerHeight","imageNaturalWidth","imageNaturalHeight","is90Degree","oldLeft","left","oldTop","top","limited","limitCanvas","initialImage","extend","initialCanvas","isSizeLimited","isPositionLimited","cropBox","minWidth","minHeight","maxWidth","Infinity","maxHeight","newCanvasLeft","newCanvasTop","minLeft","min","minTop","maxLeft","maxTop","isChanged","isSquareImage","rotated2","$canvas","transform","renderImage","limitCropBox","output","reversed","$clone","initialCropBox","maxCropBoxWidth","maxCropBoxHeight","$face","$cropBox","disabled","completed","trigger","getData","DATA_PREVIEW","preview$1","initPreview","crossOrigin","crossOriginUrl","$clone2","$preview","$viewBox","html","element","img","style","cssText","resetPreview","removeData","cropBoxWidth","cropBoxHeight","originalWidth","originalHeight","ratio","find","PointerEvent","EVENT_POINTER_DOWN","EVENT_POINTER_MOVE","EVENT_POINTER_UP","EVENT_WHEEL","EVENT_DBLCLICK","EVENT_RESIZE","EVENT_CROP_START","EVENT_CROP_MOVE","EVENT_CROP_END","EVENT_CROP","EVENT_ZOOM","events","bind","isFunction","on","cropStart","wheel","dblclick","onCropMove","cropMove","onCropEnd","cropEnd","onResize","resize","unbind","off","REGEXP_ACTIONS","getPointer","_ref","endOnly","pageX","pageY","end","endX","endY","startX","startY","handlers","canvasData","cropBoxData","getCanvasData","getCropBoxData","setCanvasData","setCropBoxData","setDragMode","$dragBox","hasClass","event","e","originalEvent","preventDefault","wheeling","setTimeout","delta","deltaY","wheelDelta","detail","pointers","action","changedTouches","touch","identifier","pointerId","target","isDefaultPrevented","cropping","change","toggleClass","ACTION_EAST","ACTION_WEST","ACTION_SOUTH","ACTION_NORTH","ACTION_SOUTH_EAST","ACTION_SOUTH_WEST","ACTION_NORTH_EAST","ACTION_NORTH_WEST","getMaxZoomRatio","pointers2","ratios","pointer","pointerId2","pointer2","x1","y1","x2","y2","z1","sqrt","z2","sort","a","b","change$1","right","bottom","renderable","shiftKey","range","x","y","X","Y","move","p","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","prototype","get","object","property","receiver","Function","desc","undefined","parent","value","getter","call","set","setter","toConsumableArray","arr","isArray","arr2","getPointersCenter","count","methods","reset","clear","onlyColorChanged","isImg","attr","add","replaced","enable","disable","destroy","loaded","originalUrl","unbuild","remove","offsetX","offsetY","moveTo","changed","_event","zoomTo","oldRatio","rotateTo","_scaleX","_scaleY","isRounded","round","setData","isScaled","isPlainObject","getContainerData","getImageData","widthChanged","heightChanged","getCroppedCanvas","HTMLCanvasElement","scaledWidth","scaledHeight","scaledRatio","parameters","source","sourceWidth","sourceHeight","params","srcX","srcY","srcWidth","srcHeight","setAspectRatio","mode","croppable","CLASS_HIDDEN","REGEXP_DATA_URL","REGEXP_DATA_URL_JPEG","Cropper","init","is","prop","toDataURL","type","Event","clone","read","xhr","XMLHttpRequest","onerror","onabort","response","open","responseType","withCredentials","send","complete","one","stop","insertAfter","$image","build","append","after","completing","clearTimeout","setDefaults","NAMESPACE","OtherCropper","cropper","jQueryCropper","option","result","noConflict"],"mappings":"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","file":"cropper.esm.js","sourcesContent":["/*!\n * Cropper v3.0.0-rc.3\n * https://github.com/fengyuanchen/cropper\n *\n * Copyright (c) 2017 Fengyuan Chen\n * Released under the MIT license\n *\n * Date: 2017-07-07T13:00:47.346Z\n */\n\nimport $ from 'jquery';\n\nvar DEFAULTS = {\n  // Define the view mode of the cropper\n  viewMode: 0, // 0, 1, 2, 3\n\n  // Define the dragging mode of the cropper\n  dragMode: 'crop', // 'crop', 'move' or 'none'\n\n  // Define the aspect ratio of the crop box\n  aspectRatio: NaN,\n\n  // An object with the previous cropping result data\n  data: null,\n\n  // A selector for adding extra containers to preview\n  preview: '',\n\n  // Re-render the cropper when resize the window\n  responsive: true,\n\n  // Restore the cropped area after resize the window\n  restore: true,\n\n  // Check if the current image is a cross-origin image\n  checkCrossOrigin: true,\n\n  // Check the current image's Exif Orientation information\n  checkOrientation: true,\n\n  // Show the black modal\n  modal: true,\n\n  // Show the dashed lines for guiding\n  guides: true,\n\n  // Show the center indicator for guiding\n  center: true,\n\n  // Show the white modal to highlight the crop box\n  highlight: true,\n\n  // Show the grid background\n  background: true,\n\n  // Enable to crop the image automatically when initialize\n  autoCrop: true,\n\n  // Define the percentage of automatic cropping area when initializes\n  autoCropArea: 0.8,\n\n  // Enable to move the image\n  movable: true,\n\n  // Enable to rotate the image\n  rotatable: true,\n\n  // Enable to scale the image\n  scalable: true,\n\n  // Enable to zoom the image\n  zoomable: true,\n\n  // Enable to zoom the image by dragging touch\n  zoomOnTouch: true,\n\n  // Enable to zoom the image by wheeling mouse\n  zoomOnWheel: true,\n\n  // Define zoom ratio when zoom the image by wheeling mouse\n  wheelZoomRatio: 0.1,\n\n  // Enable to move the crop box\n  cropBoxMovable: true,\n\n  // Enable to resize the crop box\n  cropBoxResizable: true,\n\n  // Toggle drag mode between \"crop\" and \"move\" when click twice on the cropper\n  toggleDragModeOnDblclick: true,\n\n  // Size limitation\n  minCanvasWidth: 0,\n  minCanvasHeight: 0,\n  minCropBoxWidth: 0,\n  minCropBoxHeight: 0,\n  minContainerWidth: 200,\n  minContainerHeight: 100,\n\n  // Shortcuts of events\n  ready: null,\n  cropstart: null,\n  cropmove: null,\n  cropend: null,\n  crop: null,\n  zoom: null\n};\n\nvar TEMPLATE = '<div class=\"cropper-container\">' + '<div class=\"cropper-wrap-box\">' + '<div class=\"cropper-canvas\"></div>' + '</div>' + '<div class=\"cropper-drag-box\"></div>' + '<div class=\"cropper-crop-box\">' + '<span class=\"cropper-view-box\"></span>' + '<span class=\"cropper-dashed dashed-h\"></span>' + '<span class=\"cropper-dashed dashed-v\"></span>' + '<span class=\"cropper-center\"></span>' + '<span class=\"cropper-face\"></span>' + '<span class=\"cropper-line line-e\" data-action=\"e\"></span>' + '<span class=\"cropper-line line-n\" data-action=\"n\"></span>' + '<span class=\"cropper-line line-w\" data-action=\"w\"></span>' + '<span class=\"cropper-line line-s\" data-action=\"s\"></span>' + '<span class=\"cropper-point point-e\" data-action=\"e\"></span>' + '<span class=\"cropper-point point-n\" data-action=\"n\"></span>' + '<span class=\"cropper-point point-w\" data-action=\"w\"></span>' + '<span class=\"cropper-point point-s\" data-action=\"s\"></span>' + '<span class=\"cropper-point point-ne\" data-action=\"ne\"></span>' + '<span class=\"cropper-point point-nw\" data-action=\"nw\"></span>' + '<span class=\"cropper-point point-sw\" data-action=\"sw\"></span>' + '<span class=\"cropper-point point-se\" data-action=\"se\"></span>' + '</div>' + '</div>';\n\nvar REGEXP_DATA_URL_HEAD = /^data:.*,/;\nvar REGEXP_USERAGENT = /(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i;\nvar navigator = typeof window !== 'undefined' ? window.navigator : null;\nvar IS_SAFARI_OR_UIWEBVIEW = navigator && REGEXP_USERAGENT.test(navigator.userAgent);\nvar fromCharCode = String.fromCharCode;\n\nfunction isNumber(n) {\n  return typeof n === 'number' && !isNaN(n);\n}\n\nfunction isUndefined(n) {\n  return typeof n === 'undefined';\n}\n\nfunction toArray(obj, offset) {\n  var args = [];\n\n  // This is necessary for IE8\n  if (isNumber(offset)) {\n    args.push(offset);\n  }\n\n  return args.slice.apply(obj, args);\n}\n\n// Custom proxy to avoid jQuery's guid\nfunction proxy(fn, context) {\n  for (var _len = arguments.length, args = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n\n  return function () {\n    for (var _len2 = arguments.length, args2 = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args2[_key2] = arguments[_key2];\n    }\n\n    return fn.apply(context, args.concat(toArray(args2)));\n  };\n}\n\nfunction objectKeys(obj) {\n  var keys = [];\n\n  $.each(obj, function (key) {\n    keys.push(key);\n  });\n\n  return keys;\n}\n\nfunction isCrossOriginURL(url) {\n  var parts = url.match(/^(https?:)\\/\\/([^:/?#]+):?(\\d*)/i);\n\n  return parts && (parts[1] !== location.protocol || parts[2] !== location.hostname || parts[3] !== location.port);\n}\n\nfunction addTimestamp(url) {\n  var timestamp = 'timestamp=' + new Date().getTime();\n\n  return url + (url.indexOf('?') === -1 ? '?' : '&') + timestamp;\n}\n\nfunction getImageSize(image, callback) {\n  // Modern browsers (ignore Safari, #120 & #509)\n  if (image.naturalWidth && !IS_SAFARI_OR_UIWEBVIEW) {\n    callback(image.naturalWidth, image.naturalHeight);\n    return;\n  }\n\n  // IE8: Don't use `new Image()` here (#319)\n  var newImage = document.createElement('img');\n\n  newImage.onload = function load() {\n    callback(this.width, this.height);\n  };\n\n  newImage.src = image.src;\n}\n\nfunction getTransform(options) {\n  var transforms = [];\n  var translateX = options.translateX;\n  var translateY = options.translateY;\n  var rotate = options.rotate;\n  var scaleX = options.scaleX;\n  var scaleY = options.scaleY;\n\n  if (isNumber(translateX) && translateX !== 0) {\n    transforms.push('translateX(' + translateX + 'px)');\n  }\n\n  if (isNumber(translateY) && translateY !== 0) {\n    transforms.push('translateY(' + translateY + 'px)');\n  }\n\n  // Rotate should come first before scale to match orientation transform\n  if (isNumber(rotate) && rotate !== 0) {\n    transforms.push('rotate(' + rotate + 'deg)');\n  }\n\n  if (isNumber(scaleX) && scaleX !== 1) {\n    transforms.push('scaleX(' + scaleX + ')');\n  }\n\n  if (isNumber(scaleY) && scaleY !== 1) {\n    transforms.push('scaleY(' + scaleY + ')');\n  }\n\n  return transforms.length ? transforms.join(' ') : 'none';\n}\n\nfunction getRotatedSizes(data, isReversed) {\n  var deg = Math.abs(data.degree) % 180;\n  var arc = (deg > 90 ? 180 - deg : deg) * Math.PI / 180;\n  var sinArc = Math.sin(arc);\n  var cosArc = Math.cos(arc);\n  var width = data.width;\n  var height = data.height;\n  var aspectRatio = data.aspectRatio;\n  var newWidth = void 0;\n  var newHeight = void 0;\n\n  if (!isReversed) {\n    newWidth = width * cosArc + height * sinArc;\n    newHeight = width * sinArc + height * cosArc;\n  } else {\n    newWidth = width / (cosArc + sinArc / aspectRatio);\n    newHeight = newWidth / aspectRatio;\n  }\n\n  return {\n    width: newWidth,\n    height: newHeight\n  };\n}\n\nfunction getSourceCanvas(image, data, options) {\n  var canvas = $('<canvas>')[0];\n  var context = canvas.getContext('2d');\n  var dstX = 0;\n  var dstY = 0;\n  var dstWidth = data.naturalWidth;\n  var dstHeight = data.naturalHeight;\n  var rotate = data.rotate;\n  var scaleX = data.scaleX;\n  var scaleY = data.scaleY;\n  var scalable = isNumber(scaleX) && isNumber(scaleY) && (scaleX !== 1 || scaleY !== 1);\n  var rotatable = isNumber(rotate) && rotate !== 0;\n  var advanced = rotatable || scalable;\n  var canvasWidth = dstWidth * Math.abs(scaleX || 1);\n  var canvasHeight = dstHeight * Math.abs(scaleY || 1);\n  var translateX = void 0;\n  var translateY = void 0;\n  var rotated = void 0;\n\n  if (scalable) {\n    translateX = canvasWidth / 2;\n    translateY = canvasHeight / 2;\n  }\n\n  if (rotatable) {\n    rotated = getRotatedSizes({\n      width: canvasWidth,\n      height: canvasHeight,\n      degree: rotate\n    });\n\n    canvasWidth = rotated.width;\n    canvasHeight = rotated.height;\n    translateX = canvasWidth / 2;\n    translateY = canvasHeight / 2;\n  }\n\n  canvas.width = canvasWidth;\n  canvas.height = canvasHeight;\n\n  if (options.fillColor) {\n    context.fillStyle = options.fillColor;\n    context.fillRect(0, 0, canvasWidth, canvasHeight);\n  }\n\n  if (advanced) {\n    dstX = -dstWidth / 2;\n    dstY = -dstHeight / 2;\n\n    context.save();\n    context.translate(translateX, translateY);\n  }\n\n  // Rotate should come first before scale as in the \"getTransform\" function\n  if (rotatable) {\n    context.rotate(rotate * Math.PI / 180);\n  }\n\n  if (scalable) {\n    context.scale(scaleX, scaleY);\n  }\n\n  context.imageSmoothingEnabled = !!options.imageSmoothingEnabled;\n\n  if (options.imageSmoothingQuality) {\n    context.imageSmoothingQuality = options.imageSmoothingQuality;\n  }\n\n  context.drawImage(image, Math.floor(dstX), Math.floor(dstY), Math.floor(dstWidth), Math.floor(dstHeight));\n\n  if (advanced) {\n    context.restore();\n  }\n\n  return canvas;\n}\n\nfunction getStringFromCharCode(dataView, start, length) {\n  var str = '';\n  var i = void 0;\n\n  for (i = start, length += start; i < length; i++) {\n    str += fromCharCode(dataView.getUint8(i));\n  }\n\n  return str;\n}\n\nfunction getOrientation(arrayBuffer) {\n  var dataView = new DataView(arrayBuffer);\n  var length = dataView.byteLength;\n  var orientation = void 0;\n  var exifIDCode = void 0;\n  var tiffOffset = void 0;\n  var firstIFDOffset = void 0;\n  var littleEndian = void 0;\n  var endianness = void 0;\n  var app1Start = void 0;\n  var ifdStart = void 0;\n  var offset = void 0;\n  var i = void 0;\n\n  // Only handle JPEG image (start by 0xFFD8)\n  if (dataView.getUint8(0) === 0xFF && dataView.getUint8(1) === 0xD8) {\n    offset = 2;\n\n    while (offset < length) {\n      if (dataView.getUint8(offset) === 0xFF && dataView.getUint8(offset + 1) === 0xE1) {\n        app1Start = offset;\n        break;\n      }\n\n      offset++;\n    }\n  }\n\n  if (app1Start) {\n    exifIDCode = app1Start + 4;\n    tiffOffset = app1Start + 10;\n\n    if (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\n      endianness = dataView.getUint16(tiffOffset);\n      littleEndian = endianness === 0x4949;\n\n      if (littleEndian || endianness === 0x4D4D /* bigEndian */) {\n          if (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002A) {\n            firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\n\n            if (firstIFDOffset >= 0x00000008) {\n              ifdStart = tiffOffset + firstIFDOffset;\n            }\n          }\n        }\n    }\n  }\n\n  if (ifdStart) {\n    length = dataView.getUint16(ifdStart, littleEndian);\n\n    for (i = 0; i < length; i++) {\n      offset = ifdStart + i * 12 + 2;\n\n      if (dataView.getUint16(offset, littleEndian) === 0x0112 /* Orientation */) {\n          // 8 is the offset of the current tag's value\n          offset += 8;\n\n          // Get the original orientation value\n          orientation = dataView.getUint16(offset, littleEndian);\n\n          // Override the orientation with its default value for Safari (#120)\n          if (IS_SAFARI_OR_UIWEBVIEW) {\n            dataView.setUint16(offset, 1, littleEndian);\n          }\n\n          break;\n        }\n    }\n  }\n\n  return orientation;\n}\n\nfunction dataURLToArrayBuffer(dataURL) {\n  var base64 = dataURL.replace(REGEXP_DATA_URL_HEAD, '');\n  var binary = atob(base64);\n  var length = binary.length;\n  var arrayBuffer = new ArrayBuffer(length);\n  var dataView = new Uint8Array(arrayBuffer);\n  var i = void 0;\n\n  for (i = 0; i < length; i++) {\n    dataView[i] = binary.charCodeAt(i);\n  }\n\n  return arrayBuffer;\n}\n\n// Only available for JPEG image\nfunction arrayBufferToDataURL(arrayBuffer) {\n  var dataView = new Uint8Array(arrayBuffer);\n  var length = dataView.length;\n  var base64 = '';\n  var i = void 0;\n\n  for (i = 0; i < length; i++) {\n    base64 += fromCharCode(dataView[i]);\n  }\n\n  return 'data:image/jpeg;base64,' + btoa(base64);\n}\n\nvar render$1 = {\n  render: function render() {\n    var self = this;\n\n    self.initContainer();\n    self.initCanvas();\n    self.initCropBox();\n\n    self.renderCanvas();\n\n    if (self.cropped) {\n      self.renderCropBox();\n    }\n  },\n  initContainer: function initContainer() {\n    var self = this;\n    var options = self.options;\n    var $this = self.$element;\n    var $container = self.$container;\n    var $cropper = self.$cropper;\n    var hidden = 'cropper-hidden';\n\n    $cropper.addClass(hidden);\n    $this.removeClass(hidden);\n\n    $cropper.css(self.container = {\n      width: Math.max($container.width(), Number(options.minContainerWidth) || 200),\n      height: Math.max($container.height(), Number(options.minContainerHeight) || 100)\n    });\n\n    $this.addClass(hidden);\n    $cropper.removeClass(hidden);\n  },\n\n\n  // Canvas (image wrapper)\n  initCanvas: function initCanvas() {\n    var self = this;\n    var viewMode = self.options.viewMode;\n    var container = self.container;\n    var containerWidth = container.width;\n    var containerHeight = container.height;\n    var image = self.image;\n    var imageNaturalWidth = image.naturalWidth;\n    var imageNaturalHeight = image.naturalHeight;\n    var is90Degree = Math.abs(image.rotate) % 180 === 90;\n    var naturalWidth = is90Degree ? imageNaturalHeight : imageNaturalWidth;\n    var naturalHeight = is90Degree ? imageNaturalWidth : imageNaturalHeight;\n    var aspectRatio = naturalWidth / naturalHeight;\n    var canvasWidth = containerWidth;\n    var canvasHeight = containerHeight;\n\n    if (containerHeight * aspectRatio > containerWidth) {\n      if (viewMode === 3) {\n        canvasWidth = containerHeight * aspectRatio;\n      } else {\n        canvasHeight = containerWidth / aspectRatio;\n      }\n    } else if (viewMode === 3) {\n      canvasHeight = containerWidth / aspectRatio;\n    } else {\n      canvasWidth = containerHeight * aspectRatio;\n    }\n\n    var canvas = {\n      naturalWidth: naturalWidth,\n      naturalHeight: naturalHeight,\n      aspectRatio: aspectRatio,\n      width: canvasWidth,\n      height: canvasHeight\n    };\n\n    canvas.oldLeft = canvas.left = (containerWidth - canvasWidth) / 2;\n    canvas.oldTop = canvas.top = (containerHeight - canvasHeight) / 2;\n\n    self.canvas = canvas;\n    self.limited = viewMode === 1 || viewMode === 2;\n    self.limitCanvas(true, true);\n    self.initialImage = $.extend({}, image);\n    self.initialCanvas = $.extend({}, canvas);\n  },\n  limitCanvas: function limitCanvas(isSizeLimited, isPositionLimited) {\n    var self = this;\n    var options = self.options;\n    var viewMode = options.viewMode;\n    var container = self.container;\n    var containerWidth = container.width;\n    var containerHeight = container.height;\n    var canvas = self.canvas;\n    var aspectRatio = canvas.aspectRatio;\n    var cropBox = self.cropBox;\n    var cropped = self.cropped && cropBox;\n\n    if (isSizeLimited) {\n      var minCanvasWidth = Number(options.minCanvasWidth) || 0;\n      var minCanvasHeight = Number(options.minCanvasHeight) || 0;\n\n      if (viewMode) {\n        if (viewMode > 1) {\n          minCanvasWidth = Math.max(minCanvasWidth, containerWidth);\n          minCanvasHeight = Math.max(minCanvasHeight, containerHeight);\n\n          if (viewMode === 3) {\n            if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n              minCanvasWidth = minCanvasHeight * aspectRatio;\n            } else {\n              minCanvasHeight = minCanvasWidth / aspectRatio;\n            }\n          }\n        } else if (minCanvasWidth) {\n          minCanvasWidth = Math.max(minCanvasWidth, cropped ? cropBox.width : 0);\n        } else if (minCanvasHeight) {\n          minCanvasHeight = Math.max(minCanvasHeight, cropped ? cropBox.height : 0);\n        } else if (cropped) {\n          minCanvasWidth = cropBox.width;\n          minCanvasHeight = cropBox.height;\n\n          if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n            minCanvasWidth = minCanvasHeight * aspectRatio;\n          } else {\n            minCanvasHeight = minCanvasWidth / aspectRatio;\n          }\n        }\n      }\n\n      if (minCanvasWidth && minCanvasHeight) {\n        if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n          minCanvasHeight = minCanvasWidth / aspectRatio;\n        } else {\n          minCanvasWidth = minCanvasHeight * aspectRatio;\n        }\n      } else if (minCanvasWidth) {\n        minCanvasHeight = minCanvasWidth / aspectRatio;\n      } else if (minCanvasHeight) {\n        minCanvasWidth = minCanvasHeight * aspectRatio;\n      }\n\n      canvas.minWidth = minCanvasWidth;\n      canvas.minHeight = minCanvasHeight;\n      canvas.maxWidth = Infinity;\n      canvas.maxHeight = Infinity;\n    }\n\n    if (isPositionLimited) {\n      if (viewMode) {\n        var newCanvasLeft = containerWidth - canvas.width;\n        var newCanvasTop = containerHeight - canvas.height;\n\n        canvas.minLeft = Math.min(0, newCanvasLeft);\n        canvas.minTop = Math.min(0, newCanvasTop);\n        canvas.maxLeft = Math.max(0, newCanvasLeft);\n        canvas.maxTop = Math.max(0, newCanvasTop);\n\n        if (cropped && self.limited) {\n          canvas.minLeft = Math.min(cropBox.left, cropBox.left + cropBox.width - canvas.width);\n          canvas.minTop = Math.min(cropBox.top, cropBox.top + cropBox.height - canvas.height);\n          canvas.maxLeft = cropBox.left;\n          canvas.maxTop = cropBox.top;\n\n          if (viewMode === 2) {\n            if (canvas.width >= containerWidth) {\n              canvas.minLeft = Math.min(0, newCanvasLeft);\n              canvas.maxLeft = Math.max(0, newCanvasLeft);\n            }\n\n            if (canvas.height >= containerHeight) {\n              canvas.minTop = Math.min(0, newCanvasTop);\n              canvas.maxTop = Math.max(0, newCanvasTop);\n            }\n          }\n        }\n      } else {\n        canvas.minLeft = -canvas.width;\n        canvas.minTop = -canvas.height;\n        canvas.maxLeft = containerWidth;\n        canvas.maxTop = containerHeight;\n      }\n    }\n  },\n  renderCanvas: function renderCanvas(isChanged) {\n    var self = this;\n    var canvas = self.canvas;\n    var image = self.image;\n    var rotate = image.rotate;\n    var naturalWidth = image.naturalWidth;\n    var naturalHeight = image.naturalHeight;\n\n    if (self.rotated) {\n      self.rotated = false;\n\n      // Computes rotated sizes with image sizes\n      var rotated = getRotatedSizes({\n        width: image.width,\n        height: image.height,\n        degree: rotate\n      });\n      var aspectRatio = rotated.width / rotated.height;\n      var isSquareImage = image.aspectRatio === 1;\n\n      if (isSquareImage || aspectRatio !== canvas.aspectRatio) {\n        canvas.left -= (rotated.width - canvas.width) / 2;\n        canvas.top -= (rotated.height - canvas.height) / 2;\n        canvas.width = rotated.width;\n        canvas.height = rotated.height;\n        canvas.aspectRatio = aspectRatio;\n        canvas.naturalWidth = naturalWidth;\n        canvas.naturalHeight = naturalHeight;\n\n        // Computes rotated sizes with natural image sizes\n        if (isSquareImage && rotate % 90 || rotate % 180) {\n          var rotated2 = getRotatedSizes({\n            width: naturalWidth,\n            height: naturalHeight,\n            degree: rotate\n          });\n\n          canvas.naturalWidth = rotated2.width;\n          canvas.naturalHeight = rotated2.height;\n        }\n\n        self.limitCanvas(true, false);\n      }\n    }\n\n    if (canvas.width > canvas.maxWidth || canvas.width < canvas.minWidth) {\n      canvas.left = canvas.oldLeft;\n    }\n\n    if (canvas.height > canvas.maxHeight || canvas.height < canvas.minHeight) {\n      canvas.top = canvas.oldTop;\n    }\n\n    canvas.width = Math.min(Math.max(canvas.width, canvas.minWidth), canvas.maxWidth);\n    canvas.height = Math.min(Math.max(canvas.height, canvas.minHeight), canvas.maxHeight);\n\n    self.limitCanvas(false, true);\n\n    canvas.oldLeft = canvas.left = Math.min(Math.max(canvas.left, canvas.minLeft), canvas.maxLeft);\n    canvas.oldTop = canvas.top = Math.min(Math.max(canvas.top, canvas.minTop), canvas.maxTop);\n\n    self.$canvas.css({\n      width: canvas.width,\n      height: canvas.height,\n      transform: getTransform({\n        translateX: canvas.left,\n        translateY: canvas.top\n      })\n    });\n\n    self.renderImage();\n\n    if (self.cropped && self.limited) {\n      self.limitCropBox(true, true);\n    }\n\n    if (isChanged) {\n      self.output();\n    }\n  },\n  renderImage: function renderImage(isChanged) {\n    var self = this;\n    var canvas = self.canvas;\n    var image = self.image;\n    var reversed = void 0;\n\n    if (image.rotate) {\n      reversed = getRotatedSizes({\n        width: canvas.width,\n        height: canvas.height,\n        degree: image.rotate,\n        aspectRatio: image.aspectRatio\n      }, true);\n    }\n\n    $.extend(image, reversed ? {\n      width: reversed.width,\n      height: reversed.height,\n      left: (canvas.width - reversed.width) / 2,\n      top: (canvas.height - reversed.height) / 2\n    } : {\n      width: canvas.width,\n      height: canvas.height,\n      left: 0,\n      top: 0\n    });\n\n    self.$clone.css({\n      width: image.width,\n      height: image.height,\n      transform: getTransform($.extend({\n        translateX: image.left,\n        translateY: image.top\n      }, image))\n    });\n\n    if (isChanged) {\n      self.output();\n    }\n  },\n  initCropBox: function initCropBox() {\n    var self = this;\n    var options = self.options;\n    var canvas = self.canvas;\n    var aspectRatio = options.aspectRatio;\n    var autoCropArea = Number(options.autoCropArea) || 0.8;\n    var cropBox = {\n      width: canvas.width,\n      height: canvas.height\n    };\n\n    if (aspectRatio) {\n      if (canvas.height * aspectRatio > canvas.width) {\n        cropBox.height = cropBox.width / aspectRatio;\n      } else {\n        cropBox.width = cropBox.height * aspectRatio;\n      }\n    }\n\n    self.cropBox = cropBox;\n    self.limitCropBox(true, true);\n\n    // Initialize auto crop area\n    cropBox.width = Math.min(Math.max(cropBox.width, cropBox.minWidth), cropBox.maxWidth);\n    cropBox.height = Math.min(Math.max(cropBox.height, cropBox.minHeight), cropBox.maxHeight);\n\n    // The width of auto crop area must large than \"minWidth\", and the height too. (#164)\n    cropBox.width = Math.max(cropBox.minWidth, cropBox.width * autoCropArea);\n    cropBox.height = Math.max(cropBox.minHeight, cropBox.height * autoCropArea);\n    cropBox.oldLeft = cropBox.left = canvas.left + (canvas.width - cropBox.width) / 2;\n    cropBox.oldTop = cropBox.top = canvas.top + (canvas.height - cropBox.height) / 2;\n\n    self.initialCropBox = $.extend({}, cropBox);\n  },\n  limitCropBox: function limitCropBox(isSizeLimited, isPositionLimited) {\n    var self = this;\n    var options = self.options;\n    var aspectRatio = options.aspectRatio;\n    var container = self.container;\n    var containerWidth = container.width;\n    var containerHeight = container.height;\n    var canvas = self.canvas;\n    var cropBox = self.cropBox;\n    var limited = self.limited;\n\n    if (isSizeLimited) {\n      var minCropBoxWidth = Number(options.minCropBoxWidth) || 0;\n      var minCropBoxHeight = Number(options.minCropBoxHeight) || 0;\n      var maxCropBoxWidth = Math.min(containerWidth, limited ? canvas.width : containerWidth);\n      var maxCropBoxHeight = Math.min(containerHeight, limited ? canvas.height : containerHeight);\n\n      // The min/maxCropBoxWidth/Height must be less than containerWidth/Height\n      minCropBoxWidth = Math.min(minCropBoxWidth, containerWidth);\n      minCropBoxHeight = Math.min(minCropBoxHeight, containerHeight);\n\n      if (aspectRatio) {\n        if (minCropBoxWidth && minCropBoxHeight) {\n          if (minCropBoxHeight * aspectRatio > minCropBoxWidth) {\n            minCropBoxHeight = minCropBoxWidth / aspectRatio;\n          } else {\n            minCropBoxWidth = minCropBoxHeight * aspectRatio;\n          }\n        } else if (minCropBoxWidth) {\n          minCropBoxHeight = minCropBoxWidth / aspectRatio;\n        } else if (minCropBoxHeight) {\n          minCropBoxWidth = minCropBoxHeight * aspectRatio;\n        }\n\n        if (maxCropBoxHeight * aspectRatio > maxCropBoxWidth) {\n          maxCropBoxHeight = maxCropBoxWidth / aspectRatio;\n        } else {\n          maxCropBoxWidth = maxCropBoxHeight * aspectRatio;\n        }\n      }\n\n      // The minWidth/Height must be less than maxWidth/Height\n      cropBox.minWidth = Math.min(minCropBoxWidth, maxCropBoxWidth);\n      cropBox.minHeight = Math.min(minCropBoxHeight, maxCropBoxHeight);\n      cropBox.maxWidth = maxCropBoxWidth;\n      cropBox.maxHeight = maxCropBoxHeight;\n    }\n\n    if (isPositionLimited) {\n      if (limited) {\n        cropBox.minLeft = Math.max(0, canvas.left);\n        cropBox.minTop = Math.max(0, canvas.top);\n        cropBox.maxLeft = Math.min(containerWidth, canvas.left + canvas.width) - cropBox.width;\n        cropBox.maxTop = Math.min(containerHeight, canvas.top + canvas.height) - cropBox.height;\n      } else {\n        cropBox.minLeft = 0;\n        cropBox.minTop = 0;\n        cropBox.maxLeft = containerWidth - cropBox.width;\n        cropBox.maxTop = containerHeight - cropBox.height;\n      }\n    }\n  },\n  renderCropBox: function renderCropBox() {\n    var self = this;\n    var options = self.options;\n    var container = self.container;\n    var containerWidth = container.width;\n    var containerHeight = container.height;\n    var cropBox = self.cropBox;\n\n    if (cropBox.width > cropBox.maxWidth || cropBox.width < cropBox.minWidth) {\n      cropBox.left = cropBox.oldLeft;\n    }\n\n    if (cropBox.height > cropBox.maxHeight || cropBox.height < cropBox.minHeight) {\n      cropBox.top = cropBox.oldTop;\n    }\n\n    cropBox.width = Math.min(Math.max(cropBox.width, cropBox.minWidth), cropBox.maxWidth);\n    cropBox.height = Math.min(Math.max(cropBox.height, cropBox.minHeight), cropBox.maxHeight);\n\n    self.limitCropBox(false, true);\n\n    cropBox.oldLeft = cropBox.left = Math.min(Math.max(cropBox.left, cropBox.minLeft), cropBox.maxLeft);\n    cropBox.oldTop = cropBox.top = Math.min(Math.max(cropBox.top, cropBox.minTop), cropBox.maxTop);\n\n    if (options.movable && options.cropBoxMovable) {\n      // Turn to move the canvas when the crop box is equal to the container\n      self.$face.data('action', cropBox.width === containerWidth && cropBox.height === containerHeight ? 'move' : 'all');\n    }\n\n    self.$cropBox.css({\n      width: cropBox.width,\n      height: cropBox.height,\n      transform: getTransform({\n        translateX: cropBox.left,\n        translateY: cropBox.top\n      })\n    });\n\n    if (self.cropped && self.limited) {\n      self.limitCanvas(true, true);\n    }\n\n    if (!self.disabled) {\n      self.output();\n    }\n  },\n  output: function output() {\n    var self = this;\n\n    self.preview();\n\n    if (self.completed) {\n      self.trigger('crop', self.getData());\n    }\n  }\n};\n\nvar DATA_PREVIEW = 'preview';\n\nvar preview$1 = {\n  initPreview: function initPreview() {\n    var self = this;\n    var crossOrigin = self.crossOrigin;\n    var url = crossOrigin ? self.crossOriginUrl : self.url;\n    var image = document.createElement('img');\n\n    if (crossOrigin) {\n      image.crossOrigin = crossOrigin;\n    }\n\n    image.src = url;\n\n    var $clone2 = $(image);\n\n    self.$preview = $(self.options.preview);\n    self.$clone2 = $clone2;\n    self.$viewBox.html($clone2);\n    self.$preview.each(function (i, element) {\n      var $this = $(element);\n      var img = document.createElement('img');\n\n      // Save the original size for recover\n      $this.data(DATA_PREVIEW, {\n        width: $this.width(),\n        height: $this.height(),\n        html: $this.html()\n      });\n\n      if (crossOrigin) {\n        img.crossOrigin = crossOrigin;\n      }\n\n      img.src = url;\n\n      /**\n       * Override img element styles\n       * Add `display:block` to avoid margin top issue\n       * Add `height:auto` to override `height` attribute on IE8\n       * (Occur only when margin-top <= -height)\n       */\n      img.style.cssText = 'display:block;' + 'width:100%;' + 'height:auto;' + 'min-width:0!important;' + 'min-height:0!important;' + 'max-width:none!important;' + 'max-height:none!important;' + 'image-orientation:0deg!important;\"';\n\n      $this.html(img);\n    });\n  },\n  resetPreview: function resetPreview() {\n    this.$preview.each(function (i, element) {\n      var $this = $(element);\n      var data = $this.data(DATA_PREVIEW);\n\n      $this.css({\n        width: data.width,\n        height: data.height\n      }).html(data.html).removeData(DATA_PREVIEW);\n    });\n  },\n  preview: function preview() {\n    var self = this;\n    var image = self.image;\n    var canvas = self.canvas;\n    var cropBox = self.cropBox;\n    var cropBoxWidth = cropBox.width;\n    var cropBoxHeight = cropBox.height;\n    var width = image.width;\n    var height = image.height;\n    var left = cropBox.left - canvas.left - image.left;\n    var top = cropBox.top - canvas.top - image.top;\n\n    if (!self.cropped || self.disabled) {\n      return;\n    }\n\n    self.$clone2.css({\n      width: width,\n      height: height,\n      transform: getTransform($.extend({\n        translateX: -left,\n        translateY: -top\n      }, image))\n    });\n\n    self.$preview.each(function (i, element) {\n      var $this = $(element);\n      var data = $this.data(DATA_PREVIEW);\n      var originalWidth = data.width;\n      var originalHeight = data.height;\n      var newWidth = originalWidth;\n      var newHeight = originalHeight;\n      var ratio = 1;\n\n      if (cropBoxWidth) {\n        ratio = originalWidth / cropBoxWidth;\n        newHeight = cropBoxHeight * ratio;\n      }\n\n      if (cropBoxHeight && newHeight > originalHeight) {\n        ratio = originalHeight / cropBoxHeight;\n        newWidth = cropBoxWidth * ratio;\n        newHeight = originalHeight;\n      }\n\n      $this.css({\n        width: newWidth,\n        height: newHeight\n      }).find('img').css({\n        width: width * ratio,\n        height: height * ratio,\n        transform: getTransform($.extend({\n          translateX: -left * ratio,\n          translateY: -top * ratio\n        }, image))\n      });\n    });\n  }\n};\n\n// Globals\nvar PointerEvent = typeof window !== 'undefined' ? window.PointerEvent : null;\n\n// Events\nvar EVENT_POINTER_DOWN = PointerEvent ? 'pointerdown' : 'touchstart mousedown';\nvar EVENT_POINTER_MOVE = PointerEvent ? 'pointermove' : 'touchmove mousemove';\nvar EVENT_POINTER_UP = PointerEvent ? ' pointerup pointercancel' : 'touchend touchcancel mouseup';\nvar EVENT_WHEEL = 'wheel mousewheel DOMMouseScroll';\nvar EVENT_DBLCLICK = 'dblclick';\nvar EVENT_RESIZE = 'resize';\nvar EVENT_CROP_START = 'cropstart';\nvar EVENT_CROP_MOVE = 'cropmove';\nvar EVENT_CROP_END = 'cropend';\nvar EVENT_CROP = 'crop';\nvar EVENT_ZOOM = 'zoom';\n\nvar events = {\n  bind: function bind() {\n    var self = this;\n    var options = self.options;\n    var $this = self.$element;\n    var $cropper = self.$cropper;\n\n    if ($.isFunction(options.cropstart)) {\n      $this.on(EVENT_CROP_START, options.cropstart);\n    }\n\n    if ($.isFunction(options.cropmove)) {\n      $this.on(EVENT_CROP_MOVE, options.cropmove);\n    }\n\n    if ($.isFunction(options.cropend)) {\n      $this.on(EVENT_CROP_END, options.cropend);\n    }\n\n    if ($.isFunction(options.crop)) {\n      $this.on(EVENT_CROP, options.crop);\n    }\n\n    if ($.isFunction(options.zoom)) {\n      $this.on(EVENT_ZOOM, options.zoom);\n    }\n\n    $cropper.on(EVENT_POINTER_DOWN, proxy(self.cropStart, this));\n\n    if (options.zoomable && options.zoomOnWheel) {\n      $cropper.on(EVENT_WHEEL, proxy(self.wheel, this));\n    }\n\n    if (options.toggleDragModeOnDblclick) {\n      $cropper.on(EVENT_DBLCLICK, proxy(self.dblclick, this));\n    }\n\n    $(document).on(EVENT_POINTER_MOVE, self.onCropMove = proxy(self.cropMove, this)).on(EVENT_POINTER_UP, self.onCropEnd = proxy(self.cropEnd, this));\n\n    if (options.responsive) {\n      $(window).on(EVENT_RESIZE, self.onResize = proxy(self.resize, this));\n    }\n  },\n  unbind: function unbind() {\n    var self = this;\n    var options = self.options;\n    var $this = self.$element;\n    var $cropper = self.$cropper;\n\n    if ($.isFunction(options.cropstart)) {\n      $this.off(EVENT_CROP_START, options.cropstart);\n    }\n\n    if ($.isFunction(options.cropmove)) {\n      $this.off(EVENT_CROP_MOVE, options.cropmove);\n    }\n\n    if ($.isFunction(options.cropend)) {\n      $this.off(EVENT_CROP_END, options.cropend);\n    }\n\n    if ($.isFunction(options.crop)) {\n      $this.off(EVENT_CROP, options.crop);\n    }\n\n    if ($.isFunction(options.zoom)) {\n      $this.off(EVENT_ZOOM, options.zoom);\n    }\n\n    $cropper.off(EVENT_POINTER_DOWN, self.cropStart);\n\n    if (options.zoomable && options.zoomOnWheel) {\n      $cropper.off(EVENT_WHEEL, self.wheel);\n    }\n\n    if (options.toggleDragModeOnDblclick) {\n      $cropper.off(EVENT_DBLCLICK, self.dblclick);\n    }\n\n    $(document).off(EVENT_POINTER_MOVE, self.onCropMove).off(EVENT_POINTER_UP, self.onCropEnd);\n\n    if (options.responsive) {\n      $(window).off(EVENT_RESIZE, self.onResize);\n    }\n  }\n};\n\nvar REGEXP_ACTIONS = /^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/;\n\nfunction getPointer(_ref, endOnly) {\n  var pageX = _ref.pageX,\n      pageY = _ref.pageY;\n\n  var end = {\n    endX: pageX,\n    endY: pageY\n  };\n\n  if (endOnly) {\n    return end;\n  }\n\n  return $.extend({\n    startX: pageX,\n    startY: pageY\n  }, end);\n}\n\nvar handlers = {\n  resize: function resize() {\n    var self = this;\n    var options = self.options;\n    var $container = self.$container;\n    var container = self.container;\n    var minContainerWidth = Number(options.minContainerWidth) || 200;\n    var minContainerHeight = Number(options.minContainerHeight) || 100;\n\n    if (self.disabled || container.width === minContainerWidth || container.height === minContainerHeight) {\n      return;\n    }\n\n    var ratio = $container.width() / container.width;\n\n    // Resize when width changed or height changed\n    if (ratio !== 1 || $container.height() !== container.height) {\n      (function () {\n        var canvasData = void 0;\n        var cropBoxData = void 0;\n\n        if (options.restore) {\n          canvasData = self.getCanvasData();\n          cropBoxData = self.getCropBoxData();\n        }\n\n        self.render();\n\n        if (options.restore) {\n          self.setCanvasData($.each(canvasData, function (i, n) {\n            canvasData[i] = n * ratio;\n          }));\n          self.setCropBoxData($.each(cropBoxData, function (i, n) {\n            cropBoxData[i] = n * ratio;\n          }));\n        }\n      })();\n    }\n  },\n  dblclick: function dblclick() {\n    var self = this;\n\n    if (self.disabled || self.options.dragMode === 'none') {\n      return;\n    }\n\n    self.setDragMode(self.$dragBox.hasClass('cropper-crop') ? 'move' : 'crop');\n  },\n  wheel: function wheel(event) {\n    var self = this;\n    var e = event.originalEvent || event;\n    var ratio = Number(self.options.wheelZoomRatio) || 0.1;\n\n    if (self.disabled) {\n      return;\n    }\n\n    event.preventDefault();\n\n    // Limit wheel speed to prevent zoom too fast\n    if (self.wheeling) {\n      return;\n    }\n\n    self.wheeling = true;\n\n    setTimeout(function () {\n      self.wheeling = false;\n    }, 50);\n\n    var delta = 1;\n\n    if (e.deltaY) {\n      delta = e.deltaY > 0 ? 1 : -1;\n    } else if (e.wheelDelta) {\n      delta = -e.wheelDelta / 120;\n    } else if (e.detail) {\n      delta = e.detail > 0 ? 1 : -1;\n    }\n\n    self.zoom(-delta * ratio, event);\n  },\n  cropStart: function cropStart(e) {\n    var self = this;\n\n    if (self.disabled) {\n      return;\n    }\n\n    var options = self.options;\n    var pointers = self.pointers;\n    var originalEvent = e.originalEvent;\n    var action = void 0;\n\n    if (originalEvent && originalEvent.changedTouches) {\n      // Handle touch event\n      $.each(originalEvent.changedTouches, function (i, touch) {\n        pointers[touch.identifier] = getPointer(touch);\n      });\n    } else {\n      // Handle mouse event and pointer event\n      pointers[originalEvent && originalEvent.pointerId || 0] = getPointer(originalEvent || e);\n    }\n\n    if (objectKeys(pointers).length > 1 && options.zoomable && options.zoomOnTouch) {\n      action = 'zoom';\n    } else {\n      action = $(e.target).data('action');\n    }\n\n    if (!REGEXP_ACTIONS.test(action)) {\n      return;\n    }\n\n    if (self.trigger('cropstart', {\n      originalEvent: originalEvent,\n      action: action\n    }).isDefaultPrevented()) {\n      return;\n    }\n\n    e.preventDefault();\n\n    self.action = action;\n    self.cropping = false;\n\n    if (action === 'crop') {\n      self.cropping = true;\n      self.$dragBox.addClass('cropper-modal');\n    }\n  },\n  cropMove: function cropMove(e) {\n    var self = this;\n    var action = self.action;\n\n    if (self.disabled || !action) {\n      return;\n    }\n\n    var pointers = self.pointers;\n    var originalEvent = e.originalEvent;\n\n    e.preventDefault();\n\n    if (self.trigger('cropmove', {\n      originalEvent: originalEvent,\n      action: action\n    }).isDefaultPrevented()) {\n      return;\n    }\n\n    if (originalEvent && originalEvent.changedTouches) {\n      $.each(originalEvent.changedTouches, function (i, touch) {\n        $.extend(pointers[touch.identifier], getPointer(touch, true));\n      });\n    } else {\n      $.extend(pointers[originalEvent && originalEvent.pointerId || 0], getPointer(originalEvent || e, true));\n    }\n\n    self.change(e);\n  },\n  cropEnd: function cropEnd(e) {\n    var self = this;\n\n    if (self.disabled) {\n      return;\n    }\n\n    var action = self.action;\n    var pointers = self.pointers;\n    var originalEvent = e.originalEvent;\n\n    if (originalEvent && originalEvent.changedTouches) {\n      $.each(originalEvent.changedTouches, function (i, touch) {\n        delete pointers[touch.identifier];\n      });\n    } else {\n      delete pointers[originalEvent && originalEvent.pointerId || 0];\n    }\n\n    if (!action) {\n      return;\n    }\n\n    e.preventDefault();\n\n    if (!objectKeys(pointers).length) {\n      self.action = '';\n    }\n\n    if (self.cropping) {\n      self.cropping = false;\n      self.$dragBox.toggleClass('cropper-modal', self.cropped && self.options.modal);\n    }\n\n    self.trigger('cropend', {\n      originalEvent: originalEvent,\n      action: action\n    });\n  }\n};\n\n// Actions\nvar ACTION_EAST = 'e';\nvar ACTION_WEST = 'w';\nvar ACTION_SOUTH = 's';\nvar ACTION_NORTH = 'n';\nvar ACTION_SOUTH_EAST = 'se';\nvar ACTION_SOUTH_WEST = 'sw';\nvar ACTION_NORTH_EAST = 'ne';\nvar ACTION_NORTH_WEST = 'nw';\n\nfunction getMaxZoomRatio(pointers) {\n  var pointers2 = $.extend({}, pointers);\n  var ratios = [];\n\n  $.each(pointers, function (pointerId, pointer) {\n    delete pointers2[pointerId];\n\n    $.each(pointers2, function (pointerId2, pointer2) {\n      var x1 = Math.abs(pointer.startX - pointer2.startX);\n      var y1 = Math.abs(pointer.startY - pointer2.startY);\n      var x2 = Math.abs(pointer.endX - pointer2.endX);\n      var y2 = Math.abs(pointer.endY - pointer2.endY);\n      var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n      var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n      var ratio = (z2 - z1) / z1;\n\n      ratios.push(ratio);\n    });\n  });\n\n  ratios.sort(function (a, b) {\n    return Math.abs(a) < Math.abs(b);\n  });\n\n  return ratios[0];\n}\n\nvar change$1 = {\n  change: function change(e) {\n    var self = this;\n    var options = self.options;\n    var pointers = self.pointers;\n    var pointer = pointers[objectKeys(pointers)[0]];\n    var container = self.container;\n    var canvas = self.canvas;\n    var cropBox = self.cropBox;\n    var action = self.action;\n    var aspectRatio = options.aspectRatio;\n    var width = cropBox.width;\n    var height = cropBox.height;\n    var left = cropBox.left;\n    var top = cropBox.top;\n    var right = left + width;\n    var bottom = top + height;\n    var minLeft = 0;\n    var minTop = 0;\n    var maxWidth = container.width;\n    var maxHeight = container.height;\n    var renderable = true;\n    var offset = void 0;\n\n    // Locking aspect ratio in \"free mode\" by holding shift key (#259)\n    if (!aspectRatio && e.shiftKey) {\n      aspectRatio = width && height ? width / height : 1;\n    }\n\n    if (self.limited) {\n      minLeft = cropBox.minLeft;\n      minTop = cropBox.minTop;\n      maxWidth = minLeft + Math.min(container.width, canvas.width, canvas.left + canvas.width);\n      maxHeight = minTop + Math.min(container.height, canvas.height, canvas.top + canvas.height);\n    }\n\n    var range = {\n      x: pointer.endX - pointer.startX,\n      y: pointer.endY - pointer.startY\n    };\n\n    if (aspectRatio) {\n      range.X = range.y * aspectRatio;\n      range.Y = range.x / aspectRatio;\n    }\n\n    switch (action) {\n      // Move crop box\n      case 'all':\n        left += range.x;\n        top += range.y;\n        break;\n\n      // Resize crop box\n      case ACTION_EAST:\n        if (range.x >= 0 && (right >= maxWidth || aspectRatio && (top <= minTop || bottom >= maxHeight))) {\n          renderable = false;\n          break;\n        }\n\n        width += range.x;\n\n        if (aspectRatio) {\n          height = width / aspectRatio;\n          top -= range.Y / 2;\n        }\n\n        if (width < 0) {\n          action = ACTION_WEST;\n          width = 0;\n        }\n\n        break;\n\n      case ACTION_NORTH:\n        if (range.y <= 0 && (top <= minTop || aspectRatio && (left <= minLeft || right >= maxWidth))) {\n          renderable = false;\n          break;\n        }\n\n        height -= range.y;\n        top += range.y;\n\n        if (aspectRatio) {\n          width = height * aspectRatio;\n          left += range.X / 2;\n        }\n\n        if (height < 0) {\n          action = ACTION_SOUTH;\n          height = 0;\n        }\n\n        break;\n\n      case ACTION_WEST:\n        if (range.x <= 0 && (left <= minLeft || aspectRatio && (top <= minTop || bottom >= maxHeight))) {\n          renderable = false;\n          break;\n        }\n\n        width -= range.x;\n        left += range.x;\n\n        if (aspectRatio) {\n          height = width / aspectRatio;\n          top += range.Y / 2;\n        }\n\n        if (width < 0) {\n          action = ACTION_EAST;\n          width = 0;\n        }\n\n        break;\n\n      case ACTION_SOUTH:\n        if (range.y >= 0 && (bottom >= maxHeight || aspectRatio && (left <= minLeft || right >= maxWidth))) {\n          renderable = false;\n          break;\n        }\n\n        height += range.y;\n\n        if (aspectRatio) {\n          width = height * aspectRatio;\n          left -= range.X / 2;\n        }\n\n        if (height < 0) {\n          action = ACTION_NORTH;\n          height = 0;\n        }\n\n        break;\n\n      case ACTION_NORTH_EAST:\n        if (aspectRatio) {\n          if (range.y <= 0 && (top <= minTop || right >= maxWidth)) {\n            renderable = false;\n            break;\n          }\n\n          height -= range.y;\n          top += range.y;\n          width = height * aspectRatio;\n        } else {\n          if (range.x >= 0) {\n            if (right < maxWidth) {\n              width += range.x;\n            } else if (range.y <= 0 && top <= minTop) {\n              renderable = false;\n            }\n          } else {\n            width += range.x;\n          }\n\n          if (range.y <= 0) {\n            if (top > minTop) {\n              height -= range.y;\n              top += range.y;\n            }\n          } else {\n            height -= range.y;\n            top += range.y;\n          }\n        }\n\n        if (width < 0 && height < 0) {\n          action = ACTION_SOUTH_WEST;\n          height = 0;\n          width = 0;\n        } else if (width < 0) {\n          action = ACTION_NORTH_WEST;\n          width = 0;\n        } else if (height < 0) {\n          action = ACTION_SOUTH_EAST;\n          height = 0;\n        }\n\n        break;\n\n      case ACTION_NORTH_WEST:\n        if (aspectRatio) {\n          if (range.y <= 0 && (top <= minTop || left <= minLeft)) {\n            renderable = false;\n            break;\n          }\n\n          height -= range.y;\n          top += range.y;\n          width = height * aspectRatio;\n          left += range.X;\n        } else {\n          if (range.x <= 0) {\n            if (left > minLeft) {\n              width -= range.x;\n              left += range.x;\n            } else if (range.y <= 0 && top <= minTop) {\n              renderable = false;\n            }\n          } else {\n            width -= range.x;\n            left += range.x;\n          }\n\n          if (range.y <= 0) {\n            if (top > minTop) {\n              height -= range.y;\n              top += range.y;\n            }\n          } else {\n            height -= range.y;\n            top += range.y;\n          }\n        }\n\n        if (width < 0 && height < 0) {\n          action = ACTION_SOUTH_EAST;\n          height = 0;\n          width = 0;\n        } else if (width < 0) {\n          action = ACTION_NORTH_EAST;\n          width = 0;\n        } else if (height < 0) {\n          action = ACTION_SOUTH_WEST;\n          height = 0;\n        }\n\n        break;\n\n      case ACTION_SOUTH_WEST:\n        if (aspectRatio) {\n          if (range.x <= 0 && (left <= minLeft || bottom >= maxHeight)) {\n            renderable = false;\n            break;\n          }\n\n          width -= range.x;\n          left += range.x;\n          height = width / aspectRatio;\n        } else {\n          if (range.x <= 0) {\n            if (left > minLeft) {\n              width -= range.x;\n              left += range.x;\n            } else if (range.y >= 0 && bottom >= maxHeight) {\n              renderable = false;\n            }\n          } else {\n            width -= range.x;\n            left += range.x;\n          }\n\n          if (range.y >= 0) {\n            if (bottom < maxHeight) {\n              height += range.y;\n            }\n          } else {\n            height += range.y;\n          }\n        }\n\n        if (width < 0 && height < 0) {\n          action = ACTION_NORTH_EAST;\n          height = 0;\n          width = 0;\n        } else if (width < 0) {\n          action = ACTION_SOUTH_EAST;\n          width = 0;\n        } else if (height < 0) {\n          action = ACTION_NORTH_WEST;\n          height = 0;\n        }\n\n        break;\n\n      case ACTION_SOUTH_EAST:\n        if (aspectRatio) {\n          if (range.x >= 0 && (right >= maxWidth || bottom >= maxHeight)) {\n            renderable = false;\n            break;\n          }\n\n          width += range.x;\n          height = width / aspectRatio;\n        } else {\n          if (range.x >= 0) {\n            if (right < maxWidth) {\n              width += range.x;\n            } else if (range.y >= 0 && bottom >= maxHeight) {\n              renderable = false;\n            }\n          } else {\n            width += range.x;\n          }\n\n          if (range.y >= 0) {\n            if (bottom < maxHeight) {\n              height += range.y;\n            }\n          } else {\n            height += range.y;\n          }\n        }\n\n        if (width < 0 && height < 0) {\n          action = ACTION_NORTH_WEST;\n          height = 0;\n          width = 0;\n        } else if (width < 0) {\n          action = ACTION_SOUTH_WEST;\n          width = 0;\n        } else if (height < 0) {\n          action = ACTION_NORTH_EAST;\n          height = 0;\n        }\n\n        break;\n\n      // Move canvas\n      case 'move':\n        self.move(range.x, range.y);\n        renderable = false;\n        break;\n\n      // Zoom canvas\n      case 'zoom':\n        self.zoom(getMaxZoomRatio(pointers), e.originalEvent);\n        renderable = false;\n        break;\n\n      // Create crop box\n      case 'crop':\n        if (!range.x || !range.y) {\n          renderable = false;\n          break;\n        }\n\n        offset = self.$cropper.offset();\n        left = pointer.startX - offset.left;\n        top = pointer.startY - offset.top;\n        width = cropBox.minWidth;\n        height = cropBox.minHeight;\n\n        if (range.x > 0) {\n          action = range.y > 0 ? ACTION_SOUTH_EAST : ACTION_NORTH_EAST;\n        } else if (range.x < 0) {\n          left -= width;\n          action = range.y > 0 ? ACTION_SOUTH_WEST : ACTION_NORTH_WEST;\n        }\n\n        if (range.y < 0) {\n          top -= height;\n        }\n\n        // Show the crop box if is hidden\n        if (!self.cropped) {\n          self.$cropBox.removeClass('cropper-hidden');\n          self.cropped = true;\n\n          if (self.limited) {\n            self.limitCropBox(true, true);\n          }\n        }\n\n        break;\n\n      // No default\n    }\n\n    if (renderable) {\n      cropBox.width = width;\n      cropBox.height = height;\n      cropBox.left = left;\n      cropBox.top = top;\n      self.action = action;\n      self.renderCropBox();\n    }\n\n    // Override\n    $.each(pointers, function (i, p) {\n      p.startX = p.endX;\n      p.startY = p.endY;\n    });\n  }\n};\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n\n\n\n\n\nvar get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar set = function set(object, property, value, receiver) {\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent !== null) {\n      set(parent, property, value, receiver);\n    }\n  } else if (\"value\" in desc && desc.writable) {\n    desc.value = value;\n  } else {\n    var setter = desc.set;\n\n    if (setter !== undefined) {\n      setter.call(receiver, value);\n    }\n  }\n\n  return value;\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar toConsumableArray = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n};\n\nfunction getPointersCenter(pointers) {\n  var pageX = 0;\n  var pageY = 0;\n  var count = 0;\n\n  $.each(pointers, function (i, _ref) {\n    var startX = _ref.startX,\n        startY = _ref.startY;\n\n    pageX += startX;\n    pageY += startY;\n    count += 1;\n  });\n\n  pageX /= count;\n  pageY /= count;\n\n  return {\n    pageX: pageX,\n    pageY: pageY\n  };\n}\n\nvar methods = {\n  // Show the crop box manually\n  crop: function crop() {\n    var self = this;\n\n    if (!self.ready || self.disabled) {\n      return;\n    }\n\n    if (!self.cropped) {\n      self.cropped = true;\n      self.limitCropBox(true, true);\n\n      if (self.options.modal) {\n        self.$dragBox.addClass('cropper-modal');\n      }\n\n      self.$cropBox.removeClass('cropper-hidden');\n    }\n\n    self.setCropBoxData(self.initialCropBox);\n  },\n\n\n  // Reset the image and crop box to their initial states\n  reset: function reset() {\n    var self = this;\n\n    if (!self.ready || self.disabled) {\n      return;\n    }\n\n    self.image = $.extend({}, self.initialImage);\n    self.canvas = $.extend({}, self.initialCanvas);\n    self.cropBox = $.extend({}, self.initialCropBox);\n\n    self.renderCanvas();\n\n    if (self.cropped) {\n      self.renderCropBox();\n    }\n  },\n\n\n  // Clear the crop box\n  clear: function clear() {\n    var self = this;\n\n    if (!self.cropped || self.disabled) {\n      return;\n    }\n\n    $.extend(self.cropBox, {\n      left: 0,\n      top: 0,\n      width: 0,\n      height: 0\n    });\n\n    self.cropped = false;\n    self.renderCropBox();\n\n    self.limitCanvas(true, true);\n\n    // Render canvas after crop box rendered\n    self.renderCanvas();\n\n    self.$dragBox.removeClass('cropper-modal');\n    self.$cropBox.addClass('cropper-hidden');\n  },\n\n\n  /**\n   * Replace the image's src and rebuild the cropper\n   *\n   * @param {String} url\n   * @param {Boolean} onlyColorChanged (optional)\n   */\n  replace: function replace(url, onlyColorChanged) {\n    var self = this;\n\n    if (!self.disabled && url) {\n      if (self.isImg) {\n        self.$element.attr('src', url);\n      }\n\n      if (onlyColorChanged) {\n        self.url = url;\n        self.$clone.attr('src', url);\n\n        if (self.ready) {\n          self.$preview.find('img').add(self.$clone2).attr('src', url);\n        }\n      } else {\n        if (self.isImg) {\n          self.replaced = true;\n        }\n\n        // Clear previous data\n        self.options.data = null;\n        self.load(url);\n      }\n    }\n  },\n\n\n  // Enable (unfreeze) the cropper\n  enable: function enable() {\n    var self = this;\n\n    if (self.ready) {\n      self.disabled = false;\n      self.$cropper.removeClass('cropper-disabled');\n    }\n  },\n\n\n  // Disable (freeze) the cropper\n  disable: function disable() {\n    var self = this;\n\n    if (self.ready) {\n      self.disabled = true;\n      self.$cropper.addClass('cropper-disabled');\n    }\n  },\n\n\n  // Destroy the cropper and remove the instance from the image\n  destroy: function destroy() {\n    var self = this;\n    var $this = self.$element;\n\n    if (self.loaded) {\n      if (self.isImg && self.replaced) {\n        $this.attr('src', self.originalUrl);\n      }\n\n      self.unbuild();\n      $this.removeClass('cropper-hidden');\n    } else if (self.isImg) {\n      $this.off('load', self.start);\n    } else if (self.$clone) {\n      self.$clone.remove();\n    }\n\n    $this.removeData('cropper');\n  },\n\n\n  /**\n   * Move the canvas with relative offsets\n   *\n   * @param {Number} offsetX\n   * @param {Number} offsetY (optional)\n   */\n  move: function move(offsetX, offsetY) {\n    var self = this;\n    var canvas = self.canvas;\n\n    self.moveTo(isUndefined(offsetX) ? offsetX : canvas.left + Number(offsetX), isUndefined(offsetY) ? offsetY : canvas.top + Number(offsetY));\n  },\n\n\n  /**\n   * Move the canvas to an absolute point\n   *\n   * @param {Number} x\n   * @param {Number} y (optional)\n   */\n  moveTo: function moveTo(x, y) {\n    var self = this;\n    var canvas = self.canvas;\n    var changed = false;\n\n    // If \"y\" is not present, its default value is \"x\"\n    if (isUndefined(y)) {\n      y = x;\n    }\n\n    x = Number(x);\n    y = Number(y);\n\n    if (self.ready && !self.disabled && self.options.movable) {\n      if (isNumber(x)) {\n        canvas.left = x;\n        changed = true;\n      }\n\n      if (isNumber(y)) {\n        canvas.top = y;\n        changed = true;\n      }\n\n      if (changed) {\n        self.renderCanvas(true);\n      }\n    }\n  },\n\n\n  /**\n   * Zoom the canvas with a relative ratio\n   *\n   * @param {Number} ratio\n   * @param {jQuery Event} _event (private)\n   */\n  zoom: function zoom(ratio, _event) {\n    var self = this;\n    var canvas = self.canvas;\n\n    ratio = Number(ratio);\n\n    if (ratio < 0) {\n      ratio = 1 / (1 - ratio);\n    } else {\n      ratio = 1 + ratio;\n    }\n\n    self.zoomTo(canvas.width * ratio / canvas.naturalWidth, _event);\n  },\n\n\n  /**\n   * Zoom the canvas to an absolute ratio\n   *\n   * @param {Number} ratio\n   * @param {jQuery Event} _event (private)\n   */\n  zoomTo: function zoomTo(ratio, _event) {\n    var self = this;\n    var options = self.options;\n    var pointers = self.pointers;\n    var canvas = self.canvas;\n    var width = canvas.width;\n    var height = canvas.height;\n    var naturalWidth = canvas.naturalWidth;\n    var naturalHeight = canvas.naturalHeight;\n\n    ratio = Number(ratio);\n\n    if (ratio >= 0 && self.ready && !self.disabled && options.zoomable) {\n      var newWidth = naturalWidth * ratio;\n      var newHeight = naturalHeight * ratio;\n      var originalEvent = void 0;\n\n      if (_event) {\n        originalEvent = _event.originalEvent;\n      }\n\n      if (self.trigger('zoom', {\n        originalEvent: originalEvent,\n        oldRatio: width / naturalWidth,\n        ratio: newWidth / naturalWidth\n      }).isDefaultPrevented()) {\n        return;\n      }\n\n      if (originalEvent) {\n        var offset = self.$cropper.offset();\n        var center = pointers && objectKeys(pointers).length ? getPointersCenter(pointers) : {\n          pageX: _event.pageX || originalEvent.pageX || 0,\n          pageY: _event.pageY || originalEvent.pageY || 0\n        };\n\n        // Zoom from the triggering point of the event\n        canvas.left -= (newWidth - width) * ((center.pageX - offset.left - canvas.left) / width);\n        canvas.top -= (newHeight - height) * ((center.pageY - offset.top - canvas.top) / height);\n      } else {\n        // Zoom from the center of the canvas\n        canvas.left -= (newWidth - width) / 2;\n        canvas.top -= (newHeight - height) / 2;\n      }\n\n      canvas.width = newWidth;\n      canvas.height = newHeight;\n      self.renderCanvas(true);\n    }\n  },\n\n\n  /**\n   * Rotate the canvas with a relative degree\n   *\n   * @param {Number} degree\n   */\n  rotate: function rotate(degree) {\n    var self = this;\n\n    self.rotateTo((self.image.rotate || 0) + Number(degree));\n  },\n\n\n  /**\n   * Rotate the canvas to an absolute degree\n   * https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function#rotate()\n   *\n   * @param {Number} degree\n   */\n  rotateTo: function rotateTo(degree) {\n    var self = this;\n\n    degree = Number(degree);\n\n    if (isNumber(degree) && self.ready && !self.disabled && self.options.rotatable) {\n      self.image.rotate = degree % 360;\n      self.rotated = true;\n      self.renderCanvas(true);\n    }\n  },\n\n\n  /**\n   * Scale the image\n   * https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function#scale()\n   *\n   * @param {Number} scaleX\n   * @param {Number} scaleY (optional)\n   */\n  scale: function scale(scaleX, scaleY) {\n    var self = this;\n    var image = self.image;\n    var changed = false;\n\n    // If \"scaleY\" is not present, its default value is \"scaleX\"\n    if (isUndefined(scaleY)) {\n      scaleY = scaleX;\n    }\n\n    scaleX = Number(scaleX);\n    scaleY = Number(scaleY);\n\n    if (self.ready && !self.disabled && self.options.scalable) {\n      if (isNumber(scaleX)) {\n        image.scaleX = scaleX;\n        changed = true;\n      }\n\n      if (isNumber(scaleY)) {\n        image.scaleY = scaleY;\n        changed = true;\n      }\n\n      if (changed) {\n        self.renderImage(true);\n      }\n    }\n  },\n\n\n  /**\n   * Scale the abscissa of the image\n   *\n   * @param {Number} scaleX\n   */\n  scaleX: function scaleX(_scaleX) {\n    var self = this;\n    var scaleY = self.image.scaleY;\n\n    self.scale(_scaleX, isNumber(scaleY) ? scaleY : 1);\n  },\n\n\n  /**\n   * Scale the ordinate of the image\n   *\n   * @param {Number} scaleY\n   */\n  scaleY: function scaleY(_scaleY) {\n    var self = this;\n    var scaleX = self.image.scaleX;\n\n    self.scale(isNumber(scaleX) ? scaleX : 1, _scaleY);\n  },\n\n\n  /**\n   * Get the cropped area position and size data (base on the original image)\n   *\n   * @param {Boolean} isRounded (optional)\n   * @return {Object} data\n   */\n  getData: function getData(isRounded) {\n    var self = this;\n    var options = self.options;\n    var image = self.image;\n    var canvas = self.canvas;\n    var cropBox = self.cropBox;\n    var ratio = void 0;\n    var data = void 0;\n\n    if (self.ready && self.cropped) {\n      data = {\n        x: cropBox.left - canvas.left,\n        y: cropBox.top - canvas.top,\n        width: cropBox.width,\n        height: cropBox.height\n      };\n\n      ratio = image.width / image.naturalWidth;\n\n      $.each(data, function (i, n) {\n        n /= ratio;\n        data[i] = isRounded ? Math.round(n) : n;\n      });\n    } else {\n      data = {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0\n      };\n    }\n\n    if (options.rotatable) {\n      data.rotate = image.rotate || 0;\n    }\n\n    if (options.scalable) {\n      data.scaleX = image.scaleX || 1;\n      data.scaleY = image.scaleY || 1;\n    }\n\n    return data;\n  },\n\n\n  /**\n   * Set the cropped area position and size with new data\n   *\n   * @param {Object} data\n   */\n  setData: function setData(data) {\n    var self = this;\n    var options = self.options;\n    var image = self.image;\n    var canvas = self.canvas;\n    var cropBoxData = {};\n    var rotated = void 0;\n    var isScaled = void 0;\n    var ratio = void 0;\n\n    if ($.isFunction(data)) {\n      data = data.call(self.element);\n    }\n\n    if (self.ready && !self.disabled && $.isPlainObject(data)) {\n      if (options.rotatable) {\n        if (isNumber(data.rotate) && data.rotate !== image.rotate) {\n          image.rotate = data.rotate;\n          self.rotated = rotated = true;\n        }\n      }\n\n      if (options.scalable) {\n        if (isNumber(data.scaleX) && data.scaleX !== image.scaleX) {\n          image.scaleX = data.scaleX;\n          isScaled = true;\n        }\n\n        if (isNumber(data.scaleY) && data.scaleY !== image.scaleY) {\n          image.scaleY = data.scaleY;\n          isScaled = true;\n        }\n      }\n\n      if (rotated) {\n        self.renderCanvas();\n      } else if (isScaled) {\n        self.renderImage();\n      }\n\n      ratio = image.width / image.naturalWidth;\n\n      if (isNumber(data.x)) {\n        cropBoxData.left = data.x * ratio + canvas.left;\n      }\n\n      if (isNumber(data.y)) {\n        cropBoxData.top = data.y * ratio + canvas.top;\n      }\n\n      if (isNumber(data.width)) {\n        cropBoxData.width = data.width * ratio;\n      }\n\n      if (isNumber(data.height)) {\n        cropBoxData.height = data.height * ratio;\n      }\n\n      self.setCropBoxData(cropBoxData);\n    }\n  },\n\n\n  /**\n   * Get the container size data\n   *\n   * @return {Object} data\n   */\n  getContainerData: function getContainerData() {\n    return this.ready ? this.container : {};\n  },\n\n\n  /**\n   * Get the image position and size data\n   *\n   * @return {Object} data\n   */\n  getImageData: function getImageData() {\n    return this.loaded ? this.image : {};\n  },\n\n\n  /**\n   * Get the canvas position and size data\n   *\n   * @return {Object} data\n   */\n  getCanvasData: function getCanvasData() {\n    var self = this;\n    var canvas = self.canvas;\n    var data = {};\n\n    if (self.ready) {\n      $.each(['left', 'top', 'width', 'height', 'naturalWidth', 'naturalHeight'], function (i, n) {\n        data[n] = canvas[n];\n      });\n    }\n\n    return data;\n  },\n\n\n  /**\n   * Set the canvas position and size with new data\n   *\n   * @param {Object} data\n   */\n  setCanvasData: function setCanvasData(data) {\n    var self = this;\n    var canvas = self.canvas;\n    var aspectRatio = canvas.aspectRatio;\n\n    if ($.isFunction(data)) {\n      data = data.call(self.$element);\n    }\n\n    if (self.ready && !self.disabled && $.isPlainObject(data)) {\n      if (isNumber(data.left)) {\n        canvas.left = data.left;\n      }\n\n      if (isNumber(data.top)) {\n        canvas.top = data.top;\n      }\n\n      if (isNumber(data.width)) {\n        canvas.width = data.width;\n        canvas.height = data.width / aspectRatio;\n      } else if (isNumber(data.height)) {\n        canvas.height = data.height;\n        canvas.width = data.height * aspectRatio;\n      }\n\n      self.renderCanvas(true);\n    }\n  },\n\n\n  /**\n   * Get the crop box position and size data\n   *\n   * @return {Object} data\n   */\n  getCropBoxData: function getCropBoxData() {\n    var self = this;\n    var cropBox = self.cropBox;\n\n    return self.ready && self.cropped ? {\n      left: cropBox.left,\n      top: cropBox.top,\n      width: cropBox.width,\n      height: cropBox.height\n    } : {};\n  },\n\n\n  /**\n   * Set the crop box position and size with new data\n   *\n   * @param {Object} data\n   */\n  setCropBoxData: function setCropBoxData(data) {\n    var self = this;\n    var cropBox = self.cropBox;\n    var aspectRatio = self.options.aspectRatio;\n    var widthChanged = void 0;\n    var heightChanged = void 0;\n\n    if ($.isFunction(data)) {\n      data = data.call(self.$element);\n    }\n\n    if (self.ready && self.cropped && !self.disabled && $.isPlainObject(data)) {\n      if (isNumber(data.left)) {\n        cropBox.left = data.left;\n      }\n\n      if (isNumber(data.top)) {\n        cropBox.top = data.top;\n      }\n\n      if (isNumber(data.width) && data.width !== cropBox.width) {\n        widthChanged = true;\n        cropBox.width = data.width;\n      }\n\n      if (isNumber(data.height) && data.height !== cropBox.height) {\n        heightChanged = true;\n        cropBox.height = data.height;\n      }\n\n      if (aspectRatio) {\n        if (widthChanged) {\n          cropBox.height = cropBox.width / aspectRatio;\n        } else if (heightChanged) {\n          cropBox.width = cropBox.height * aspectRatio;\n        }\n      }\n\n      self.renderCropBox();\n    }\n  },\n\n\n  /**\n   * Get a canvas drawn the cropped image\n   *\n   * @param {Object} options (optional)\n   * @return {HTMLCanvasElement} canvas\n   */\n  getCroppedCanvas: function getCroppedCanvas(options) {\n    var self = this;\n\n    if (!self.ready || !window.HTMLCanvasElement) {\n      return null;\n    }\n\n    if (!$.isPlainObject(options)) {\n      options = {};\n    }\n\n    if (!self.cropped) {\n      return getSourceCanvas(self.$clone[0], self.image, options);\n    }\n\n    var data = self.getData();\n    var originalWidth = data.width;\n    var originalHeight = data.height;\n    var aspectRatio = originalWidth / originalHeight;\n    var scaledWidth = void 0;\n    var scaledHeight = void 0;\n    var scaledRatio = void 0;\n\n    if ($.isPlainObject(options)) {\n      scaledWidth = options.width;\n      scaledHeight = options.height;\n\n      if (scaledWidth) {\n        scaledHeight = scaledWidth / aspectRatio;\n        scaledRatio = scaledWidth / originalWidth;\n      } else if (scaledHeight) {\n        scaledWidth = scaledHeight * aspectRatio;\n        scaledRatio = scaledHeight / originalHeight;\n      }\n    }\n\n    // The canvas element will use `Math.Math.floor` on a float number, so Math.floor first\n    var canvasWidth = Math.floor(scaledWidth || originalWidth);\n    var canvasHeight = Math.floor(scaledHeight || originalHeight);\n\n    var canvas = $('<canvas>')[0];\n    var context = canvas.getContext('2d');\n\n    canvas.width = canvasWidth;\n    canvas.height = canvasHeight;\n\n    if (options.fillColor) {\n      context.fillStyle = options.fillColor;\n      context.fillRect(0, 0, canvasWidth, canvasHeight);\n    }\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D.drawImage\n    var parameters = function () {\n      var source = getSourceCanvas(self.$clone[0], self.image, options);\n      var sourceWidth = source.width;\n      var sourceHeight = source.height;\n      var canvasData = self.canvas;\n      var params = [source];\n\n      // Source canvas\n      var srcX = data.x + canvasData.naturalWidth * (Math.abs(data.scaleX || 1) - 1) / 2;\n      var srcY = data.y + canvasData.naturalHeight * (Math.abs(data.scaleY || 1) - 1) / 2;\n      var srcWidth = void 0;\n      var srcHeight = void 0;\n\n      // Destination canvas\n      var dstX = void 0;\n      var dstY = void 0;\n      var dstWidth = void 0;\n      var dstHeight = void 0;\n\n      if (srcX <= -originalWidth || srcX > sourceWidth) {\n        srcX = srcWidth = dstX = dstWidth = 0;\n      } else if (srcX <= 0) {\n        dstX = -srcX;\n        srcX = 0;\n        srcWidth = dstWidth = Math.min(sourceWidth, originalWidth + srcX);\n      } else if (srcX <= sourceWidth) {\n        dstX = 0;\n        srcWidth = dstWidth = Math.min(originalWidth, sourceWidth - srcX);\n      }\n\n      if (srcWidth <= 0 || srcY <= -originalHeight || srcY > sourceHeight) {\n        srcY = srcHeight = dstY = dstHeight = 0;\n      } else if (srcY <= 0) {\n        dstY = -srcY;\n        srcY = 0;\n        srcHeight = dstHeight = Math.min(sourceHeight, originalHeight + srcY);\n      } else if (srcY <= sourceHeight) {\n        dstY = 0;\n        srcHeight = dstHeight = Math.min(originalHeight, sourceHeight - srcY);\n      }\n\n      // All the numerical parameters should be integer for `drawImage` (#476)\n      params.push(Math.floor(srcX), Math.floor(srcY), Math.floor(srcWidth), Math.floor(srcHeight));\n\n      // Scale destination sizes\n      if (scaledRatio) {\n        dstX *= scaledRatio;\n        dstY *= scaledRatio;\n        dstWidth *= scaledRatio;\n        dstHeight *= scaledRatio;\n      }\n\n      // Avoid \"IndexSizeError\" in IE and Firefox\n      if (dstWidth > 0 && dstHeight > 0) {\n        params.push(Math.floor(dstX), Math.floor(dstY), Math.floor(dstWidth), Math.floor(dstHeight));\n      }\n\n      return params;\n    }();\n\n    context.imageSmoothingEnabled = !!options.imageSmoothingEnabled;\n\n    if (options.imageSmoothingQuality) {\n      context.imageSmoothingQuality = options.imageSmoothingQuality;\n    }\n\n    context.drawImage.apply(context, toConsumableArray(parameters));\n\n    return canvas;\n  },\n\n\n  /**\n   * Change the aspect ratio of the crop box\n   *\n   * @param {Number} aspectRatio\n   */\n  setAspectRatio: function setAspectRatio(aspectRatio) {\n    var self = this;\n    var options = self.options;\n\n    if (!self.disabled && !isUndefined(aspectRatio)) {\n      // 0 -> NaN\n      options.aspectRatio = Math.max(0, aspectRatio) || NaN;\n\n      if (self.ready) {\n        self.initCropBox();\n\n        if (self.cropped) {\n          self.renderCropBox();\n        }\n      }\n    }\n  },\n\n\n  /**\n   * Change the drag mode\n   *\n   * @param {String} mode (optional)\n   */\n  setDragMode: function setDragMode(mode) {\n    var self = this;\n    var options = self.options;\n    var croppable = void 0;\n    var movable = void 0;\n\n    if (self.loaded && !self.disabled) {\n      croppable = mode === 'crop';\n      movable = options.movable && mode === 'move';\n      mode = croppable || movable ? mode : 'none';\n\n      self.$dragBox.data('action', mode).toggleClass('cropper-crop', croppable).toggleClass('cropper-move', movable);\n\n      if (!options.cropBoxMovable) {\n        // Sync drag mode to crop box when it is not movable(#300)\n        self.$face.data('action', mode).toggleClass('cropper-crop', croppable).toggleClass('cropper-move', movable);\n      }\n    }\n  }\n};\n\nvar CLASS_HIDDEN = 'cropper-hidden';\nvar REGEXP_DATA_URL = /^data:/;\nvar REGEXP_DATA_URL_JPEG = /^data:image\\/jpeg;base64,/;\n\nvar Cropper = function () {\n  function Cropper(element, options) {\n    classCallCheck(this, Cropper);\n\n    var self = this;\n\n    self.$element = $(element);\n    self.options = $.extend({}, DEFAULTS, $.isPlainObject(options) && options);\n    self.loaded = false;\n    self.ready = false;\n    self.completed = false;\n    self.rotated = false;\n    self.cropped = false;\n    self.disabled = false;\n    self.replaced = false;\n    self.limited = false;\n    self.wheeling = false;\n    self.isImg = false;\n    self.originalUrl = '';\n    self.canvas = null;\n    self.cropBox = null;\n    self.pointers = {};\n    self.init();\n  }\n\n  createClass(Cropper, [{\n    key: 'init',\n    value: function init() {\n      var self = this;\n      var $this = self.$element;\n      var url = void 0;\n\n      if ($this.is('img')) {\n        self.isImg = true;\n\n        // Should use `$.fn.attr` here. e.g.: \"img/picture.jpg\"\n        self.originalUrl = url = $this.attr('src');\n\n        // Stop when it's a blank image\n        if (!url) {\n          return;\n        }\n\n        // Should use `$.fn.prop` here. e.g.: \"http://example.com/img/picture.jpg\"\n        url = $this.prop('src');\n      } else if ($this.is('canvas') && window.HTMLCanvasElement) {\n        url = $this[0].toDataURL();\n      }\n\n      self.load(url);\n    }\n\n    // A shortcut for triggering custom events\n\n  }, {\n    key: 'trigger',\n    value: function trigger(type, data) {\n      var e = $.Event(type, data);\n\n      this.$element.trigger(e);\n\n      return e;\n    }\n  }, {\n    key: 'load',\n    value: function load(url) {\n      var self = this;\n      var options = self.options;\n      var $this = self.$element;\n\n      if (!url) {\n        return;\n      }\n\n      self.url = url;\n      self.image = {};\n\n      if (!options.checkOrientation || !window.ArrayBuffer) {\n        self.clone();\n        return;\n      }\n\n      // XMLHttpRequest disallows to open a Data URL in some browsers like IE11 and Safari\n      if (REGEXP_DATA_URL.test(url)) {\n        if (REGEXP_DATA_URL_JPEG.test(url)) {\n          self.read(dataURLToArrayBuffer(url));\n        } else {\n          self.clone();\n        }\n        return;\n      }\n\n      var xhr = new XMLHttpRequest();\n\n      xhr.onerror = xhr.onabort = $.proxy(function () {\n        self.clone();\n      }, this);\n\n      xhr.onload = function load() {\n        self.read(this.response);\n      };\n\n      if (options.checkCrossOrigin && isCrossOriginURL(url) && $this.prop('crossOrigin')) {\n        url = addTimestamp(url);\n      }\n\n      xhr.open('get', url);\n      xhr.responseType = 'arraybuffer';\n      xhr.withCredentials = $this.prop('crossOrigin') === 'use-credentials';\n      xhr.send();\n    }\n  }, {\n    key: 'read',\n    value: function read(arrayBuffer) {\n      var self = this;\n      var options = self.options;\n      var orientation = getOrientation(arrayBuffer);\n      var image = self.image;\n      var rotate = 0;\n      var scaleX = 1;\n      var scaleY = 1;\n\n      if (orientation > 1) {\n        self.url = arrayBufferToDataURL(arrayBuffer);\n\n        switch (orientation) {\n\n          // flip horizontal\n          case 2:\n            scaleX = -1;\n            break;\n\n          // rotate left 180\n          case 3:\n            rotate = -180;\n            break;\n\n          // flip vertical\n          case 4:\n            scaleY = -1;\n            break;\n\n          // flip vertical + rotate right 90\n          case 5:\n            rotate = 90;\n            scaleY = -1;\n            break;\n\n          // rotate right 90\n          case 6:\n            rotate = 90;\n            break;\n\n          // flip horizontal + rotate right 90\n          case 7:\n            rotate = 90;\n            scaleX = -1;\n            break;\n\n          // rotate left 90\n          case 8:\n            rotate = -90;\n            break;\n        }\n      }\n\n      if (options.rotatable) {\n        image.rotate = rotate;\n      }\n\n      if (options.scalable) {\n        image.scaleX = scaleX;\n        image.scaleY = scaleY;\n      }\n\n      self.clone();\n    }\n  }, {\n    key: 'clone',\n    value: function clone() {\n      var self = this;\n      var options = self.options;\n      var $this = self.$element;\n      var url = self.url;\n      var crossOrigin = '';\n      var crossOriginUrl = void 0;\n\n      if (options.checkCrossOrigin && isCrossOriginURL(url)) {\n        crossOrigin = $this.prop('crossOrigin');\n\n        if (crossOrigin) {\n          crossOriginUrl = url;\n        } else {\n          crossOrigin = 'anonymous';\n\n          // Bust cache (#148) when there is not a \"crossOrigin\" property\n          crossOriginUrl = addTimestamp(url);\n        }\n      }\n\n      self.crossOrigin = crossOrigin;\n      self.crossOriginUrl = crossOriginUrl;\n\n      var image = document.createElement('img');\n\n      if (crossOrigin) {\n        image.crossOrigin = crossOrigin;\n      }\n\n      image.src = crossOriginUrl || url;\n\n      var $clone = $(image);\n\n      self.$clone = $clone;\n\n      if (self.isImg) {\n        if ($this[0].complete) {\n          self.start();\n        } else {\n          $this.one('load', $.proxy(self.start, this));\n        }\n      } else {\n        $clone.one('load', $.proxy(self.start, this)).one('error', $.proxy(self.stop, this)).addClass('cropper-hide').insertAfter($this);\n      }\n    }\n  }, {\n    key: 'start',\n    value: function start() {\n      var self = this;\n      var $clone = self.$clone;\n      var $image = self.$element;\n\n      if (!self.isImg) {\n        $clone.off('error', self.stop);\n        $image = $clone;\n      }\n\n      getImageSize($image[0], function (naturalWidth, naturalHeight) {\n        $.extend(self.image, {\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight,\n          aspectRatio: naturalWidth / naturalHeight\n        });\n\n        self.loaded = true;\n        self.build();\n      });\n    }\n  }, {\n    key: 'stop',\n    value: function stop() {\n      var self = this;\n\n      self.$clone.remove();\n      self.$clone = null;\n    }\n  }, {\n    key: 'build',\n    value: function build() {\n      var self = this;\n      var options = self.options;\n      var $this = self.$element;\n      var $clone = self.$clone;\n      var $cropper = void 0;\n      var $cropBox = void 0;\n      var $face = void 0;\n\n      if (!self.loaded) {\n        return;\n      }\n\n      // Unbuild first when replace\n      if (self.ready) {\n        self.unbuild();\n      }\n\n      // Create cropper elements\n      self.$container = $this.parent();\n      self.$cropper = $cropper = $(TEMPLATE);\n      self.$canvas = $cropper.find('.cropper-canvas').append($clone);\n      self.$dragBox = $cropper.find('.cropper-drag-box');\n      self.$cropBox = $cropBox = $cropper.find('.cropper-crop-box');\n      self.$viewBox = $cropper.find('.cropper-view-box');\n      self.$face = $face = $cropBox.find('.cropper-face');\n\n      // Hide the original image\n      $this.addClass(CLASS_HIDDEN).after($cropper);\n\n      // Show the clone image if is hidden\n      if (!self.isImg) {\n        $clone.removeClass('cropper-hide');\n      }\n\n      self.initPreview();\n      self.bind();\n\n      options.aspectRatio = Math.max(0, options.aspectRatio) || NaN;\n      options.viewMode = Math.max(0, Math.min(3, Math.round(options.viewMode))) || 0;\n\n      self.cropped = options.autoCrop;\n\n      if (options.autoCrop) {\n        if (options.modal) {\n          self.$dragBox.addClass('cropper-modal');\n        }\n      } else {\n        $cropBox.addClass(CLASS_HIDDEN);\n      }\n\n      if (!options.guides) {\n        $cropBox.find('.cropper-dashed').addClass(CLASS_HIDDEN);\n      }\n\n      if (!options.center) {\n        $cropBox.find('.cropper-center').addClass(CLASS_HIDDEN);\n      }\n\n      if (options.cropBoxMovable) {\n        $face.addClass('cropper-move').data('action', 'all');\n      }\n\n      if (!options.highlight) {\n        $face.addClass('cropper-invisible');\n      }\n\n      if (options.background) {\n        $cropper.addClass('cropper-bg');\n      }\n\n      if (!options.cropBoxResizable) {\n        $cropBox.find('.cropper-line, .cropper-point').addClass(CLASS_HIDDEN);\n      }\n\n      self.setDragMode(options.dragMode);\n      self.render();\n      self.ready = true;\n      self.setData(options.data);\n\n      // Trigger the ready event asynchronously to keep `data('cropper')` is defined\n      self.completing = setTimeout(function () {\n        if ($.isFunction(options.ready)) {\n          $this.one('ready', options.ready);\n        }\n\n        self.trigger('ready');\n        self.trigger('crop', self.getData());\n        self.completed = true;\n      }, 0);\n    }\n  }, {\n    key: 'unbuild',\n    value: function unbuild() {\n      var self = this;\n\n      if (!self.ready) {\n        return;\n      }\n\n      if (!self.completed) {\n        clearTimeout(self.completing);\n      }\n\n      self.ready = false;\n      self.completed = false;\n      self.initialImage = null;\n\n      // Clear `initialCanvas` is necessary when replace\n      self.initialCanvas = null;\n      self.initialCropBox = null;\n      self.container = null;\n      self.canvas = null;\n\n      // Clear `cropBox` is necessary when replace\n      self.cropBox = null;\n      self.unbind();\n\n      self.resetPreview();\n      self.$preview = null;\n\n      self.$viewBox = null;\n      self.$cropBox = null;\n      self.$dragBox = null;\n      self.$canvas = null;\n      self.$container = null;\n\n      self.$cropper.remove();\n      self.$cropper = null;\n    }\n  }], [{\n    key: 'setDefaults',\n    value: function setDefaults(options) {\n      $.extend(DEFAULTS, $.isPlainObject(options) && options);\n    }\n  }]);\n  return Cropper;\n}();\n\n$.extend(Cropper.prototype, render$1);\n$.extend(Cropper.prototype, preview$1);\n$.extend(Cropper.prototype, events);\n$.extend(Cropper.prototype, handlers);\n$.extend(Cropper.prototype, change$1);\n$.extend(Cropper.prototype, methods);\n\nvar NAMESPACE = 'cropper';\nvar OtherCropper = $.fn.cropper;\n\n$.fn.cropper = function jQueryCropper(option) {\n  for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  var result = void 0;\n\n  this.each(function (i, element) {\n    var $this = $(element);\n    var data = $this.data(NAMESPACE);\n\n    if (!data) {\n      if (/destroy/.test(option)) {\n        return;\n      }\n\n      var options = $.extend({}, $this.data(), $.isPlainObject(option) && option);\n      $this.data(NAMESPACE, data = new Cropper(element, options));\n    }\n\n    if (typeof option === 'string') {\n      var fn = data[option];\n\n      if ($.isFunction(fn)) {\n        result = fn.apply(data, args);\n      }\n    }\n  });\n\n  return typeof result !== 'undefined' ? result : this;\n};\n\n$.fn.cropper.Constructor = Cropper;\n$.fn.cropper.setDefaults = Cropper.setDefaults;\n\n// No conflict\n$.fn.cropper.noConflict = function noConflict() {\n  $.fn.cropper = OtherCropper;\n  return this;\n};\n"]}