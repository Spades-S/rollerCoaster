{"version":3,"sources":["../../../../www/static/cropper/cropper.js"],"names":["global","factory","exports","module","require","define","amd","jQuery","$","DEFAULTS","viewMode","dragMode","aspectRatio","NaN","data","preview","responsive","restore","checkCrossOrigin","checkOrientation","modal","guides","center","highlight","background","autoCrop","autoCropArea","movable","rotatable","scalable","zoomable","zoomOnTouch","zoomOnWheel","wheelZoomRatio","cropBoxMovable","cropBoxResizable","toggleDragModeOnDblclick","minCanvasWidth","minCanvasHeight","minCropBoxWidth","minCropBoxHeight","minContainerWidth","minContainerHeight","ready","cropstart","cropmove","cropend","crop","zoom","TEMPLATE","REGEXP_DATA_URL_HEAD","REGEXP_USERAGENT","navigator","window","IS_SAFARI_OR_UIWEBVIEW","test","userAgent","fromCharCode","String","isNumber","n","isNaN","isUndefined","toArray","obj","offset","args","push","slice","apply","proxy","fn","context","_len","arguments","length","Array","_key","_len2","args2","_key2","concat","objectKeys","keys","each","key","isCrossOriginURL","url","parts","match","location","protocol","hostname","port","addTimestamp","timestamp","Date","getTime","indexOf","getImageSize","image","callback","naturalWidth","naturalHeight","newImage","document","createElement","onload","load","width","height","src","getTransform","options","transforms","translateX","translateY","rotate","scaleX","scaleY","join","getRotatedSizes","isReversed","deg","Math","abs","degree","arc","PI","sinArc","sin","cosArc","cos","newWidth","newHeight","getSourceCanvas","canvas","getContext","dstX","dstY","dstWidth","dstHeight","advanced","canvasWidth","canvasHeight","rotated","fillColor","fillStyle","fillRect","save","translate","scale","imageSmoothingEnabled","imageSmoothingQuality","drawImage","floor","getStringFromCharCode","dataView","start","str","i","getUint8","getOrientation","arrayBuffer","DataView","byteLength","orientation","exifIDCode","tiffOffset","firstIFDOffset","littleEndian","endianness","app1Start","ifdStart","getUint16","getUint32","setUint16","dataURLToArrayBuffer","dataURL","base64","replace","binary","atob","ArrayBuffer","Uint8Array","charCodeAt","arrayBufferToDataURL","btoa","render$1","render","self","initContainer","initCanvas","initCropBox","renderCanvas","cropped","renderCropBox","$this","$element","$container","$cropper","hidden","addClass","removeClass","css","container","max","Number","containerWidth","containerHeight","imageNaturalWidth","imageNaturalHeight","is90Degree","oldLeft","left","oldTop","top","limited","limitCanvas","initialImage","extend","initialCanvas","isSizeLimited","isPositionLimited","cropBox","minWidth","minHeight","maxWidth","Infinity","maxHeight","newCanvasLeft","newCanvasTop","minLeft","min","minTop","maxLeft","maxTop","isChanged","isSquareImage","rotated2","$canvas","transform","renderImage","limitCropBox","output","reversed","$clone","initialCropBox","maxCropBoxWidth","maxCropBoxHeight","$face","$cropBox","disabled","completed","trigger","getData","DATA_PREVIEW","preview$1","initPreview","crossOrigin","crossOriginUrl","$clone2","$preview","$viewBox","html","element","img","style","cssText","resetPreview","removeData","cropBoxWidth","cropBoxHeight","originalWidth","originalHeight","ratio","find","PointerEvent","EVENT_POINTER_DOWN","EVENT_POINTER_MOVE","EVENT_POINTER_UP","EVENT_WHEEL","EVENT_DBLCLICK","EVENT_RESIZE","EVENT_CROP_START","EVENT_CROP_MOVE","EVENT_CROP_END","EVENT_CROP","EVENT_ZOOM","events","bind","isFunction","on","cropStart","wheel","dblclick","onCropMove","cropMove","onCropEnd","cropEnd","onResize","resize","unbind","off","REGEXP_ACTIONS","getPointer","_ref","endOnly","pageX","pageY","end","endX","endY","startX","startY","handlers","canvasData","cropBoxData","getCanvasData","getCropBoxData","setCanvasData","setCropBoxData","setDragMode","$dragBox","hasClass","event","e","originalEvent","preventDefault","wheeling","setTimeout","delta","deltaY","wheelDelta","detail","pointers","action","changedTouches","touch","identifier","pointerId","target","isDefaultPrevented","cropping","change","toggleClass","ACTION_EAST","ACTION_WEST","ACTION_SOUTH","ACTION_NORTH","ACTION_SOUTH_EAST","ACTION_SOUTH_WEST","ACTION_NORTH_EAST","ACTION_NORTH_WEST","getMaxZoomRatio","pointers2","ratios","pointer","pointerId2","pointer2","x1","y1","x2","y2","z1","sqrt","z2","sort","a","b","change$1","right","bottom","renderable","shiftKey","range","x","y","X","Y","move","p","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","prototype","get","object","property","receiver","Function","desc","undefined","parent","value","getter","call","set","setter","toConsumableArray","arr","isArray","arr2","getPointersCenter","count","methods","reset","clear","onlyColorChanged","isImg","attr","add","replaced","enable","disable","destroy","loaded","originalUrl","unbuild","remove","offsetX","offsetY","moveTo","changed","_event","zoomTo","oldRatio","rotateTo","_scaleX","_scaleY","isRounded","round","setData","isScaled","isPlainObject","getContainerData","getImageData","widthChanged","heightChanged","getCroppedCanvas","HTMLCanvasElement","scaledWidth","scaledHeight","scaledRatio","parameters","source","sourceWidth","sourceHeight","params","srcX","srcY","srcWidth","srcHeight","setAspectRatio","mode","croppable","CLASS_HIDDEN","REGEXP_DATA_URL","REGEXP_DATA_URL_JPEG","Cropper","init","is","prop","toDataURL","type","Event","clone","read","xhr","XMLHttpRequest","onerror","onabort","response","open","responseType","withCredentials","send","complete","one","stop","insertAfter","$image","build","append","after","completing","clearTimeout","setDefaults","NAMESPACE","OtherCropper","cropper","jQueryCropper","option","result","noConflict"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;AAUC,WAAUA,MAAV,EAAkBC,OAAlB,EAA2B;AAC1B,UAAOC,OAAP,uDAAOA,OAAP,OAAmB,QAAnB,IAA+B,OAAOC,MAAP,KAAkB,WAAjD,GAA+DF,QAAQG,QAAQ,QAAR,CAAR,CAA/D,GACA,OAAOC,MAAP,KAAkB,UAAlB,IAAgCA,OAAOC,GAAvC,GAA6CD,OAAO,CAAC,QAAD,CAAP,EAAmBJ,OAAnB,CAA7C,GACCA,QAAQD,OAAOO,MAAf,CAFD;AAGD,CAJA,aAIQ,UAAUC,CAAV,EAAa;AAAE;;AAExBA,MAAI,aAAaA,CAAb,GAAiBA,EAAE,SAAF,CAAjB,GAAgCA,CAApC;;AAEA,MAAIC,WAAW;AACb;AACAC,cAAU,CAFG,EAEA;;AAEb;AACAC,cAAU,MALG,EAKK;;AAElB;AACAC,iBAAaC,GARA;;AAUb;AACAC,UAAM,IAXO;;AAab;AACAC,aAAS,EAdI;;AAgBb;AACAC,gBAAY,IAjBC;;AAmBb;AACAC,aAAS,IApBI;;AAsBb;AACAC,sBAAkB,IAvBL;;AAyBb;AACAC,sBAAkB,IA1BL;;AA4Bb;AACAC,WAAO,IA7BM;;AA+Bb;AACAC,YAAQ,IAhCK;;AAkCb;AACAC,YAAQ,IAnCK;;AAqCb;AACAC,eAAW,IAtCE;;AAwCb;AACAC,gBAAY,IAzCC;;AA2Cb;AACAC,cAAU,IA5CG;;AA8Cb;AACAC,kBAAc,GA/CD;;AAiDb;AACAC,aAAS,IAlDI;;AAoDb;AACAC,eAAW,IArDE;;AAuDb;AACAC,cAAU,IAxDG;;AA0Db;AACAC,cAAU,IA3DG;;AA6Db;AACAC,iBAAa,IA9DA;;AAgEb;AACAC,iBAAa,IAjEA;;AAmEb;AACAC,oBAAgB,GApEH;;AAsEb;AACAC,oBAAgB,IAvEH;;AAyEb;AACAC,sBAAkB,IA1EL;;AA4Eb;AACAC,8BAA0B,IA7Eb;;AA+Eb;AACAC,oBAAgB,CAhFH;AAiFbC,qBAAiB,CAjFJ;AAkFbC,qBAAiB,CAlFJ;AAmFbC,sBAAkB,CAnFL;AAoFbC,uBAAmB,GApFN;AAqFbC,wBAAoB,GArFP;;AAuFb;AACAC,WAAO,IAxFM;AAyFbC,eAAW,IAzFE;AA0FbC,cAAU,IA1FG;AA2FbC,aAAS,IA3FI;AA4FbC,UAAM,IA5FO;AA6FbC,UAAM;AA7FO,GAAf;;AAgGA,MAAIC,WAAW,oCAAoC,gCAApC,GAAuE,oCAAvE,GAA8G,QAA9G,GAAyH,sCAAzH,GAAkK,gCAAlK,GAAqM,wCAArM,GAAgP,+CAAhP,GAAkS,+CAAlS,GAAoV,sCAApV,GAA6X,oCAA7X,GAAoa,2DAApa,GAAke,2DAAle,GAAgiB,2DAAhiB,GAA8lB,2DAA9lB,GAA4pB,6DAA5pB,GAA4tB,6DAA5tB,GAA4xB,6DAA5xB,GAA41B,6DAA51B,GAA45B,+DAA55B,GAA89B,+DAA99B,GAAgiC,+DAAhiC,GAAkmC,+DAAlmC,GAAoqC,QAApqC,GAA+qC,QAA9rC;;AAEA,MAAIC,uBAAuB,WAA3B;AACA,MAAIC,mBAAmB,4CAAvB;AACA,MAAIC,YAAY,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,OAAOD,SAAvC,GAAmD,IAAnE;AACA,MAAIE,yBAAyBF,aAAaD,iBAAiBI,IAAjB,CAAsBH,UAAUI,SAAhC,CAA1C;AACA,MAAIC,eAAeC,OAAOD,YAA1B;;AAEA,WAASE,QAAT,CAAkBC,CAAlB,EAAqB;AACnB,WAAO,OAAOA,CAAP,KAAa,QAAb,IAAyB,CAACC,MAAMD,CAAN,CAAjC;AACD;;AAED,WAASE,WAAT,CAAqBF,CAArB,EAAwB;AACtB,WAAO,OAAOA,CAAP,KAAa,WAApB;AACD;;AAED,WAASG,OAAT,CAAiBC,GAAjB,EAAsBC,MAAtB,EAA8B;AAC5B,QAAIC,OAAO,EAAX;;AAEA;AACA,QAAIP,SAASM,MAAT,CAAJ,EAAsB;AACpBC,WAAKC,IAAL,CAAUF,MAAV;AACD;;AAED,WAAOC,KAAKE,KAAL,CAAWC,KAAX,CAAiBL,GAAjB,EAAsBE,IAAtB,CAAP;AACD;;AAED;AACA,WAASI,KAAT,CAAeC,EAAf,EAAmBC,OAAnB,EAA4B;AAC1B,SAAK,IAAIC,OAAOC,UAAUC,MAArB,EAA6BT,OAAOU,MAAMH,OAAO,CAAP,GAAWA,OAAO,CAAlB,GAAsB,CAA5B,CAApC,EAAoEI,OAAO,CAAhF,EAAmFA,OAAOJ,IAA1F,EAAgGI,MAAhG,EAAwG;AACtGX,WAAKW,OAAO,CAAZ,IAAiBH,UAAUG,IAAV,CAAjB;AACD;;AAED,WAAO,YAAY;AACjB,WAAK,IAAIC,QAAQJ,UAAUC,MAAtB,EAA8BI,QAAQH,MAAME,KAAN,CAAtC,EAAoDE,QAAQ,CAAjE,EAAoEA,QAAQF,KAA5E,EAAmFE,OAAnF,EAA4F;AAC1FD,cAAMC,KAAN,IAAeN,UAAUM,KAAV,CAAf;AACD;;AAED,aAAOT,GAAGF,KAAH,CAASG,OAAT,EAAkBN,KAAKe,MAAL,CAAYlB,QAAQgB,KAAR,CAAZ,CAAlB,CAAP;AACD,KAND;AAOD;;AAED,WAASG,UAAT,CAAoBlB,GAApB,EAAyB;AACvB,QAAImB,OAAO,EAAX;;AAEA3E,MAAE4E,IAAF,CAAOpB,GAAP,EAAY,UAAUqB,GAAV,EAAe;AACzBF,WAAKhB,IAAL,CAAUkB,GAAV;AACD,KAFD;;AAIA,WAAOF,IAAP;AACD;;AAED,WAASG,gBAAT,CAA0BC,GAA1B,EAA+B;AAC7B,QAAIC,QAAQD,IAAIE,KAAJ,CAAU,kCAAV,CAAZ;;AAEA,WAAOD,UAAUA,MAAM,CAAN,MAAaE,SAASC,QAAtB,IAAkCH,MAAM,CAAN,MAAaE,SAASE,QAAxD,IAAoEJ,MAAM,CAAN,MAAaE,SAASG,IAApG,CAAP;AACD;;AAED,WAASC,YAAT,CAAsBP,GAAtB,EAA2B;AACzB,QAAIQ,YAAY,eAAe,IAAIC,IAAJ,GAAWC,OAAX,EAA/B;;AAEA,WAAOV,OAAOA,IAAIW,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAAtB,GAA0B,GAA1B,GAAgC,GAAvC,IAA8CH,SAArD;AACD;;AAED,WAASI,YAAT,CAAsBC,KAAtB,EAA6BC,QAA7B,EAAuC;AACrC;AACA,QAAID,MAAME,YAAN,IAAsB,CAAChD,sBAA3B,EAAmD;AACjD+C,eAASD,MAAME,YAAf,EAA6BF,MAAMG,aAAnC;AACA;AACD;;AAED;AACA,QAAIC,WAAWC,SAASC,aAAT,CAAuB,KAAvB,CAAf;;AAEAF,aAASG,MAAT,GAAkB,SAASC,IAAT,GAAgB;AAChCP,eAAS,KAAKQ,KAAd,EAAqB,KAAKC,MAA1B;AACD,KAFD;;AAIAN,aAASO,GAAT,GAAeX,MAAMW,GAArB;AACD;;AAED,WAASC,YAAT,CAAsBC,OAAtB,EAA+B;AAC7B,QAAIC,aAAa,EAAjB;AACA,QAAIC,aAAaF,QAAQE,UAAzB;AACA,QAAIC,aAAaH,QAAQG,UAAzB;AACA,QAAIC,SAASJ,QAAQI,MAArB;AACA,QAAIC,SAASL,QAAQK,MAArB;AACA,QAAIC,SAASN,QAAQM,MAArB;;AAEA,QAAI5D,SAASwD,UAAT,KAAwBA,eAAe,CAA3C,EAA8C;AAC5CD,iBAAW/C,IAAX,CAAgB,gBAAgBgD,UAAhB,GAA6B,KAA7C;AACD;;AAED,QAAIxD,SAASyD,UAAT,KAAwBA,eAAe,CAA3C,EAA8C;AAC5CF,iBAAW/C,IAAX,CAAgB,gBAAgBiD,UAAhB,GAA6B,KAA7C;AACD;;AAED;AACA,QAAIzD,SAAS0D,MAAT,KAAoBA,WAAW,CAAnC,EAAsC;AACpCH,iBAAW/C,IAAX,CAAgB,YAAYkD,MAAZ,GAAqB,MAArC;AACD;;AAED,QAAI1D,SAAS2D,MAAT,KAAoBA,WAAW,CAAnC,EAAsC;AACpCJ,iBAAW/C,IAAX,CAAgB,YAAYmD,MAAZ,GAAqB,GAArC;AACD;;AAED,QAAI3D,SAAS4D,MAAT,KAAoBA,WAAW,CAAnC,EAAsC;AACpCL,iBAAW/C,IAAX,CAAgB,YAAYoD,MAAZ,GAAqB,GAArC;AACD;;AAED,WAAOL,WAAWvC,MAAX,GAAoBuC,WAAWM,IAAX,CAAgB,GAAhB,CAApB,GAA2C,MAAlD;AACD;;AAED,WAASC,eAAT,CAAyB3G,IAAzB,EAA+B4G,UAA/B,EAA2C;AACzC,QAAIC,MAAMC,KAAKC,GAAL,CAAS/G,KAAKgH,MAAd,IAAwB,GAAlC;AACA,QAAIC,MAAM,CAACJ,MAAM,EAAN,GAAW,MAAMA,GAAjB,GAAuBA,GAAxB,IAA+BC,KAAKI,EAApC,GAAyC,GAAnD;AACA,QAAIC,SAASL,KAAKM,GAAL,CAASH,GAAT,CAAb;AACA,QAAII,SAASP,KAAKQ,GAAL,CAASL,GAAT,CAAb;AACA,QAAIlB,QAAQ/F,KAAK+F,KAAjB;AACA,QAAIC,SAAShG,KAAKgG,MAAlB;AACA,QAAIlG,cAAcE,KAAKF,WAAvB;AACA,QAAIyH,WAAW,KAAK,CAApB;AACA,QAAIC,YAAY,KAAK,CAArB;;AAEA,QAAI,CAACZ,UAAL,EAAiB;AACfW,iBAAWxB,QAAQsB,MAAR,GAAiBrB,SAASmB,MAArC;AACAK,kBAAYzB,QAAQoB,MAAR,GAAiBnB,SAASqB,MAAtC;AACD,KAHD,MAGO;AACLE,iBAAWxB,SAASsB,SAASF,SAASrH,WAA3B,CAAX;AACA0H,kBAAYD,WAAWzH,WAAvB;AACD;;AAED,WAAO;AACLiG,aAAOwB,QADF;AAELvB,cAAQwB;AAFH,KAAP;AAID;;AAED,WAASC,eAAT,CAAyBnC,KAAzB,EAAgCtF,IAAhC,EAAsCmG,OAAtC,EAA+C;AAC7C,QAAIuB,SAAShI,EAAE,UAAF,EAAc,CAAd,CAAb;AACA,QAAIgE,UAAUgE,OAAOC,UAAP,CAAkB,IAAlB,CAAd;AACA,QAAIC,OAAO,CAAX;AACA,QAAIC,OAAO,CAAX;AACA,QAAIC,WAAW9H,KAAKwF,YAApB;AACA,QAAIuC,YAAY/H,KAAKyF,aAArB;AACA,QAAIc,SAASvG,KAAKuG,MAAlB;AACA,QAAIC,SAASxG,KAAKwG,MAAlB;AACA,QAAIC,SAASzG,KAAKyG,MAAlB;AACA,QAAI1F,WAAW8B,SAAS2D,MAAT,KAAoB3D,SAAS4D,MAAT,CAApB,KAAyCD,WAAW,CAAX,IAAgBC,WAAW,CAApE,CAAf;AACA,QAAI3F,YAAY+B,SAAS0D,MAAT,KAAoBA,WAAW,CAA/C;AACA,QAAIyB,WAAWlH,aAAaC,QAA5B;AACA,QAAIkH,cAAcH,WAAWhB,KAAKC,GAAL,CAASP,UAAU,CAAnB,CAA7B;AACA,QAAI0B,eAAeH,YAAYjB,KAAKC,GAAL,CAASN,UAAU,CAAnB,CAA/B;AACA,QAAIJ,aAAa,KAAK,CAAtB;AACA,QAAIC,aAAa,KAAK,CAAtB;AACA,QAAI6B,UAAU,KAAK,CAAnB;;AAEA,QAAIpH,QAAJ,EAAc;AACZsF,mBAAa4B,cAAc,CAA3B;AACA3B,mBAAa4B,eAAe,CAA5B;AACD;;AAED,QAAIpH,SAAJ,EAAe;AACbqH,gBAAUxB,gBAAgB;AACxBZ,eAAOkC,WADiB;AAExBjC,gBAAQkC,YAFgB;AAGxBlB,gBAAQT;AAHgB,OAAhB,CAAV;;AAMA0B,oBAAcE,QAAQpC,KAAtB;AACAmC,qBAAeC,QAAQnC,MAAvB;AACAK,mBAAa4B,cAAc,CAA3B;AACA3B,mBAAa4B,eAAe,CAA5B;AACD;;AAEDR,WAAO3B,KAAP,GAAekC,WAAf;AACAP,WAAO1B,MAAP,GAAgBkC,YAAhB;;AAEA,QAAI/B,QAAQiC,SAAZ,EAAuB;AACrB1E,cAAQ2E,SAAR,GAAoBlC,QAAQiC,SAA5B;AACA1E,cAAQ4E,QAAR,CAAiB,CAAjB,EAAoB,CAApB,EAAuBL,WAAvB,EAAoCC,YAApC;AACD;;AAED,QAAIF,QAAJ,EAAc;AACZJ,aAAO,CAACE,QAAD,GAAY,CAAnB;AACAD,aAAO,CAACE,SAAD,GAAa,CAApB;;AAEArE,cAAQ6E,IAAR;AACA7E,cAAQ8E,SAAR,CAAkBnC,UAAlB,EAA8BC,UAA9B;AACD;;AAED;AACA,QAAIxF,SAAJ,EAAe;AACb4C,cAAQ6C,MAAR,CAAeA,SAASO,KAAKI,EAAd,GAAmB,GAAlC;AACD;;AAED,QAAInG,QAAJ,EAAc;AACZ2C,cAAQ+E,KAAR,CAAcjC,MAAd,EAAsBC,MAAtB;AACD;;AAED/C,YAAQgF,qBAAR,GAAgC,CAAC,CAACvC,QAAQuC,qBAA1C;;AAEA,QAAIvC,QAAQwC,qBAAZ,EAAmC;AACjCjF,cAAQiF,qBAAR,GAAgCxC,QAAQwC,qBAAxC;AACD;;AAEDjF,YAAQkF,SAAR,CAAkBtD,KAAlB,EAAyBwB,KAAK+B,KAAL,CAAWjB,IAAX,CAAzB,EAA2Cd,KAAK+B,KAAL,CAAWhB,IAAX,CAA3C,EAA6Df,KAAK+B,KAAL,CAAWf,QAAX,CAA7D,EAAmFhB,KAAK+B,KAAL,CAAWd,SAAX,CAAnF;;AAEA,QAAIC,QAAJ,EAAc;AACZtE,cAAQvD,OAAR;AACD;;AAED,WAAOuH,MAAP;AACD;;AAED,WAASoB,qBAAT,CAA+BC,QAA/B,EAAyCC,KAAzC,EAAgDnF,MAAhD,EAAwD;AACtD,QAAIoF,MAAM,EAAV;AACA,QAAIC,IAAI,KAAK,CAAb;;AAEA,SAAKA,IAAIF,KAAJ,EAAWnF,UAAUmF,KAA1B,EAAiCE,IAAIrF,MAArC,EAA6CqF,GAA7C,EAAkD;AAChDD,aAAOtG,aAAaoG,SAASI,QAAT,CAAkBD,CAAlB,CAAb,CAAP;AACD;;AAED,WAAOD,GAAP;AACD;;AAED,WAASG,cAAT,CAAwBC,WAAxB,EAAqC;AACnC,QAAIN,WAAW,IAAIO,QAAJ,CAAaD,WAAb,CAAf;AACA,QAAIxF,SAASkF,SAASQ,UAAtB;AACA,QAAIC,cAAc,KAAK,CAAvB;AACA,QAAIC,aAAa,KAAK,CAAtB;AACA,QAAIC,aAAa,KAAK,CAAtB;AACA,QAAIC,iBAAiB,KAAK,CAA1B;AACA,QAAIC,eAAe,KAAK,CAAxB;AACA,QAAIC,aAAa,KAAK,CAAtB;AACA,QAAIC,YAAY,KAAK,CAArB;AACA,QAAIC,WAAW,KAAK,CAApB;AACA,QAAI5G,SAAS,KAAK,CAAlB;AACA,QAAI+F,IAAI,KAAK,CAAb;;AAEA;AACA,QAAIH,SAASI,QAAT,CAAkB,CAAlB,MAAyB,IAAzB,IAAiCJ,SAASI,QAAT,CAAkB,CAAlB,MAAyB,IAA9D,EAAoE;AAClEhG,eAAS,CAAT;;AAEA,aAAOA,SAASU,MAAhB,EAAwB;AACtB,YAAIkF,SAASI,QAAT,CAAkBhG,MAAlB,MAA8B,IAA9B,IAAsC4F,SAASI,QAAT,CAAkBhG,SAAS,CAA3B,MAAkC,IAA5E,EAAkF;AAChF2G,sBAAY3G,MAAZ;AACA;AACD;;AAEDA;AACD;AACF;;AAED,QAAI2G,SAAJ,EAAe;AACbL,mBAAaK,YAAY,CAAzB;AACAJ,mBAAaI,YAAY,EAAzB;;AAEA,UAAIhB,sBAAsBC,QAAtB,EAAgCU,UAAhC,EAA4C,CAA5C,MAAmD,MAAvD,EAA+D;AAC7DI,qBAAad,SAASiB,SAAT,CAAmBN,UAAnB,CAAb;AACAE,uBAAeC,eAAe,MAA9B;;AAEA,YAAID,gBAAgBC,eAAe,MAAnC,CAA0C,eAA1C,EAA2D;AACvD,gBAAId,SAASiB,SAAT,CAAmBN,aAAa,CAAhC,EAAmCE,YAAnC,MAAqD,MAAzD,EAAiE;AAC/DD,+BAAiBZ,SAASkB,SAAT,CAAmBP,aAAa,CAAhC,EAAmCE,YAAnC,CAAjB;;AAEA,kBAAID,kBAAkB,UAAtB,EAAkC;AAChCI,2BAAWL,aAAaC,cAAxB;AACD;AACF;AACF;AACJ;AACF;;AAED,QAAII,QAAJ,EAAc;AACZlG,eAASkF,SAASiB,SAAT,CAAmBD,QAAnB,EAA6BH,YAA7B,CAAT;;AAEA,WAAKV,IAAI,CAAT,EAAYA,IAAIrF,MAAhB,EAAwBqF,GAAxB,EAA6B;AAC3B/F,iBAAS4G,WAAWb,IAAI,EAAf,GAAoB,CAA7B;;AAEA,YAAIH,SAASiB,SAAT,CAAmB7G,MAAnB,EAA2ByG,YAA3B,MAA6C,MAAjD,CAAwD,iBAAxD,EAA2E;AACvE;AACAzG,sBAAU,CAAV;;AAEA;AACAqG,0BAAcT,SAASiB,SAAT,CAAmB7G,MAAnB,EAA2ByG,YAA3B,CAAd;;AAEA;AACA,gBAAIpH,sBAAJ,EAA4B;AAC1BuG,uBAASmB,SAAT,CAAmB/G,MAAnB,EAA2B,CAA3B,EAA8ByG,YAA9B;AACD;;AAED;AACD;AACJ;AACF;;AAED,WAAOJ,WAAP;AACD;;AAED,WAASW,oBAAT,CAA8BC,OAA9B,EAAuC;AACrC,QAAIC,SAASD,QAAQE,OAAR,CAAgBlI,oBAAhB,EAAsC,EAAtC,CAAb;AACA,QAAImI,SAASC,KAAKH,MAAL,CAAb;AACA,QAAIxG,SAAS0G,OAAO1G,MAApB;AACA,QAAIwF,cAAc,IAAIoB,WAAJ,CAAgB5G,MAAhB,CAAlB;AACA,QAAIkF,WAAW,IAAI2B,UAAJ,CAAerB,WAAf,CAAf;AACA,QAAIH,IAAI,KAAK,CAAb;;AAEA,SAAKA,IAAI,CAAT,EAAYA,IAAIrF,MAAhB,EAAwBqF,GAAxB,EAA6B;AAC3BH,eAASG,CAAT,IAAcqB,OAAOI,UAAP,CAAkBzB,CAAlB,CAAd;AACD;;AAED,WAAOG,WAAP;AACD;;AAED;AACA,WAASuB,oBAAT,CAA8BvB,WAA9B,EAA2C;AACzC,QAAIN,WAAW,IAAI2B,UAAJ,CAAerB,WAAf,CAAf;AACA,QAAIxF,SAASkF,SAASlF,MAAtB;AACA,QAAIwG,SAAS,EAAb;AACA,QAAInB,IAAI,KAAK,CAAb;;AAEA,SAAKA,IAAI,CAAT,EAAYA,IAAIrF,MAAhB,EAAwBqF,GAAxB,EAA6B;AAC3BmB,gBAAU1H,aAAaoG,SAASG,CAAT,CAAb,CAAV;AACD;;AAED,WAAO,4BAA4B2B,KAAKR,MAAL,CAAnC;AACD;;AAED,MAAIS,WAAW;AACbC,YAAQ,SAASA,MAAT,GAAkB;AACxB,UAAIC,OAAO,IAAX;;AAEAA,WAAKC,aAAL;AACAD,WAAKE,UAAL;AACAF,WAAKG,WAAL;;AAEAH,WAAKI,YAAL;;AAEA,UAAIJ,KAAKK,OAAT,EAAkB;AAChBL,aAAKM,aAAL;AACD;AACF,KAbY;AAcbL,mBAAe,SAASA,aAAT,GAAyB;AACtC,UAAID,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAIoF,QAAQP,KAAKQ,QAAjB;AACA,UAAIC,aAAaT,KAAKS,UAAtB;AACA,UAAIC,WAAWV,KAAKU,QAApB;AACA,UAAIC,SAAS,gBAAb;;AAEAD,eAASE,QAAT,CAAkBD,MAAlB;AACAJ,YAAMM,WAAN,CAAkBF,MAAlB;;AAEAD,eAASI,GAAT,CAAad,KAAKe,SAAL,GAAiB;AAC5BhG,eAAOe,KAAKkF,GAAL,CAASP,WAAW1F,KAAX,EAAT,EAA6BkG,OAAO9F,QAAQxE,iBAAf,KAAqC,GAAlE,CADqB;AAE5BqE,gBAAQc,KAAKkF,GAAL,CAASP,WAAWzF,MAAX,EAAT,EAA8BiG,OAAO9F,QAAQvE,kBAAf,KAAsC,GAApE;AAFoB,OAA9B;;AAKA2J,YAAMK,QAAN,CAAeD,MAAf;AACAD,eAASG,WAAT,CAAqBF,MAArB;AACD,KAhCY;;AAmCb;AACAT,gBAAY,SAASA,UAAT,GAAsB;AAChC,UAAIF,OAAO,IAAX;AACA,UAAIpL,WAAWoL,KAAK7E,OAAL,CAAavG,QAA5B;AACA,UAAImM,YAAYf,KAAKe,SAArB;AACA,UAAIG,iBAAiBH,UAAUhG,KAA/B;AACA,UAAIoG,kBAAkBJ,UAAU/F,MAAhC;AACA,UAAIV,QAAQ0F,KAAK1F,KAAjB;AACA,UAAI8G,oBAAoB9G,MAAME,YAA9B;AACA,UAAI6G,qBAAqB/G,MAAMG,aAA/B;AACA,UAAI6G,aAAaxF,KAAKC,GAAL,CAASzB,MAAMiB,MAAf,IAAyB,GAAzB,KAAiC,EAAlD;AACA,UAAIf,eAAe8G,aAAaD,kBAAb,GAAkCD,iBAArD;AACA,UAAI3G,gBAAgB6G,aAAaF,iBAAb,GAAiCC,kBAArD;AACA,UAAIvM,cAAc0F,eAAeC,aAAjC;AACA,UAAIwC,cAAciE,cAAlB;AACA,UAAIhE,eAAeiE,eAAnB;;AAEA,UAAIA,kBAAkBrM,WAAlB,GAAgCoM,cAApC,EAAoD;AAClD,YAAItM,aAAa,CAAjB,EAAoB;AAClBqI,wBAAckE,kBAAkBrM,WAAhC;AACD,SAFD,MAEO;AACLoI,yBAAegE,iBAAiBpM,WAAhC;AACD;AACF,OAND,MAMO,IAAIF,aAAa,CAAjB,EAAoB;AACzBsI,uBAAegE,iBAAiBpM,WAAhC;AACD,OAFM,MAEA;AACLmI,sBAAckE,kBAAkBrM,WAAhC;AACD;;AAED,UAAI4H,SAAS;AACXlC,sBAAcA,YADH;AAEXC,uBAAeA,aAFJ;AAGX3F,qBAAaA,WAHF;AAIXiG,eAAOkC,WAJI;AAKXjC,gBAAQkC;AALG,OAAb;;AAQAR,aAAO6E,OAAP,GAAiB7E,OAAO8E,IAAP,GAAc,CAACN,iBAAiBjE,WAAlB,IAAiC,CAAhE;AACAP,aAAO+E,MAAP,GAAgB/E,OAAOgF,GAAP,GAAa,CAACP,kBAAkBjE,YAAnB,IAAmC,CAAhE;;AAEA8C,WAAKtD,MAAL,GAAcA,MAAd;AACAsD,WAAK2B,OAAL,GAAe/M,aAAa,CAAb,IAAkBA,aAAa,CAA9C;AACAoL,WAAK4B,WAAL,CAAiB,IAAjB,EAAuB,IAAvB;AACA5B,WAAK6B,YAAL,GAAoBnN,EAAEoN,MAAF,CAAS,EAAT,EAAaxH,KAAb,CAApB;AACA0F,WAAK+B,aAAL,GAAqBrN,EAAEoN,MAAF,CAAS,EAAT,EAAapF,MAAb,CAArB;AACD,KAhFY;AAiFbkF,iBAAa,SAASA,WAAT,CAAqBI,aAArB,EAAoCC,iBAApC,EAAuD;AAClE,UAAIjC,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAIvG,WAAWuG,QAAQvG,QAAvB;AACA,UAAImM,YAAYf,KAAKe,SAArB;AACA,UAAIG,iBAAiBH,UAAUhG,KAA/B;AACA,UAAIoG,kBAAkBJ,UAAU/F,MAAhC;AACA,UAAI0B,SAASsD,KAAKtD,MAAlB;AACA,UAAI5H,cAAc4H,OAAO5H,WAAzB;AACA,UAAIoN,UAAUlC,KAAKkC,OAAnB;AACA,UAAI7B,UAAUL,KAAKK,OAAL,IAAgB6B,OAA9B;;AAEA,UAAIF,aAAJ,EAAmB;AACjB,YAAIzL,iBAAiB0K,OAAO9F,QAAQ5E,cAAf,KAAkC,CAAvD;AACA,YAAIC,kBAAkByK,OAAO9F,QAAQ3E,eAAf,KAAmC,CAAzD;;AAEA,YAAI5B,QAAJ,EAAc;AACZ,cAAIA,WAAW,CAAf,EAAkB;AAChB2B,6BAAiBuF,KAAKkF,GAAL,CAASzK,cAAT,EAAyB2K,cAAzB,CAAjB;AACA1K,8BAAkBsF,KAAKkF,GAAL,CAASxK,eAAT,EAA0B2K,eAA1B,CAAlB;;AAEA,gBAAIvM,aAAa,CAAjB,EAAoB;AAClB,kBAAI4B,kBAAkB1B,WAAlB,GAAgCyB,cAApC,EAAoD;AAClDA,iCAAiBC,kBAAkB1B,WAAnC;AACD,eAFD,MAEO;AACL0B,kCAAkBD,iBAAiBzB,WAAnC;AACD;AACF;AACF,WAXD,MAWO,IAAIyB,cAAJ,EAAoB;AACzBA,6BAAiBuF,KAAKkF,GAAL,CAASzK,cAAT,EAAyB8J,UAAU6B,QAAQnH,KAAlB,GAA0B,CAAnD,CAAjB;AACD,WAFM,MAEA,IAAIvE,eAAJ,EAAqB;AAC1BA,8BAAkBsF,KAAKkF,GAAL,CAASxK,eAAT,EAA0B6J,UAAU6B,QAAQlH,MAAlB,GAA2B,CAArD,CAAlB;AACD,WAFM,MAEA,IAAIqF,OAAJ,EAAa;AAClB9J,6BAAiB2L,QAAQnH,KAAzB;AACAvE,8BAAkB0L,QAAQlH,MAA1B;;AAEA,gBAAIxE,kBAAkB1B,WAAlB,GAAgCyB,cAApC,EAAoD;AAClDA,+BAAiBC,kBAAkB1B,WAAnC;AACD,aAFD,MAEO;AACL0B,gCAAkBD,iBAAiBzB,WAAnC;AACD;AACF;AACF;;AAED,YAAIyB,kBAAkBC,eAAtB,EAAuC;AACrC,cAAIA,kBAAkB1B,WAAlB,GAAgCyB,cAApC,EAAoD;AAClDC,8BAAkBD,iBAAiBzB,WAAnC;AACD,WAFD,MAEO;AACLyB,6BAAiBC,kBAAkB1B,WAAnC;AACD;AACF,SAND,MAMO,IAAIyB,cAAJ,EAAoB;AACzBC,4BAAkBD,iBAAiBzB,WAAnC;AACD,SAFM,MAEA,IAAI0B,eAAJ,EAAqB;AAC1BD,2BAAiBC,kBAAkB1B,WAAnC;AACD;;AAED4H,eAAOyF,QAAP,GAAkB5L,cAAlB;AACAmG,eAAO0F,SAAP,GAAmB5L,eAAnB;AACAkG,eAAO2F,QAAP,GAAkBC,QAAlB;AACA5F,eAAO6F,SAAP,GAAmBD,QAAnB;AACD;;AAED,UAAIL,iBAAJ,EAAuB;AACrB,YAAIrN,QAAJ,EAAc;AACZ,cAAI4N,gBAAgBtB,iBAAiBxE,OAAO3B,KAA5C;AACA,cAAI0H,eAAetB,kBAAkBzE,OAAO1B,MAA5C;;AAEA0B,iBAAOgG,OAAP,GAAiB5G,KAAK6G,GAAL,CAAS,CAAT,EAAYH,aAAZ,CAAjB;AACA9F,iBAAOkG,MAAP,GAAgB9G,KAAK6G,GAAL,CAAS,CAAT,EAAYF,YAAZ,CAAhB;AACA/F,iBAAOmG,OAAP,GAAiB/G,KAAKkF,GAAL,CAAS,CAAT,EAAYwB,aAAZ,CAAjB;AACA9F,iBAAOoG,MAAP,GAAgBhH,KAAKkF,GAAL,CAAS,CAAT,EAAYyB,YAAZ,CAAhB;;AAEA,cAAIpC,WAAWL,KAAK2B,OAApB,EAA6B;AAC3BjF,mBAAOgG,OAAP,GAAiB5G,KAAK6G,GAAL,CAAST,QAAQV,IAAjB,EAAuBU,QAAQV,IAAR,GAAeU,QAAQnH,KAAvB,GAA+B2B,OAAO3B,KAA7D,CAAjB;AACA2B,mBAAOkG,MAAP,GAAgB9G,KAAK6G,GAAL,CAAST,QAAQR,GAAjB,EAAsBQ,QAAQR,GAAR,GAAcQ,QAAQlH,MAAtB,GAA+B0B,OAAO1B,MAA5D,CAAhB;AACA0B,mBAAOmG,OAAP,GAAiBX,QAAQV,IAAzB;AACA9E,mBAAOoG,MAAP,GAAgBZ,QAAQR,GAAxB;;AAEA,gBAAI9M,aAAa,CAAjB,EAAoB;AAClB,kBAAI8H,OAAO3B,KAAP,IAAgBmG,cAApB,EAAoC;AAClCxE,uBAAOgG,OAAP,GAAiB5G,KAAK6G,GAAL,CAAS,CAAT,EAAYH,aAAZ,CAAjB;AACA9F,uBAAOmG,OAAP,GAAiB/G,KAAKkF,GAAL,CAAS,CAAT,EAAYwB,aAAZ,CAAjB;AACD;;AAED,kBAAI9F,OAAO1B,MAAP,IAAiBmG,eAArB,EAAsC;AACpCzE,uBAAOkG,MAAP,GAAgB9G,KAAK6G,GAAL,CAAS,CAAT,EAAYF,YAAZ,CAAhB;AACA/F,uBAAOoG,MAAP,GAAgBhH,KAAKkF,GAAL,CAAS,CAAT,EAAYyB,YAAZ,CAAhB;AACD;AACF;AACF;AACF,SA3BD,MA2BO;AACL/F,iBAAOgG,OAAP,GAAiB,CAAChG,OAAO3B,KAAzB;AACA2B,iBAAOkG,MAAP,GAAgB,CAAClG,OAAO1B,MAAxB;AACA0B,iBAAOmG,OAAP,GAAiB3B,cAAjB;AACAxE,iBAAOoG,MAAP,GAAgB3B,eAAhB;AACD;AACF;AACF,KAlLY;AAmLbf,kBAAc,SAASA,YAAT,CAAsB2C,SAAtB,EAAiC;AAC7C,UAAI/C,OAAO,IAAX;AACA,UAAItD,SAASsD,KAAKtD,MAAlB;AACA,UAAIpC,QAAQ0F,KAAK1F,KAAjB;AACA,UAAIiB,SAASjB,MAAMiB,MAAnB;AACA,UAAIf,eAAeF,MAAME,YAAzB;AACA,UAAIC,gBAAgBH,MAAMG,aAA1B;;AAEA,UAAIuF,KAAK7C,OAAT,EAAkB;AAChB6C,aAAK7C,OAAL,GAAe,KAAf;;AAEA;AACA,YAAIA,UAAUxB,gBAAgB;AAC5BZ,iBAAOT,MAAMS,KADe;AAE5BC,kBAAQV,MAAMU,MAFc;AAG5BgB,kBAAQT;AAHoB,SAAhB,CAAd;AAKA,YAAIzG,cAAcqI,QAAQpC,KAAR,GAAgBoC,QAAQnC,MAA1C;AACA,YAAIgI,gBAAgB1I,MAAMxF,WAAN,KAAsB,CAA1C;;AAEA,YAAIkO,iBAAiBlO,gBAAgB4H,OAAO5H,WAA5C,EAAyD;AACvD4H,iBAAO8E,IAAP,IAAe,CAACrE,QAAQpC,KAAR,GAAgB2B,OAAO3B,KAAxB,IAAiC,CAAhD;AACA2B,iBAAOgF,GAAP,IAAc,CAACvE,QAAQnC,MAAR,GAAiB0B,OAAO1B,MAAzB,IAAmC,CAAjD;AACA0B,iBAAO3B,KAAP,GAAeoC,QAAQpC,KAAvB;AACA2B,iBAAO1B,MAAP,GAAgBmC,QAAQnC,MAAxB;AACA0B,iBAAO5H,WAAP,GAAqBA,WAArB;AACA4H,iBAAOlC,YAAP,GAAsBA,YAAtB;AACAkC,iBAAOjC,aAAP,GAAuBA,aAAvB;;AAEA;AACA,cAAIuI,iBAAiBzH,SAAS,EAA1B,IAAgCA,SAAS,GAA7C,EAAkD;AAChD,gBAAI0H,WAAWtH,gBAAgB;AAC7BZ,qBAAOP,YADsB;AAE7BQ,sBAAQP,aAFqB;AAG7BuB,sBAAQT;AAHqB,aAAhB,CAAf;;AAMAmB,mBAAOlC,YAAP,GAAsByI,SAASlI,KAA/B;AACA2B,mBAAOjC,aAAP,GAAuBwI,SAASjI,MAAhC;AACD;;AAEDgF,eAAK4B,WAAL,CAAiB,IAAjB,EAAuB,KAAvB;AACD;AACF;;AAED,UAAIlF,OAAO3B,KAAP,GAAe2B,OAAO2F,QAAtB,IAAkC3F,OAAO3B,KAAP,GAAe2B,OAAOyF,QAA5D,EAAsE;AACpEzF,eAAO8E,IAAP,GAAc9E,OAAO6E,OAArB;AACD;;AAED,UAAI7E,OAAO1B,MAAP,GAAgB0B,OAAO6F,SAAvB,IAAoC7F,OAAO1B,MAAP,GAAgB0B,OAAO0F,SAA/D,EAA0E;AACxE1F,eAAOgF,GAAP,GAAahF,OAAO+E,MAApB;AACD;;AAED/E,aAAO3B,KAAP,GAAee,KAAK6G,GAAL,CAAS7G,KAAKkF,GAAL,CAAStE,OAAO3B,KAAhB,EAAuB2B,OAAOyF,QAA9B,CAAT,EAAkDzF,OAAO2F,QAAzD,CAAf;AACA3F,aAAO1B,MAAP,GAAgBc,KAAK6G,GAAL,CAAS7G,KAAKkF,GAAL,CAAStE,OAAO1B,MAAhB,EAAwB0B,OAAO0F,SAA/B,CAAT,EAAoD1F,OAAO6F,SAA3D,CAAhB;;AAEAvC,WAAK4B,WAAL,CAAiB,KAAjB,EAAwB,IAAxB;;AAEAlF,aAAO6E,OAAP,GAAiB7E,OAAO8E,IAAP,GAAc1F,KAAK6G,GAAL,CAAS7G,KAAKkF,GAAL,CAAStE,OAAO8E,IAAhB,EAAsB9E,OAAOgG,OAA7B,CAAT,EAAgDhG,OAAOmG,OAAvD,CAA/B;AACAnG,aAAO+E,MAAP,GAAgB/E,OAAOgF,GAAP,GAAa5F,KAAK6G,GAAL,CAAS7G,KAAKkF,GAAL,CAAStE,OAAOgF,GAAhB,EAAqBhF,OAAOkG,MAA5B,CAAT,EAA8ClG,OAAOoG,MAArD,CAA7B;;AAEA9C,WAAKkD,OAAL,CAAapC,GAAb,CAAiB;AACf/F,eAAO2B,OAAO3B,KADC;AAEfC,gBAAQ0B,OAAO1B,MAFA;AAGfmI,mBAAWjI,aAAa;AACtBG,sBAAYqB,OAAO8E,IADG;AAEtBlG,sBAAYoB,OAAOgF;AAFG,SAAb;AAHI,OAAjB;;AASA1B,WAAKoD,WAAL;;AAEA,UAAIpD,KAAKK,OAAL,IAAgBL,KAAK2B,OAAzB,EAAkC;AAChC3B,aAAKqD,YAAL,CAAkB,IAAlB,EAAwB,IAAxB;AACD;;AAED,UAAIN,SAAJ,EAAe;AACb/C,aAAKsD,MAAL;AACD;AACF,KAlQY;AAmQbF,iBAAa,SAASA,WAAT,CAAqBL,SAArB,EAAgC;AAC3C,UAAI/C,OAAO,IAAX;AACA,UAAItD,SAASsD,KAAKtD,MAAlB;AACA,UAAIpC,QAAQ0F,KAAK1F,KAAjB;AACA,UAAIiJ,WAAW,KAAK,CAApB;;AAEA,UAAIjJ,MAAMiB,MAAV,EAAkB;AAChBgI,mBAAW5H,gBAAgB;AACzBZ,iBAAO2B,OAAO3B,KADW;AAEzBC,kBAAQ0B,OAAO1B,MAFU;AAGzBgB,kBAAQ1B,MAAMiB,MAHW;AAIzBzG,uBAAawF,MAAMxF;AAJM,SAAhB,EAKR,IALQ,CAAX;AAMD;;AAEDJ,QAAEoN,MAAF,CAASxH,KAAT,EAAgBiJ,WAAW;AACzBxI,eAAOwI,SAASxI,KADS;AAEzBC,gBAAQuI,SAASvI,MAFQ;AAGzBwG,cAAM,CAAC9E,OAAO3B,KAAP,GAAewI,SAASxI,KAAzB,IAAkC,CAHf;AAIzB2G,aAAK,CAAChF,OAAO1B,MAAP,GAAgBuI,SAASvI,MAA1B,IAAoC;AAJhB,OAAX,GAKZ;AACFD,eAAO2B,OAAO3B,KADZ;AAEFC,gBAAQ0B,OAAO1B,MAFb;AAGFwG,cAAM,CAHJ;AAIFE,aAAK;AAJH,OALJ;;AAYA1B,WAAKwD,MAAL,CAAY1C,GAAZ,CAAgB;AACd/F,eAAOT,MAAMS,KADC;AAEdC,gBAAQV,MAAMU,MAFA;AAGdmI,mBAAWjI,aAAaxG,EAAEoN,MAAF,CAAS;AAC/BzG,sBAAYf,MAAMkH,IADa;AAE/BlG,sBAAYhB,MAAMoH;AAFa,SAAT,EAGrBpH,KAHqB,CAAb;AAHG,OAAhB;;AASA,UAAIyI,SAAJ,EAAe;AACb/C,aAAKsD,MAAL;AACD;AACF,KA1SY;AA2SbnD,iBAAa,SAASA,WAAT,GAAuB;AAClC,UAAIH,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAIuB,SAASsD,KAAKtD,MAAlB;AACA,UAAI5H,cAAcqG,QAAQrG,WAA1B;AACA,UAAIc,eAAeqL,OAAO9F,QAAQvF,YAAf,KAAgC,GAAnD;AACA,UAAIsM,UAAU;AACZnH,eAAO2B,OAAO3B,KADF;AAEZC,gBAAQ0B,OAAO1B;AAFH,OAAd;;AAKA,UAAIlG,WAAJ,EAAiB;AACf,YAAI4H,OAAO1B,MAAP,GAAgBlG,WAAhB,GAA8B4H,OAAO3B,KAAzC,EAAgD;AAC9CmH,kBAAQlH,MAAR,GAAiBkH,QAAQnH,KAAR,GAAgBjG,WAAjC;AACD,SAFD,MAEO;AACLoN,kBAAQnH,KAAR,GAAgBmH,QAAQlH,MAAR,GAAiBlG,WAAjC;AACD;AACF;;AAEDkL,WAAKkC,OAAL,GAAeA,OAAf;AACAlC,WAAKqD,YAAL,CAAkB,IAAlB,EAAwB,IAAxB;;AAEA;AACAnB,cAAQnH,KAAR,GAAgBe,KAAK6G,GAAL,CAAS7G,KAAKkF,GAAL,CAASkB,QAAQnH,KAAjB,EAAwBmH,QAAQC,QAAhC,CAAT,EAAoDD,QAAQG,QAA5D,CAAhB;AACAH,cAAQlH,MAAR,GAAiBc,KAAK6G,GAAL,CAAS7G,KAAKkF,GAAL,CAASkB,QAAQlH,MAAjB,EAAyBkH,QAAQE,SAAjC,CAAT,EAAsDF,QAAQK,SAA9D,CAAjB;;AAEA;AACAL,cAAQnH,KAAR,GAAgBe,KAAKkF,GAAL,CAASkB,QAAQC,QAAjB,EAA2BD,QAAQnH,KAAR,GAAgBnF,YAA3C,CAAhB;AACAsM,cAAQlH,MAAR,GAAiBc,KAAKkF,GAAL,CAASkB,QAAQE,SAAjB,EAA4BF,QAAQlH,MAAR,GAAiBpF,YAA7C,CAAjB;AACAsM,cAAQX,OAAR,GAAkBW,QAAQV,IAAR,GAAe9E,OAAO8E,IAAP,GAAc,CAAC9E,OAAO3B,KAAP,GAAemH,QAAQnH,KAAxB,IAAiC,CAAhF;AACAmH,cAAQT,MAAR,GAAiBS,QAAQR,GAAR,GAAchF,OAAOgF,GAAP,GAAa,CAAChF,OAAO1B,MAAP,GAAgBkH,QAAQlH,MAAzB,IAAmC,CAA/E;;AAEAgF,WAAKyD,cAAL,GAAsB/O,EAAEoN,MAAF,CAAS,EAAT,EAAaI,OAAb,CAAtB;AACD,KA5UY;AA6UbmB,kBAAc,SAASA,YAAT,CAAsBrB,aAAtB,EAAqCC,iBAArC,EAAwD;AACpE,UAAIjC,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAIrG,cAAcqG,QAAQrG,WAA1B;AACA,UAAIiM,YAAYf,KAAKe,SAArB;AACA,UAAIG,iBAAiBH,UAAUhG,KAA/B;AACA,UAAIoG,kBAAkBJ,UAAU/F,MAAhC;AACA,UAAI0B,SAASsD,KAAKtD,MAAlB;AACA,UAAIwF,UAAUlC,KAAKkC,OAAnB;AACA,UAAIP,UAAU3B,KAAK2B,OAAnB;;AAEA,UAAIK,aAAJ,EAAmB;AACjB,YAAIvL,kBAAkBwK,OAAO9F,QAAQ1E,eAAf,KAAmC,CAAzD;AACA,YAAIC,mBAAmBuK,OAAO9F,QAAQzE,gBAAf,KAAoC,CAA3D;AACA,YAAIgN,kBAAkB5H,KAAK6G,GAAL,CAASzB,cAAT,EAAyBS,UAAUjF,OAAO3B,KAAjB,GAAyBmG,cAAlD,CAAtB;AACA,YAAIyC,mBAAmB7H,KAAK6G,GAAL,CAASxB,eAAT,EAA0BQ,UAAUjF,OAAO1B,MAAjB,GAA0BmG,eAApD,CAAvB;;AAEA;AACA1K,0BAAkBqF,KAAK6G,GAAL,CAASlM,eAAT,EAA0ByK,cAA1B,CAAlB;AACAxK,2BAAmBoF,KAAK6G,GAAL,CAASjM,gBAAT,EAA2ByK,eAA3B,CAAnB;;AAEA,YAAIrM,WAAJ,EAAiB;AACf,cAAI2B,mBAAmBC,gBAAvB,EAAyC;AACvC,gBAAIA,mBAAmB5B,WAAnB,GAAiC2B,eAArC,EAAsD;AACpDC,iCAAmBD,kBAAkB3B,WAArC;AACD,aAFD,MAEO;AACL2B,gCAAkBC,mBAAmB5B,WAArC;AACD;AACF,WAND,MAMO,IAAI2B,eAAJ,EAAqB;AAC1BC,+BAAmBD,kBAAkB3B,WAArC;AACD,WAFM,MAEA,IAAI4B,gBAAJ,EAAsB;AAC3BD,8BAAkBC,mBAAmB5B,WAArC;AACD;;AAED,cAAI6O,mBAAmB7O,WAAnB,GAAiC4O,eAArC,EAAsD;AACpDC,+BAAmBD,kBAAkB5O,WAArC;AACD,WAFD,MAEO;AACL4O,8BAAkBC,mBAAmB7O,WAArC;AACD;AACF;;AAED;AACAoN,gBAAQC,QAAR,GAAmBrG,KAAK6G,GAAL,CAASlM,eAAT,EAA0BiN,eAA1B,CAAnB;AACAxB,gBAAQE,SAAR,GAAoBtG,KAAK6G,GAAL,CAASjM,gBAAT,EAA2BiN,gBAA3B,CAApB;AACAzB,gBAAQG,QAAR,GAAmBqB,eAAnB;AACAxB,gBAAQK,SAAR,GAAoBoB,gBAApB;AACD;;AAED,UAAI1B,iBAAJ,EAAuB;AACrB,YAAIN,OAAJ,EAAa;AACXO,kBAAQQ,OAAR,GAAkB5G,KAAKkF,GAAL,CAAS,CAAT,EAAYtE,OAAO8E,IAAnB,CAAlB;AACAU,kBAAQU,MAAR,GAAiB9G,KAAKkF,GAAL,CAAS,CAAT,EAAYtE,OAAOgF,GAAnB,CAAjB;AACAQ,kBAAQW,OAAR,GAAkB/G,KAAK6G,GAAL,CAASzB,cAAT,EAAyBxE,OAAO8E,IAAP,GAAc9E,OAAO3B,KAA9C,IAAuDmH,QAAQnH,KAAjF;AACAmH,kBAAQY,MAAR,GAAiBhH,KAAK6G,GAAL,CAASxB,eAAT,EAA0BzE,OAAOgF,GAAP,GAAahF,OAAO1B,MAA9C,IAAwDkH,QAAQlH,MAAjF;AACD,SALD,MAKO;AACLkH,kBAAQQ,OAAR,GAAkB,CAAlB;AACAR,kBAAQU,MAAR,GAAiB,CAAjB;AACAV,kBAAQW,OAAR,GAAkB3B,iBAAiBgB,QAAQnH,KAA3C;AACAmH,kBAAQY,MAAR,GAAiB3B,kBAAkBe,QAAQlH,MAA3C;AACD;AACF;AACF,KA1YY;AA2YbsF,mBAAe,SAASA,aAAT,GAAyB;AACtC,UAAIN,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAI4F,YAAYf,KAAKe,SAArB;AACA,UAAIG,iBAAiBH,UAAUhG,KAA/B;AACA,UAAIoG,kBAAkBJ,UAAU/F,MAAhC;AACA,UAAIkH,UAAUlC,KAAKkC,OAAnB;;AAEA,UAAIA,QAAQnH,KAAR,GAAgBmH,QAAQG,QAAxB,IAAoCH,QAAQnH,KAAR,GAAgBmH,QAAQC,QAAhE,EAA0E;AACxED,gBAAQV,IAAR,GAAeU,QAAQX,OAAvB;AACD;;AAED,UAAIW,QAAQlH,MAAR,GAAiBkH,QAAQK,SAAzB,IAAsCL,QAAQlH,MAAR,GAAiBkH,QAAQE,SAAnE,EAA8E;AAC5EF,gBAAQR,GAAR,GAAcQ,QAAQT,MAAtB;AACD;;AAEDS,cAAQnH,KAAR,GAAgBe,KAAK6G,GAAL,CAAS7G,KAAKkF,GAAL,CAASkB,QAAQnH,KAAjB,EAAwBmH,QAAQC,QAAhC,CAAT,EAAoDD,QAAQG,QAA5D,CAAhB;AACAH,cAAQlH,MAAR,GAAiBc,KAAK6G,GAAL,CAAS7G,KAAKkF,GAAL,CAASkB,QAAQlH,MAAjB,EAAyBkH,QAAQE,SAAjC,CAAT,EAAsDF,QAAQK,SAA9D,CAAjB;;AAEAvC,WAAKqD,YAAL,CAAkB,KAAlB,EAAyB,IAAzB;;AAEAnB,cAAQX,OAAR,GAAkBW,QAAQV,IAAR,GAAe1F,KAAK6G,GAAL,CAAS7G,KAAKkF,GAAL,CAASkB,QAAQV,IAAjB,EAAuBU,QAAQQ,OAA/B,CAAT,EAAkDR,QAAQW,OAA1D,CAAjC;AACAX,cAAQT,MAAR,GAAiBS,QAAQR,GAAR,GAAc5F,KAAK6G,GAAL,CAAS7G,KAAKkF,GAAL,CAASkB,QAAQR,GAAjB,EAAsBQ,QAAQU,MAA9B,CAAT,EAAgDV,QAAQY,MAAxD,CAA/B;;AAEA,UAAI3H,QAAQtF,OAAR,IAAmBsF,QAAQ/E,cAA/B,EAA+C;AAC7C;AACA4J,aAAK4D,KAAL,CAAW5O,IAAX,CAAgB,QAAhB,EAA0BkN,QAAQnH,KAAR,KAAkBmG,cAAlB,IAAoCgB,QAAQlH,MAAR,KAAmBmG,eAAvD,GAAyE,MAAzE,GAAkF,KAA5G;AACD;;AAEDnB,WAAK6D,QAAL,CAAc/C,GAAd,CAAkB;AAChB/F,eAAOmH,QAAQnH,KADC;AAEhBC,gBAAQkH,QAAQlH,MAFA;AAGhBmI,mBAAWjI,aAAa;AACtBG,sBAAY6G,QAAQV,IADE;AAEtBlG,sBAAY4G,QAAQR;AAFE,SAAb;AAHK,OAAlB;;AASA,UAAI1B,KAAKK,OAAL,IAAgBL,KAAK2B,OAAzB,EAAkC;AAChC3B,aAAK4B,WAAL,CAAiB,IAAjB,EAAuB,IAAvB;AACD;;AAED,UAAI,CAAC5B,KAAK8D,QAAV,EAAoB;AAClB9D,aAAKsD,MAAL;AACD;AACF,KAxbY;AAybbA,YAAQ,SAASA,MAAT,GAAkB;AACxB,UAAItD,OAAO,IAAX;;AAEAA,WAAK/K,OAAL;;AAEA,UAAI+K,KAAK+D,SAAT,EAAoB;AAClB/D,aAAKgE,OAAL,CAAa,MAAb,EAAqBhE,KAAKiE,OAAL,EAArB;AACD;AACF;AAjcY,GAAf;;AAocA,MAAIC,eAAe,SAAnB;;AAEA,MAAIC,YAAY;AACdC,iBAAa,SAASA,WAAT,GAAuB;AAClC,UAAIpE,OAAO,IAAX;AACA,UAAIqE,cAAcrE,KAAKqE,WAAvB;AACA,UAAI5K,MAAM4K,cAAcrE,KAAKsE,cAAnB,GAAoCtE,KAAKvG,GAAnD;AACA,UAAIa,QAAQK,SAASC,aAAT,CAAuB,KAAvB,CAAZ;;AAEA,UAAIyJ,WAAJ,EAAiB;AACf/J,cAAM+J,WAAN,GAAoBA,WAApB;AACD;;AAED/J,YAAMW,GAAN,GAAYxB,GAAZ;;AAEA,UAAI8K,UAAU7P,EAAE4F,KAAF,CAAd;;AAEA0F,WAAKwE,QAAL,GAAgB9P,EAAEsL,KAAK7E,OAAL,CAAalG,OAAf,CAAhB;AACA+K,WAAKuE,OAAL,GAAeA,OAAf;AACAvE,WAAKyE,QAAL,CAAcC,IAAd,CAAmBH,OAAnB;AACAvE,WAAKwE,QAAL,CAAclL,IAAd,CAAmB,UAAU4E,CAAV,EAAayG,OAAb,EAAsB;AACvC,YAAIpE,QAAQ7L,EAAEiQ,OAAF,CAAZ;AACA,YAAIC,MAAMjK,SAASC,aAAT,CAAuB,KAAvB,CAAV;;AAEA;AACA2F,cAAMvL,IAAN,CAAWkP,YAAX,EAAyB;AACvBnJ,iBAAOwF,MAAMxF,KAAN,EADgB;AAEvBC,kBAAQuF,MAAMvF,MAAN,EAFe;AAGvB0J,gBAAMnE,MAAMmE,IAAN;AAHiB,SAAzB;;AAMA,YAAIL,WAAJ,EAAiB;AACfO,cAAIP,WAAJ,GAAkBA,WAAlB;AACD;;AAEDO,YAAI3J,GAAJ,GAAUxB,GAAV;;AAEA;;;;;;AAMAmL,YAAIC,KAAJ,CAAUC,OAAV,GAAoB,mBAAmB,aAAnB,GAAmC,cAAnC,GAAoD,wBAApD,GAA+E,yBAA/E,GAA2G,2BAA3G,GAAyI,4BAAzI,GAAwK,oCAA5L;;AAEAvE,cAAMmE,IAAN,CAAWE,GAAX;AACD,OA1BD;AA2BD,KA7Ca;AA8CdG,kBAAc,SAASA,YAAT,GAAwB;AACpC,WAAKP,QAAL,CAAclL,IAAd,CAAmB,UAAU4E,CAAV,EAAayG,OAAb,EAAsB;AACvC,YAAIpE,QAAQ7L,EAAEiQ,OAAF,CAAZ;AACA,YAAI3P,OAAOuL,MAAMvL,IAAN,CAAWkP,YAAX,CAAX;;AAEA3D,cAAMO,GAAN,CAAU;AACR/F,iBAAO/F,KAAK+F,KADJ;AAERC,kBAAQhG,KAAKgG;AAFL,SAAV,EAGG0J,IAHH,CAGQ1P,KAAK0P,IAHb,EAGmBM,UAHnB,CAG8Bd,YAH9B;AAID,OARD;AASD,KAxDa;AAyDdjP,aAAS,SAASA,OAAT,GAAmB;AAC1B,UAAI+K,OAAO,IAAX;AACA,UAAI1F,QAAQ0F,KAAK1F,KAAjB;AACA,UAAIoC,SAASsD,KAAKtD,MAAlB;AACA,UAAIwF,UAAUlC,KAAKkC,OAAnB;AACA,UAAI+C,eAAe/C,QAAQnH,KAA3B;AACA,UAAImK,gBAAgBhD,QAAQlH,MAA5B;AACA,UAAID,QAAQT,MAAMS,KAAlB;AACA,UAAIC,SAASV,MAAMU,MAAnB;AACA,UAAIwG,OAAOU,QAAQV,IAAR,GAAe9E,OAAO8E,IAAtB,GAA6BlH,MAAMkH,IAA9C;AACA,UAAIE,MAAMQ,QAAQR,GAAR,GAAchF,OAAOgF,GAArB,GAA2BpH,MAAMoH,GAA3C;;AAEA,UAAI,CAAC1B,KAAKK,OAAN,IAAiBL,KAAK8D,QAA1B,EAAoC;AAClC;AACD;;AAED9D,WAAKuE,OAAL,CAAazD,GAAb,CAAiB;AACf/F,eAAOA,KADQ;AAEfC,gBAAQA,MAFO;AAGfmI,mBAAWjI,aAAaxG,EAAEoN,MAAF,CAAS;AAC/BzG,sBAAY,CAACmG,IADkB;AAE/BlG,sBAAY,CAACoG;AAFkB,SAAT,EAGrBpH,KAHqB,CAAb;AAHI,OAAjB;;AASA0F,WAAKwE,QAAL,CAAclL,IAAd,CAAmB,UAAU4E,CAAV,EAAayG,OAAb,EAAsB;AACvC,YAAIpE,QAAQ7L,EAAEiQ,OAAF,CAAZ;AACA,YAAI3P,OAAOuL,MAAMvL,IAAN,CAAWkP,YAAX,CAAX;AACA,YAAIiB,gBAAgBnQ,KAAK+F,KAAzB;AACA,YAAIqK,iBAAiBpQ,KAAKgG,MAA1B;AACA,YAAIuB,WAAW4I,aAAf;AACA,YAAI3I,YAAY4I,cAAhB;AACA,YAAIC,QAAQ,CAAZ;;AAEA,YAAIJ,YAAJ,EAAkB;AAChBI,kBAAQF,gBAAgBF,YAAxB;AACAzI,sBAAY0I,gBAAgBG,KAA5B;AACD;;AAED,YAAIH,iBAAiB1I,YAAY4I,cAAjC,EAAiD;AAC/CC,kBAAQD,iBAAiBF,aAAzB;AACA3I,qBAAW0I,eAAeI,KAA1B;AACA7I,sBAAY4I,cAAZ;AACD;;AAED7E,cAAMO,GAAN,CAAU;AACR/F,iBAAOwB,QADC;AAERvB,kBAAQwB;AAFA,SAAV,EAGG8I,IAHH,CAGQ,KAHR,EAGexE,GAHf,CAGmB;AACjB/F,iBAAOA,QAAQsK,KADE;AAEjBrK,kBAAQA,SAASqK,KAFA;AAGjBlC,qBAAWjI,aAAaxG,EAAEoN,MAAF,CAAS;AAC/BzG,wBAAY,CAACmG,IAAD,GAAQ6D,KADW;AAE/B/J,wBAAY,CAACoG,GAAD,GAAO2D;AAFY,WAAT,EAGrB/K,KAHqB,CAAb;AAHM,SAHnB;AAWD,OA/BD;AAgCD;AAlHa,GAAhB;;AAqHA;AACA,MAAIiL,eAAe,OAAOhO,MAAP,KAAkB,WAAlB,GAAgCA,OAAOgO,YAAvC,GAAsD,IAAzE;;AAEA;AACA,MAAIC,qBAAqBD,eAAe,aAAf,GAA+B,sBAAxD;AACA,MAAIE,qBAAqBF,eAAe,aAAf,GAA+B,qBAAxD;AACA,MAAIG,mBAAmBH,eAAe,0BAAf,GAA4C,8BAAnE;AACA,MAAII,cAAc,iCAAlB;AACA,MAAIC,iBAAiB,UAArB;AACA,MAAIC,eAAe,QAAnB;AACA,MAAIC,mBAAmB,WAAvB;AACA,MAAIC,kBAAkB,UAAtB;AACA,MAAIC,iBAAiB,SAArB;AACA,MAAIC,aAAa,MAAjB;AACA,MAAIC,aAAa,MAAjB;;AAEA,MAAIC,SAAS;AACXC,UAAM,SAASA,IAAT,GAAgB;AACpB,UAAIpG,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAIoF,QAAQP,KAAKQ,QAAjB;AACA,UAAIE,WAAWV,KAAKU,QAApB;;AAEA,UAAIhM,EAAE2R,UAAF,CAAalL,QAAQrE,SAArB,CAAJ,EAAqC;AACnCyJ,cAAM+F,EAAN,CAASR,gBAAT,EAA2B3K,QAAQrE,SAAnC;AACD;;AAED,UAAIpC,EAAE2R,UAAF,CAAalL,QAAQpE,QAArB,CAAJ,EAAoC;AAClCwJ,cAAM+F,EAAN,CAASP,eAAT,EAA0B5K,QAAQpE,QAAlC;AACD;;AAED,UAAIrC,EAAE2R,UAAF,CAAalL,QAAQnE,OAArB,CAAJ,EAAmC;AACjCuJ,cAAM+F,EAAN,CAASN,cAAT,EAAyB7K,QAAQnE,OAAjC;AACD;;AAED,UAAItC,EAAE2R,UAAF,CAAalL,QAAQlE,IAArB,CAAJ,EAAgC;AAC9BsJ,cAAM+F,EAAN,CAASL,UAAT,EAAqB9K,QAAQlE,IAA7B;AACD;;AAED,UAAIvC,EAAE2R,UAAF,CAAalL,QAAQjE,IAArB,CAAJ,EAAgC;AAC9BqJ,cAAM+F,EAAN,CAASJ,UAAT,EAAqB/K,QAAQjE,IAA7B;AACD;;AAEDwJ,eAAS4F,EAAT,CAAYd,kBAAZ,EAAgChN,MAAMwH,KAAKuG,SAAX,EAAsB,IAAtB,CAAhC;;AAEA,UAAIpL,QAAQnF,QAAR,IAAoBmF,QAAQjF,WAAhC,EAA6C;AAC3CwK,iBAAS4F,EAAT,CAAYX,WAAZ,EAAyBnN,MAAMwH,KAAKwG,KAAX,EAAkB,IAAlB,CAAzB;AACD;;AAED,UAAIrL,QAAQ7E,wBAAZ,EAAsC;AACpCoK,iBAAS4F,EAAT,CAAYV,cAAZ,EAA4BpN,MAAMwH,KAAKyG,QAAX,EAAqB,IAArB,CAA5B;AACD;;AAED/R,QAAEiG,QAAF,EAAY2L,EAAZ,CAAeb,kBAAf,EAAmCzF,KAAK0G,UAAL,GAAkBlO,MAAMwH,KAAK2G,QAAX,EAAqB,IAArB,CAArD,EAAiFL,EAAjF,CAAoFZ,gBAApF,EAAsG1F,KAAK4G,SAAL,GAAiBpO,MAAMwH,KAAK6G,OAAX,EAAoB,IAApB,CAAvH;;AAEA,UAAI1L,QAAQjG,UAAZ,EAAwB;AACtBR,UAAE6C,MAAF,EAAU+O,EAAV,CAAaT,YAAb,EAA2B7F,KAAK8G,QAAL,GAAgBtO,MAAMwH,KAAK+G,MAAX,EAAmB,IAAnB,CAA3C;AACD;AACF,KA1CU;AA2CXC,YAAQ,SAASA,MAAT,GAAkB;AACxB,UAAIhH,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAIoF,QAAQP,KAAKQ,QAAjB;AACA,UAAIE,WAAWV,KAAKU,QAApB;;AAEA,UAAIhM,EAAE2R,UAAF,CAAalL,QAAQrE,SAArB,CAAJ,EAAqC;AACnCyJ,cAAM0G,GAAN,CAAUnB,gBAAV,EAA4B3K,QAAQrE,SAApC;AACD;;AAED,UAAIpC,EAAE2R,UAAF,CAAalL,QAAQpE,QAArB,CAAJ,EAAoC;AAClCwJ,cAAM0G,GAAN,CAAUlB,eAAV,EAA2B5K,QAAQpE,QAAnC;AACD;;AAED,UAAIrC,EAAE2R,UAAF,CAAalL,QAAQnE,OAArB,CAAJ,EAAmC;AACjCuJ,cAAM0G,GAAN,CAAUjB,cAAV,EAA0B7K,QAAQnE,OAAlC;AACD;;AAED,UAAItC,EAAE2R,UAAF,CAAalL,QAAQlE,IAArB,CAAJ,EAAgC;AAC9BsJ,cAAM0G,GAAN,CAAUhB,UAAV,EAAsB9K,QAAQlE,IAA9B;AACD;;AAED,UAAIvC,EAAE2R,UAAF,CAAalL,QAAQjE,IAArB,CAAJ,EAAgC;AAC9BqJ,cAAM0G,GAAN,CAAUf,UAAV,EAAsB/K,QAAQjE,IAA9B;AACD;;AAEDwJ,eAASuG,GAAT,CAAazB,kBAAb,EAAiCxF,KAAKuG,SAAtC;;AAEA,UAAIpL,QAAQnF,QAAR,IAAoBmF,QAAQjF,WAAhC,EAA6C;AAC3CwK,iBAASuG,GAAT,CAAatB,WAAb,EAA0B3F,KAAKwG,KAA/B;AACD;;AAED,UAAIrL,QAAQ7E,wBAAZ,EAAsC;AACpCoK,iBAASuG,GAAT,CAAarB,cAAb,EAA6B5F,KAAKyG,QAAlC;AACD;;AAED/R,QAAEiG,QAAF,EAAYsM,GAAZ,CAAgBxB,kBAAhB,EAAoCzF,KAAK0G,UAAzC,EAAqDO,GAArD,CAAyDvB,gBAAzD,EAA2E1F,KAAK4G,SAAhF;;AAEA,UAAIzL,QAAQjG,UAAZ,EAAwB;AACtBR,UAAE6C,MAAF,EAAU0P,GAAV,CAAcpB,YAAd,EAA4B7F,KAAK8G,QAAjC;AACD;AACF;AApFU,GAAb;;AAuFA,MAAII,iBAAiB,4CAArB;;AAEA,WAASC,UAAT,CAAoBC,IAApB,EAA0BC,OAA1B,EAAmC;AACjC,QAAIC,QAAQF,KAAKE,KAAjB;AAAA,QACIC,QAAQH,KAAKG,KADjB;;AAGA,QAAIC,MAAM;AACRC,YAAMH,KADE;AAERI,YAAMH;AAFE,KAAV;;AAKA,QAAIF,OAAJ,EAAa;AACX,aAAOG,GAAP;AACD;;AAED,WAAO9S,EAAEoN,MAAF,CAAS;AACd6F,cAAQL,KADM;AAEdM,cAAQL;AAFM,KAAT,EAGJC,GAHI,CAAP;AAID;;AAED,MAAIK,WAAW;AACbd,YAAQ,SAASA,MAAT,GAAkB;AACxB,UAAI/G,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAIsF,aAAaT,KAAKS,UAAtB;AACA,UAAIM,YAAYf,KAAKe,SAArB;AACA,UAAIpK,oBAAoBsK,OAAO9F,QAAQxE,iBAAf,KAAqC,GAA7D;AACA,UAAIC,qBAAqBqK,OAAO9F,QAAQvE,kBAAf,KAAsC,GAA/D;;AAEA,UAAIoJ,KAAK8D,QAAL,IAAiB/C,UAAUhG,KAAV,KAAoBpE,iBAArC,IAA0DoK,UAAU/F,MAAV,KAAqBpE,kBAAnF,EAAuG;AACrG;AACD;;AAED,UAAIyO,QAAQ5E,WAAW1F,KAAX,KAAqBgG,UAAUhG,KAA3C;;AAEA;AACA,UAAIsK,UAAU,CAAV,IAAe5E,WAAWzF,MAAX,OAAwB+F,UAAU/F,MAArD,EAA6D;AAC3D,SAAC,YAAY;AACX,cAAI8M,aAAa,KAAK,CAAtB;AACA,cAAIC,cAAc,KAAK,CAAvB;;AAEA,cAAI5M,QAAQhG,OAAZ,EAAqB;AACnB2S,yBAAa9H,KAAKgI,aAAL,EAAb;AACAD,0BAAc/H,KAAKiI,cAAL,EAAd;AACD;;AAEDjI,eAAKD,MAAL;;AAEA,cAAI5E,QAAQhG,OAAZ,EAAqB;AACnB6K,iBAAKkI,aAAL,CAAmBxT,EAAE4E,IAAF,CAAOwO,UAAP,EAAmB,UAAU5J,CAAV,EAAapG,CAAb,EAAgB;AACpDgQ,yBAAW5J,CAAX,IAAgBpG,IAAIuN,KAApB;AACD,aAFkB,CAAnB;AAGArF,iBAAKmI,cAAL,CAAoBzT,EAAE4E,IAAF,CAAOyO,WAAP,EAAoB,UAAU7J,CAAV,EAAapG,CAAb,EAAgB;AACtDiQ,0BAAY7J,CAAZ,IAAiBpG,IAAIuN,KAArB;AACD,aAFmB,CAApB;AAGD;AACF,SAnBD;AAoBD;AACF,KAtCY;AAuCboB,cAAU,SAASA,QAAT,GAAoB;AAC5B,UAAIzG,OAAO,IAAX;;AAEA,UAAIA,KAAK8D,QAAL,IAAiB9D,KAAK7E,OAAL,CAAatG,QAAb,KAA0B,MAA/C,EAAuD;AACrD;AACD;;AAEDmL,WAAKoI,WAAL,CAAiBpI,KAAKqI,QAAL,CAAcC,QAAd,CAAuB,cAAvB,IAAyC,MAAzC,GAAkD,MAAnE;AACD,KA/CY;AAgDb9B,WAAO,SAASA,KAAT,CAAe+B,KAAf,EAAsB;AAC3B,UAAIvI,OAAO,IAAX;AACA,UAAIwI,IAAID,MAAME,aAAN,IAAuBF,KAA/B;AACA,UAAIlD,QAAQpE,OAAOjB,KAAK7E,OAAL,CAAahF,cAApB,KAAuC,GAAnD;;AAEA,UAAI6J,KAAK8D,QAAT,EAAmB;AACjB;AACD;;AAEDyE,YAAMG,cAAN;;AAEA;AACA,UAAI1I,KAAK2I,QAAT,EAAmB;AACjB;AACD;;AAED3I,WAAK2I,QAAL,GAAgB,IAAhB;;AAEAC,iBAAW,YAAY;AACrB5I,aAAK2I,QAAL,GAAgB,KAAhB;AACD,OAFD,EAEG,EAFH;;AAIA,UAAIE,QAAQ,CAAZ;;AAEA,UAAIL,EAAEM,MAAN,EAAc;AACZD,gBAAQL,EAAEM,MAAF,GAAW,CAAX,GAAe,CAAf,GAAmB,CAAC,CAA5B;AACD,OAFD,MAEO,IAAIN,EAAEO,UAAN,EAAkB;AACvBF,gBAAQ,CAACL,EAAEO,UAAH,GAAgB,GAAxB;AACD,OAFM,MAEA,IAAIP,EAAEQ,MAAN,EAAc;AACnBH,gBAAQL,EAAEQ,MAAF,GAAW,CAAX,GAAe,CAAf,GAAmB,CAAC,CAA5B;AACD;;AAEDhJ,WAAK9I,IAAL,CAAU,CAAC2R,KAAD,GAASxD,KAAnB,EAA0BkD,KAA1B;AACD,KAjFY;AAkFbhC,eAAW,SAASA,SAAT,CAAmBiC,CAAnB,EAAsB;AAC/B,UAAIxI,OAAO,IAAX;;AAEA,UAAIA,KAAK8D,QAAT,EAAmB;AACjB;AACD;;AAED,UAAI3I,UAAU6E,KAAK7E,OAAnB;AACA,UAAI8N,WAAWjJ,KAAKiJ,QAApB;AACA,UAAIR,gBAAgBD,EAAEC,aAAtB;AACA,UAAIS,SAAS,KAAK,CAAlB;;AAEA,UAAIT,iBAAiBA,cAAcU,cAAnC,EAAmD;AACjD;AACAzU,UAAE4E,IAAF,CAAOmP,cAAcU,cAArB,EAAqC,UAAUjL,CAAV,EAAakL,KAAb,EAAoB;AACvDH,mBAASG,MAAMC,UAAf,IAA6BlC,WAAWiC,KAAX,CAA7B;AACD,SAFD;AAGD,OALD,MAKO;AACL;AACAH,iBAASR,iBAAiBA,cAAca,SAA/B,IAA4C,CAArD,IAA0DnC,WAAWsB,iBAAiBD,CAA5B,CAA1D;AACD;;AAED,UAAIpP,WAAW6P,QAAX,EAAqBpQ,MAArB,GAA8B,CAA9B,IAAmCsC,QAAQnF,QAA3C,IAAuDmF,QAAQlF,WAAnE,EAAgF;AAC9EiT,iBAAS,MAAT;AACD,OAFD,MAEO;AACLA,iBAASxU,EAAE8T,EAAEe,MAAJ,EAAYvU,IAAZ,CAAiB,QAAjB,CAAT;AACD;;AAED,UAAI,CAACkS,eAAezP,IAAf,CAAoByR,MAApB,CAAL,EAAkC;AAChC;AACD;;AAED,UAAIlJ,KAAKgE,OAAL,CAAa,WAAb,EAA0B;AAC5ByE,uBAAeA,aADa;AAE5BS,gBAAQA;AAFoB,OAA1B,EAGDM,kBAHC,EAAJ,EAGyB;AACvB;AACD;;AAEDhB,QAAEE,cAAF;;AAEA1I,WAAKkJ,MAAL,GAAcA,MAAd;AACAlJ,WAAKyJ,QAAL,GAAgB,KAAhB;;AAEA,UAAIP,WAAW,MAAf,EAAuB;AACrBlJ,aAAKyJ,QAAL,GAAgB,IAAhB;AACAzJ,aAAKqI,QAAL,CAAczH,QAAd,CAAuB,eAAvB;AACD;AACF,KAlIY;AAmIb+F,cAAU,SAASA,QAAT,CAAkB6B,CAAlB,EAAqB;AAC7B,UAAIxI,OAAO,IAAX;AACA,UAAIkJ,SAASlJ,KAAKkJ,MAAlB;;AAEA,UAAIlJ,KAAK8D,QAAL,IAAiB,CAACoF,MAAtB,EAA8B;AAC5B;AACD;;AAED,UAAID,WAAWjJ,KAAKiJ,QAApB;AACA,UAAIR,gBAAgBD,EAAEC,aAAtB;;AAEAD,QAAEE,cAAF;;AAEA,UAAI1I,KAAKgE,OAAL,CAAa,UAAb,EAAyB;AAC3ByE,uBAAeA,aADY;AAE3BS,gBAAQA;AAFmB,OAAzB,EAGDM,kBAHC,EAAJ,EAGyB;AACvB;AACD;;AAED,UAAIf,iBAAiBA,cAAcU,cAAnC,EAAmD;AACjDzU,UAAE4E,IAAF,CAAOmP,cAAcU,cAArB,EAAqC,UAAUjL,CAAV,EAAakL,KAAb,EAAoB;AACvD1U,YAAEoN,MAAF,CAASmH,SAASG,MAAMC,UAAf,CAAT,EAAqClC,WAAWiC,KAAX,EAAkB,IAAlB,CAArC;AACD,SAFD;AAGD,OAJD,MAIO;AACL1U,UAAEoN,MAAF,CAASmH,SAASR,iBAAiBA,cAAca,SAA/B,IAA4C,CAArD,CAAT,EAAkEnC,WAAWsB,iBAAiBD,CAA5B,EAA+B,IAA/B,CAAlE;AACD;;AAEDxI,WAAK0J,MAAL,CAAYlB,CAAZ;AACD,KAhKY;AAiKb3B,aAAS,SAASA,OAAT,CAAiB2B,CAAjB,EAAoB;AAC3B,UAAIxI,OAAO,IAAX;;AAEA,UAAIA,KAAK8D,QAAT,EAAmB;AACjB;AACD;;AAED,UAAIoF,SAASlJ,KAAKkJ,MAAlB;AACA,UAAID,WAAWjJ,KAAKiJ,QAApB;AACA,UAAIR,gBAAgBD,EAAEC,aAAtB;;AAEA,UAAIA,iBAAiBA,cAAcU,cAAnC,EAAmD;AACjDzU,UAAE4E,IAAF,CAAOmP,cAAcU,cAArB,EAAqC,UAAUjL,CAAV,EAAakL,KAAb,EAAoB;AACvD,iBAAOH,SAASG,MAAMC,UAAf,CAAP;AACD,SAFD;AAGD,OAJD,MAIO;AACL,eAAOJ,SAASR,iBAAiBA,cAAca,SAA/B,IAA4C,CAArD,CAAP;AACD;;AAED,UAAI,CAACJ,MAAL,EAAa;AACX;AACD;;AAEDV,QAAEE,cAAF;;AAEA,UAAI,CAACtP,WAAW6P,QAAX,EAAqBpQ,MAA1B,EAAkC;AAChCmH,aAAKkJ,MAAL,GAAc,EAAd;AACD;;AAED,UAAIlJ,KAAKyJ,QAAT,EAAmB;AACjBzJ,aAAKyJ,QAAL,GAAgB,KAAhB;AACAzJ,aAAKqI,QAAL,CAAcsB,WAAd,CAA0B,eAA1B,EAA2C3J,KAAKK,OAAL,IAAgBL,KAAK7E,OAAL,CAAa7F,KAAxE;AACD;;AAED0K,WAAKgE,OAAL,CAAa,SAAb,EAAwB;AACtByE,uBAAeA,aADO;AAEtBS,gBAAQA;AAFc,OAAxB;AAID;AAvMY,GAAf;;AA0MA;AACA,MAAIU,cAAc,GAAlB;AACA,MAAIC,cAAc,GAAlB;AACA,MAAIC,eAAe,GAAnB;AACA,MAAIC,eAAe,GAAnB;AACA,MAAIC,oBAAoB,IAAxB;AACA,MAAIC,oBAAoB,IAAxB;AACA,MAAIC,oBAAoB,IAAxB;AACA,MAAIC,oBAAoB,IAAxB;;AAEA,WAASC,eAAT,CAAyBnB,QAAzB,EAAmC;AACjC,QAAIoB,YAAY3V,EAAEoN,MAAF,CAAS,EAAT,EAAamH,QAAb,CAAhB;AACA,QAAIqB,SAAS,EAAb;;AAEA5V,MAAE4E,IAAF,CAAO2P,QAAP,EAAiB,UAAUK,SAAV,EAAqBiB,OAArB,EAA8B;AAC7C,aAAOF,UAAUf,SAAV,CAAP;;AAEA5U,QAAE4E,IAAF,CAAO+Q,SAAP,EAAkB,UAAUG,UAAV,EAAsBC,QAAtB,EAAgC;AAChD,YAAIC,KAAK5O,KAAKC,GAAL,CAASwO,QAAQ5C,MAAR,GAAiB8C,SAAS9C,MAAnC,CAAT;AACA,YAAIgD,KAAK7O,KAAKC,GAAL,CAASwO,QAAQ3C,MAAR,GAAiB6C,SAAS7C,MAAnC,CAAT;AACA,YAAIgD,KAAK9O,KAAKC,GAAL,CAASwO,QAAQ9C,IAAR,GAAegD,SAAShD,IAAjC,CAAT;AACA,YAAIoD,KAAK/O,KAAKC,GAAL,CAASwO,QAAQ7C,IAAR,GAAe+C,SAAS/C,IAAjC,CAAT;AACA,YAAIoD,KAAKhP,KAAKiP,IAAL,CAAUL,KAAKA,EAAL,GAAUC,KAAKA,EAAzB,CAAT;AACA,YAAIK,KAAKlP,KAAKiP,IAAL,CAAUH,KAAKA,EAAL,GAAUC,KAAKA,EAAzB,CAAT;AACA,YAAIxF,QAAQ,CAAC2F,KAAKF,EAAN,IAAYA,EAAxB;;AAEAR,eAAOjS,IAAP,CAAYgN,KAAZ;AACD,OAVD;AAWD,KAdD;;AAgBAiF,WAAOW,IAAP,CAAY,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAC1B,aAAOrP,KAAKC,GAAL,CAASmP,CAAT,IAAcpP,KAAKC,GAAL,CAASoP,CAAT,CAArB;AACD,KAFD;;AAIA,WAAOb,OAAO,CAAP,CAAP;AACD;;AAED,MAAIc,WAAW;AACb1B,YAAQ,SAASA,MAAT,CAAgBlB,CAAhB,EAAmB;AACzB,UAAIxI,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAI8N,WAAWjJ,KAAKiJ,QAApB;AACA,UAAIsB,UAAUtB,SAAS7P,WAAW6P,QAAX,EAAqB,CAArB,CAAT,CAAd;AACA,UAAIlI,YAAYf,KAAKe,SAArB;AACA,UAAIrE,SAASsD,KAAKtD,MAAlB;AACA,UAAIwF,UAAUlC,KAAKkC,OAAnB;AACA,UAAIgH,SAASlJ,KAAKkJ,MAAlB;AACA,UAAIpU,cAAcqG,QAAQrG,WAA1B;AACA,UAAIiG,QAAQmH,QAAQnH,KAApB;AACA,UAAIC,SAASkH,QAAQlH,MAArB;AACA,UAAIwG,OAAOU,QAAQV,IAAnB;AACA,UAAIE,MAAMQ,QAAQR,GAAlB;AACA,UAAI2J,QAAQ7J,OAAOzG,KAAnB;AACA,UAAIuQ,SAAS5J,MAAM1G,MAAnB;AACA,UAAI0H,UAAU,CAAd;AACA,UAAIE,SAAS,CAAb;AACA,UAAIP,WAAWtB,UAAUhG,KAAzB;AACA,UAAIwH,YAAYxB,UAAU/F,MAA1B;AACA,UAAIuQ,aAAa,IAAjB;AACA,UAAIpT,SAAS,KAAK,CAAlB;;AAEA;AACA,UAAI,CAACrD,WAAD,IAAgB0T,EAAEgD,QAAtB,EAAgC;AAC9B1W,sBAAciG,SAASC,MAAT,GAAkBD,QAAQC,MAA1B,GAAmC,CAAjD;AACD;;AAED,UAAIgF,KAAK2B,OAAT,EAAkB;AAChBe,kBAAUR,QAAQQ,OAAlB;AACAE,iBAASV,QAAQU,MAAjB;AACAP,mBAAWK,UAAU5G,KAAK6G,GAAL,CAAS5B,UAAUhG,KAAnB,EAA0B2B,OAAO3B,KAAjC,EAAwC2B,OAAO8E,IAAP,GAAc9E,OAAO3B,KAA7D,CAArB;AACAwH,oBAAYK,SAAS9G,KAAK6G,GAAL,CAAS5B,UAAU/F,MAAnB,EAA2B0B,OAAO1B,MAAlC,EAA0C0B,OAAOgF,GAAP,GAAahF,OAAO1B,MAA9D,CAArB;AACD;;AAED,UAAIyQ,QAAQ;AACVC,WAAGnB,QAAQ9C,IAAR,GAAe8C,QAAQ5C,MADhB;AAEVgE,WAAGpB,QAAQ7C,IAAR,GAAe6C,QAAQ3C;AAFhB,OAAZ;;AAKA,UAAI9S,WAAJ,EAAiB;AACf2W,cAAMG,CAAN,GAAUH,MAAME,CAAN,GAAU7W,WAApB;AACA2W,cAAMI,CAAN,GAAUJ,MAAMC,CAAN,GAAU5W,WAApB;AACD;;AAED,cAAQoU,MAAR;AACE;AACA,aAAK,KAAL;AACE1H,kBAAQiK,MAAMC,CAAd;AACAhK,iBAAO+J,MAAME,CAAb;AACA;;AAEF;AACA,aAAK/B,WAAL;AACE,cAAI6B,MAAMC,CAAN,IAAW,CAAX,KAAiBL,SAAShJ,QAAT,IAAqBvN,gBAAgB4M,OAAOkB,MAAP,IAAiB0I,UAAU/I,SAA3C,CAAtC,CAAJ,EAAkG;AAChGgJ,yBAAa,KAAb;AACA;AACD;;AAEDxQ,mBAAS0Q,MAAMC,CAAf;;AAEA,cAAI5W,WAAJ,EAAiB;AACfkG,qBAASD,QAAQjG,WAAjB;AACA4M,mBAAO+J,MAAMI,CAAN,GAAU,CAAjB;AACD;;AAED,cAAI9Q,QAAQ,CAAZ,EAAe;AACbmO,qBAASW,WAAT;AACA9O,oBAAQ,CAAR;AACD;;AAED;;AAEF,aAAKgP,YAAL;AACE,cAAI0B,MAAME,CAAN,IAAW,CAAX,KAAiBjK,OAAOkB,MAAP,IAAiB9N,gBAAgB0M,QAAQkB,OAAR,IAAmB2I,SAAShJ,QAA5C,CAAlC,CAAJ,EAA8F;AAC5FkJ,yBAAa,KAAb;AACA;AACD;;AAEDvQ,oBAAUyQ,MAAME,CAAhB;AACAjK,iBAAO+J,MAAME,CAAb;;AAEA,cAAI7W,WAAJ,EAAiB;AACfiG,oBAAQC,SAASlG,WAAjB;AACA0M,oBAAQiK,MAAMG,CAAN,GAAU,CAAlB;AACD;;AAED,cAAI5Q,SAAS,CAAb,EAAgB;AACdkO,qBAASY,YAAT;AACA9O,qBAAS,CAAT;AACD;;AAED;;AAEF,aAAK6O,WAAL;AACE,cAAI4B,MAAMC,CAAN,IAAW,CAAX,KAAiBlK,QAAQkB,OAAR,IAAmB5N,gBAAgB4M,OAAOkB,MAAP,IAAiB0I,UAAU/I,SAA3C,CAApC,CAAJ,EAAgG;AAC9FgJ,yBAAa,KAAb;AACA;AACD;;AAEDxQ,mBAAS0Q,MAAMC,CAAf;AACAlK,kBAAQiK,MAAMC,CAAd;;AAEA,cAAI5W,WAAJ,EAAiB;AACfkG,qBAASD,QAAQjG,WAAjB;AACA4M,mBAAO+J,MAAMI,CAAN,GAAU,CAAjB;AACD;;AAED,cAAI9Q,QAAQ,CAAZ,EAAe;AACbmO,qBAASU,WAAT;AACA7O,oBAAQ,CAAR;AACD;;AAED;;AAEF,aAAK+O,YAAL;AACE,cAAI2B,MAAME,CAAN,IAAW,CAAX,KAAiBL,UAAU/I,SAAV,IAAuBzN,gBAAgB0M,QAAQkB,OAAR,IAAmB2I,SAAShJ,QAA5C,CAAxC,CAAJ,EAAoG;AAClGkJ,yBAAa,KAAb;AACA;AACD;;AAEDvQ,oBAAUyQ,MAAME,CAAhB;;AAEA,cAAI7W,WAAJ,EAAiB;AACfiG,oBAAQC,SAASlG,WAAjB;AACA0M,oBAAQiK,MAAMG,CAAN,GAAU,CAAlB;AACD;;AAED,cAAI5Q,SAAS,CAAb,EAAgB;AACdkO,qBAASa,YAAT;AACA/O,qBAAS,CAAT;AACD;;AAED;;AAEF,aAAKkP,iBAAL;AACE,cAAIpV,WAAJ,EAAiB;AACf,gBAAI2W,MAAME,CAAN,IAAW,CAAX,KAAiBjK,OAAOkB,MAAP,IAAiByI,SAAShJ,QAA3C,CAAJ,EAA0D;AACxDkJ,2BAAa,KAAb;AACA;AACD;;AAEDvQ,sBAAUyQ,MAAME,CAAhB;AACAjK,mBAAO+J,MAAME,CAAb;AACA5Q,oBAAQC,SAASlG,WAAjB;AACD,WATD,MASO;AACL,gBAAI2W,MAAMC,CAAN,IAAW,CAAf,EAAkB;AAChB,kBAAIL,QAAQhJ,QAAZ,EAAsB;AACpBtH,yBAAS0Q,MAAMC,CAAf;AACD,eAFD,MAEO,IAAID,MAAME,CAAN,IAAW,CAAX,IAAgBjK,OAAOkB,MAA3B,EAAmC;AACxC2I,6BAAa,KAAb;AACD;AACF,aAND,MAMO;AACLxQ,uBAAS0Q,MAAMC,CAAf;AACD;;AAED,gBAAID,MAAME,CAAN,IAAW,CAAf,EAAkB;AAChB,kBAAIjK,MAAMkB,MAAV,EAAkB;AAChB5H,0BAAUyQ,MAAME,CAAhB;AACAjK,uBAAO+J,MAAME,CAAb;AACD;AACF,aALD,MAKO;AACL3Q,wBAAUyQ,MAAME,CAAhB;AACAjK,qBAAO+J,MAAME,CAAb;AACD;AACF;;AAED,cAAI5Q,QAAQ,CAAR,IAAaC,SAAS,CAA1B,EAA6B;AAC3BkO,qBAASe,iBAAT;AACAjP,qBAAS,CAAT;AACAD,oBAAQ,CAAR;AACD,WAJD,MAIO,IAAIA,QAAQ,CAAZ,EAAe;AACpBmO,qBAASiB,iBAAT;AACApP,oBAAQ,CAAR;AACD,WAHM,MAGA,IAAIC,SAAS,CAAb,EAAgB;AACrBkO,qBAASc,iBAAT;AACAhP,qBAAS,CAAT;AACD;;AAED;;AAEF,aAAKmP,iBAAL;AACE,cAAIrV,WAAJ,EAAiB;AACf,gBAAI2W,MAAME,CAAN,IAAW,CAAX,KAAiBjK,OAAOkB,MAAP,IAAiBpB,QAAQkB,OAA1C,CAAJ,EAAwD;AACtD6I,2BAAa,KAAb;AACA;AACD;;AAEDvQ,sBAAUyQ,MAAME,CAAhB;AACAjK,mBAAO+J,MAAME,CAAb;AACA5Q,oBAAQC,SAASlG,WAAjB;AACA0M,oBAAQiK,MAAMG,CAAd;AACD,WAVD,MAUO;AACL,gBAAIH,MAAMC,CAAN,IAAW,CAAf,EAAkB;AAChB,kBAAIlK,OAAOkB,OAAX,EAAoB;AAClB3H,yBAAS0Q,MAAMC,CAAf;AACAlK,wBAAQiK,MAAMC,CAAd;AACD,eAHD,MAGO,IAAID,MAAME,CAAN,IAAW,CAAX,IAAgBjK,OAAOkB,MAA3B,EAAmC;AACxC2I,6BAAa,KAAb;AACD;AACF,aAPD,MAOO;AACLxQ,uBAAS0Q,MAAMC,CAAf;AACAlK,sBAAQiK,MAAMC,CAAd;AACD;;AAED,gBAAID,MAAME,CAAN,IAAW,CAAf,EAAkB;AAChB,kBAAIjK,MAAMkB,MAAV,EAAkB;AAChB5H,0BAAUyQ,MAAME,CAAhB;AACAjK,uBAAO+J,MAAME,CAAb;AACD;AACF,aALD,MAKO;AACL3Q,wBAAUyQ,MAAME,CAAhB;AACAjK,qBAAO+J,MAAME,CAAb;AACD;AACF;;AAED,cAAI5Q,QAAQ,CAAR,IAAaC,SAAS,CAA1B,EAA6B;AAC3BkO,qBAASc,iBAAT;AACAhP,qBAAS,CAAT;AACAD,oBAAQ,CAAR;AACD,WAJD,MAIO,IAAIA,QAAQ,CAAZ,EAAe;AACpBmO,qBAASgB,iBAAT;AACAnP,oBAAQ,CAAR;AACD,WAHM,MAGA,IAAIC,SAAS,CAAb,EAAgB;AACrBkO,qBAASe,iBAAT;AACAjP,qBAAS,CAAT;AACD;;AAED;;AAEF,aAAKiP,iBAAL;AACE,cAAInV,WAAJ,EAAiB;AACf,gBAAI2W,MAAMC,CAAN,IAAW,CAAX,KAAiBlK,QAAQkB,OAAR,IAAmB4I,UAAU/I,SAA9C,CAAJ,EAA8D;AAC5DgJ,2BAAa,KAAb;AACA;AACD;;AAEDxQ,qBAAS0Q,MAAMC,CAAf;AACAlK,oBAAQiK,MAAMC,CAAd;AACA1Q,qBAASD,QAAQjG,WAAjB;AACD,WATD,MASO;AACL,gBAAI2W,MAAMC,CAAN,IAAW,CAAf,EAAkB;AAChB,kBAAIlK,OAAOkB,OAAX,EAAoB;AAClB3H,yBAAS0Q,MAAMC,CAAf;AACAlK,wBAAQiK,MAAMC,CAAd;AACD,eAHD,MAGO,IAAID,MAAME,CAAN,IAAW,CAAX,IAAgBL,UAAU/I,SAA9B,EAAyC;AAC9CgJ,6BAAa,KAAb;AACD;AACF,aAPD,MAOO;AACLxQ,uBAAS0Q,MAAMC,CAAf;AACAlK,sBAAQiK,MAAMC,CAAd;AACD;;AAED,gBAAID,MAAME,CAAN,IAAW,CAAf,EAAkB;AAChB,kBAAIL,SAAS/I,SAAb,EAAwB;AACtBvH,0BAAUyQ,MAAME,CAAhB;AACD;AACF,aAJD,MAIO;AACL3Q,wBAAUyQ,MAAME,CAAhB;AACD;AACF;;AAED,cAAI5Q,QAAQ,CAAR,IAAaC,SAAS,CAA1B,EAA6B;AAC3BkO,qBAASgB,iBAAT;AACAlP,qBAAS,CAAT;AACAD,oBAAQ,CAAR;AACD,WAJD,MAIO,IAAIA,QAAQ,CAAZ,EAAe;AACpBmO,qBAASc,iBAAT;AACAjP,oBAAQ,CAAR;AACD,WAHM,MAGA,IAAIC,SAAS,CAAb,EAAgB;AACrBkO,qBAASiB,iBAAT;AACAnP,qBAAS,CAAT;AACD;;AAED;;AAEF,aAAKgP,iBAAL;AACE,cAAIlV,WAAJ,EAAiB;AACf,gBAAI2W,MAAMC,CAAN,IAAW,CAAX,KAAiBL,SAAShJ,QAAT,IAAqBiJ,UAAU/I,SAAhD,CAAJ,EAAgE;AAC9DgJ,2BAAa,KAAb;AACA;AACD;;AAEDxQ,qBAAS0Q,MAAMC,CAAf;AACA1Q,qBAASD,QAAQjG,WAAjB;AACD,WARD,MAQO;AACL,gBAAI2W,MAAMC,CAAN,IAAW,CAAf,EAAkB;AAChB,kBAAIL,QAAQhJ,QAAZ,EAAsB;AACpBtH,yBAAS0Q,MAAMC,CAAf;AACD,eAFD,MAEO,IAAID,MAAME,CAAN,IAAW,CAAX,IAAgBL,UAAU/I,SAA9B,EAAyC;AAC9CgJ,6BAAa,KAAb;AACD;AACF,aAND,MAMO;AACLxQ,uBAAS0Q,MAAMC,CAAf;AACD;;AAED,gBAAID,MAAME,CAAN,IAAW,CAAf,EAAkB;AAChB,kBAAIL,SAAS/I,SAAb,EAAwB;AACtBvH,0BAAUyQ,MAAME,CAAhB;AACD;AACF,aAJD,MAIO;AACL3Q,wBAAUyQ,MAAME,CAAhB;AACD;AACF;;AAED,cAAI5Q,QAAQ,CAAR,IAAaC,SAAS,CAA1B,EAA6B;AAC3BkO,qBAASiB,iBAAT;AACAnP,qBAAS,CAAT;AACAD,oBAAQ,CAAR;AACD,WAJD,MAIO,IAAIA,QAAQ,CAAZ,EAAe;AACpBmO,qBAASe,iBAAT;AACAlP,oBAAQ,CAAR;AACD,WAHM,MAGA,IAAIC,SAAS,CAAb,EAAgB;AACrBkO,qBAASgB,iBAAT;AACAlP,qBAAS,CAAT;AACD;;AAED;;AAEF;AACA,aAAK,MAAL;AACEgF,eAAK8L,IAAL,CAAUL,MAAMC,CAAhB,EAAmBD,MAAME,CAAzB;AACAJ,uBAAa,KAAb;AACA;;AAEF;AACA,aAAK,MAAL;AACEvL,eAAK9I,IAAL,CAAUkT,gBAAgBnB,QAAhB,CAAV,EAAqCT,EAAEC,aAAvC;AACA8C,uBAAa,KAAb;AACA;;AAEF;AACA,aAAK,MAAL;AACE,cAAI,CAACE,MAAMC,CAAP,IAAY,CAACD,MAAME,CAAvB,EAA0B;AACxBJ,yBAAa,KAAb;AACA;AACD;;AAEDpT,mBAAS6H,KAAKU,QAAL,CAAcvI,MAAd,EAAT;AACAqJ,iBAAO+I,QAAQ5C,MAAR,GAAiBxP,OAAOqJ,IAA/B;AACAE,gBAAM6I,QAAQ3C,MAAR,GAAiBzP,OAAOuJ,GAA9B;AACA3G,kBAAQmH,QAAQC,QAAhB;AACAnH,mBAASkH,QAAQE,SAAjB;;AAEA,cAAIqJ,MAAMC,CAAN,GAAU,CAAd,EAAiB;AACfxC,qBAASuC,MAAME,CAAN,GAAU,CAAV,GAAc3B,iBAAd,GAAkCE,iBAA3C;AACD,WAFD,MAEO,IAAIuB,MAAMC,CAAN,GAAU,CAAd,EAAiB;AACtBlK,oBAAQzG,KAAR;AACAmO,qBAASuC,MAAME,CAAN,GAAU,CAAV,GAAc1B,iBAAd,GAAkCE,iBAA3C;AACD;;AAED,cAAIsB,MAAME,CAAN,GAAU,CAAd,EAAiB;AACfjK,mBAAO1G,MAAP;AACD;;AAED;AACA,cAAI,CAACgF,KAAKK,OAAV,EAAmB;AACjBL,iBAAK6D,QAAL,CAAchD,WAAd,CAA0B,gBAA1B;AACAb,iBAAKK,OAAL,GAAe,IAAf;;AAEA,gBAAIL,KAAK2B,OAAT,EAAkB;AAChB3B,mBAAKqD,YAAL,CAAkB,IAAlB,EAAwB,IAAxB;AACD;AACF;;AAED;;AAEF;AAlUF;;AAqUA,UAAIkI,UAAJ,EAAgB;AACdrJ,gBAAQnH,KAAR,GAAgBA,KAAhB;AACAmH,gBAAQlH,MAAR,GAAiBA,MAAjB;AACAkH,gBAAQV,IAAR,GAAeA,IAAf;AACAU,gBAAQR,GAAR,GAAcA,GAAd;AACA1B,aAAKkJ,MAAL,GAAcA,MAAd;AACAlJ,aAAKM,aAAL;AACD;;AAED;AACA5L,QAAE4E,IAAF,CAAO2P,QAAP,EAAiB,UAAU/K,CAAV,EAAa6N,CAAb,EAAgB;AAC/BA,UAAEpE,MAAF,GAAWoE,EAAEtE,IAAb;AACAsE,UAAEnE,MAAF,GAAWmE,EAAErE,IAAb;AACD,OAHD;AAID;AAjYY,GAAf;;AAoYA,MAAIsE,iBAAiB,SAAjBA,cAAiB,CAAUC,QAAV,EAAoBC,WAApB,EAAiC;AACpD,QAAI,EAAED,oBAAoBC,WAAtB,CAAJ,EAAwC;AACtC,YAAM,IAAIC,SAAJ,CAAc,mCAAd,CAAN;AACD;AACF,GAJD;;AAMA,MAAIC,cAAc,YAAY;AAC5B,aAASC,gBAAT,CAA0B9C,MAA1B,EAAkC+C,KAAlC,EAAyC;AACvC,WAAK,IAAIpO,IAAI,CAAb,EAAgBA,IAAIoO,MAAMzT,MAA1B,EAAkCqF,GAAlC,EAAuC;AACrC,YAAIqO,aAAaD,MAAMpO,CAAN,CAAjB;AACAqO,mBAAWC,UAAX,GAAwBD,WAAWC,UAAX,IAAyB,KAAjD;AACAD,mBAAWE,YAAX,GAA0B,IAA1B;AACA,YAAI,WAAWF,UAAf,EAA2BA,WAAWG,QAAX,GAAsB,IAAtB;AAC3B,sCAAsBnD,MAAtB,EAA8BgD,WAAWhT,GAAzC,EAA8CgT,UAA9C;AACD;AACF;;AAED,WAAO,UAAUL,WAAV,EAAuBS,UAAvB,EAAmCC,WAAnC,EAAgD;AACrD,UAAID,UAAJ,EAAgBN,iBAAiBH,YAAYW,SAA7B,EAAwCF,UAAxC;AAChB,UAAIC,WAAJ,EAAiBP,iBAAiBH,WAAjB,EAA8BU,WAA9B;AACjB,aAAOV,WAAP;AACD,KAJD;AAKD,GAhBiB,EAAlB;;AAwBA,MAAIY,MAAM,SAASA,GAAT,CAAaC,MAAb,EAAqBC,QAArB,EAA+BC,QAA/B,EAAyC;AACjD,QAAIF,WAAW,IAAf,EAAqBA,SAASG,SAASL,SAAlB;AACrB,QAAIM,OAAO,wCAAgCJ,MAAhC,EAAwCC,QAAxC,CAAX;;AAEA,QAAIG,SAASC,SAAb,EAAwB;AACtB,UAAIC,SAAS,8BAAsBN,MAAtB,CAAb;;AAEA,UAAIM,WAAW,IAAf,EAAqB;AACnB,eAAOD,SAAP;AACD,OAFD,MAEO;AACL,eAAON,IAAIO,MAAJ,EAAYL,QAAZ,EAAsBC,QAAtB,CAAP;AACD;AACF,KARD,MAQO,IAAI,WAAWE,IAAf,EAAqB;AAC1B,aAAOA,KAAKG,KAAZ;AACD,KAFM,MAEA;AACL,UAAIC,SAASJ,KAAKL,GAAlB;;AAEA,UAAIS,WAAWH,SAAf,EAA0B;AACxB,eAAOA,SAAP;AACD;;AAED,aAAOG,OAAOC,IAAP,CAAYP,QAAZ,CAAP;AACD;AACF,GAvBD;;AAyCA,MAAIQ,MAAM,SAASA,GAAT,CAAaV,MAAb,EAAqBC,QAArB,EAA+BM,KAA/B,EAAsCL,QAAtC,EAAgD;AACxD,QAAIE,OAAO,wCAAgCJ,MAAhC,EAAwCC,QAAxC,CAAX;;AAEA,QAAIG,SAASC,SAAb,EAAwB;AACtB,UAAIC,SAAS,8BAAsBN,MAAtB,CAAb;;AAEA,UAAIM,WAAW,IAAf,EAAqB;AACnBI,YAAIJ,MAAJ,EAAYL,QAAZ,EAAsBM,KAAtB,EAA6BL,QAA7B;AACD;AACF,KAND,MAMO,IAAI,WAAWE,IAAX,IAAmBA,KAAKT,QAA5B,EAAsC;AAC3CS,WAAKG,KAAL,GAAaA,KAAb;AACD,KAFM,MAEA;AACL,UAAII,SAASP,KAAKM,GAAlB;;AAEA,UAAIC,WAAWN,SAAf,EAA0B;AACxBM,eAAOF,IAAP,CAAYP,QAAZ,EAAsBK,KAAtB;AACD;AACF;;AAED,WAAOA,KAAP;AACD,GApBD;;AAoCA,MAAIK,oBAAoB,SAApBA,iBAAoB,CAAUC,GAAV,EAAe;AACrC,QAAI9U,MAAM+U,OAAN,CAAcD,GAAd,CAAJ,EAAwB;AACtB,WAAK,IAAI1P,IAAI,CAAR,EAAW4P,OAAOhV,MAAM8U,IAAI/U,MAAV,CAAvB,EAA0CqF,IAAI0P,IAAI/U,MAAlD,EAA0DqF,GAA1D;AAA+D4P,aAAK5P,CAAL,IAAU0P,IAAI1P,CAAJ,CAAV;AAA/D,OAEA,OAAO4P,IAAP;AACD,KAJD,MAIO;AACL,aAAO,oBAAWF,GAAX,CAAP;AACD;AACF,GARD;;AAUA,WAASG,iBAAT,CAA2B9E,QAA3B,EAAqC;AACnC,QAAI3B,QAAQ,CAAZ;AACA,QAAIC,QAAQ,CAAZ;AACA,QAAIyG,QAAQ,CAAZ;;AAEAtZ,MAAE4E,IAAF,CAAO2P,QAAP,EAAiB,UAAU/K,CAAV,EAAakJ,IAAb,EAAmB;AAClC,UAAIO,SAASP,KAAKO,MAAlB;AAAA,UACIC,SAASR,KAAKQ,MADlB;;AAGAN,eAASK,MAAT;AACAJ,eAASK,MAAT;AACAoG,eAAS,CAAT;AACD,KAPD;;AASA1G,aAAS0G,KAAT;AACAzG,aAASyG,KAAT;;AAEA,WAAO;AACL1G,aAAOA,KADF;AAELC,aAAOA;AAFF,KAAP;AAID;;AAED,MAAI0G,UAAU;AACZ;AACAhX,UAAM,SAASA,IAAT,GAAgB;AACpB,UAAI+I,OAAO,IAAX;;AAEA,UAAI,CAACA,KAAKnJ,KAAN,IAAemJ,KAAK8D,QAAxB,EAAkC;AAChC;AACD;;AAED,UAAI,CAAC9D,KAAKK,OAAV,EAAmB;AACjBL,aAAKK,OAAL,GAAe,IAAf;AACAL,aAAKqD,YAAL,CAAkB,IAAlB,EAAwB,IAAxB;;AAEA,YAAIrD,KAAK7E,OAAL,CAAa7F,KAAjB,EAAwB;AACtB0K,eAAKqI,QAAL,CAAczH,QAAd,CAAuB,eAAvB;AACD;;AAEDZ,aAAK6D,QAAL,CAAchD,WAAd,CAA0B,gBAA1B;AACD;;AAEDb,WAAKmI,cAAL,CAAoBnI,KAAKyD,cAAzB;AACD,KArBW;;AAwBZ;AACAyK,WAAO,SAASA,KAAT,GAAiB;AACtB,UAAIlO,OAAO,IAAX;;AAEA,UAAI,CAACA,KAAKnJ,KAAN,IAAemJ,KAAK8D,QAAxB,EAAkC;AAChC;AACD;;AAED9D,WAAK1F,KAAL,GAAa5F,EAAEoN,MAAF,CAAS,EAAT,EAAa9B,KAAK6B,YAAlB,CAAb;AACA7B,WAAKtD,MAAL,GAAchI,EAAEoN,MAAF,CAAS,EAAT,EAAa9B,KAAK+B,aAAlB,CAAd;AACA/B,WAAKkC,OAAL,GAAexN,EAAEoN,MAAF,CAAS,EAAT,EAAa9B,KAAKyD,cAAlB,CAAf;;AAEAzD,WAAKI,YAAL;;AAEA,UAAIJ,KAAKK,OAAT,EAAkB;AAChBL,aAAKM,aAAL;AACD;AACF,KAzCW;;AA4CZ;AACA6N,WAAO,SAASA,KAAT,GAAiB;AACtB,UAAInO,OAAO,IAAX;;AAEA,UAAI,CAACA,KAAKK,OAAN,IAAiBL,KAAK8D,QAA1B,EAAoC;AAClC;AACD;;AAEDpP,QAAEoN,MAAF,CAAS9B,KAAKkC,OAAd,EAAuB;AACrBV,cAAM,CADe;AAErBE,aAAK,CAFgB;AAGrB3G,eAAO,CAHc;AAIrBC,gBAAQ;AAJa,OAAvB;;AAOAgF,WAAKK,OAAL,GAAe,KAAf;AACAL,WAAKM,aAAL;;AAEAN,WAAK4B,WAAL,CAAiB,IAAjB,EAAuB,IAAvB;;AAEA;AACA5B,WAAKI,YAAL;;AAEAJ,WAAKqI,QAAL,CAAcxH,WAAd,CAA0B,eAA1B;AACAb,WAAK6D,QAAL,CAAcjD,QAAd,CAAuB,gBAAvB;AACD,KArEW;;AAwEZ;;;;;;AAMAtB,aAAS,SAASA,OAAT,CAAiB7F,GAAjB,EAAsB2U,gBAAtB,EAAwC;AAC/C,UAAIpO,OAAO,IAAX;;AAEA,UAAI,CAACA,KAAK8D,QAAN,IAAkBrK,GAAtB,EAA2B;AACzB,YAAIuG,KAAKqO,KAAT,EAAgB;AACdrO,eAAKQ,QAAL,CAAc8N,IAAd,CAAmB,KAAnB,EAA0B7U,GAA1B;AACD;;AAED,YAAI2U,gBAAJ,EAAsB;AACpBpO,eAAKvG,GAAL,GAAWA,GAAX;AACAuG,eAAKwD,MAAL,CAAY8K,IAAZ,CAAiB,KAAjB,EAAwB7U,GAAxB;;AAEA,cAAIuG,KAAKnJ,KAAT,EAAgB;AACdmJ,iBAAKwE,QAAL,CAAcc,IAAd,CAAmB,KAAnB,EAA0BiJ,GAA1B,CAA8BvO,KAAKuE,OAAnC,EAA4C+J,IAA5C,CAAiD,KAAjD,EAAwD7U,GAAxD;AACD;AACF,SAPD,MAOO;AACL,cAAIuG,KAAKqO,KAAT,EAAgB;AACdrO,iBAAKwO,QAAL,GAAgB,IAAhB;AACD;;AAED;AACAxO,eAAK7E,OAAL,CAAanG,IAAb,GAAoB,IAApB;AACAgL,eAAKlF,IAAL,CAAUrB,GAAV;AACD;AACF;AACF,KAvGW;;AA0GZ;AACAgV,YAAQ,SAASA,MAAT,GAAkB;AACxB,UAAIzO,OAAO,IAAX;;AAEA,UAAIA,KAAKnJ,KAAT,EAAgB;AACdmJ,aAAK8D,QAAL,GAAgB,KAAhB;AACA9D,aAAKU,QAAL,CAAcG,WAAd,CAA0B,kBAA1B;AACD;AACF,KAlHW;;AAqHZ;AACA6N,aAAS,SAASA,OAAT,GAAmB;AAC1B,UAAI1O,OAAO,IAAX;;AAEA,UAAIA,KAAKnJ,KAAT,EAAgB;AACdmJ,aAAK8D,QAAL,GAAgB,IAAhB;AACA9D,aAAKU,QAAL,CAAcE,QAAd,CAAuB,kBAAvB;AACD;AACF,KA7HW;;AAgIZ;AACA+N,aAAS,SAASA,OAAT,GAAmB;AAC1B,UAAI3O,OAAO,IAAX;AACA,UAAIO,QAAQP,KAAKQ,QAAjB;;AAEA,UAAIR,KAAK4O,MAAT,EAAiB;AACf,YAAI5O,KAAKqO,KAAL,IAAcrO,KAAKwO,QAAvB,EAAiC;AAC/BjO,gBAAM+N,IAAN,CAAW,KAAX,EAAkBtO,KAAK6O,WAAvB;AACD;;AAED7O,aAAK8O,OAAL;AACAvO,cAAMM,WAAN,CAAkB,gBAAlB;AACD,OAPD,MAOO,IAAIb,KAAKqO,KAAT,EAAgB;AACrB9N,cAAM0G,GAAN,CAAU,MAAV,EAAkBjH,KAAKhC,KAAvB;AACD,OAFM,MAEA,IAAIgC,KAAKwD,MAAT,EAAiB;AACtBxD,aAAKwD,MAAL,CAAYuL,MAAZ;AACD;;AAEDxO,YAAMyE,UAAN,CAAiB,SAAjB;AACD,KAnJW;;AAsJZ;;;;;;AAMA8G,UAAM,SAASA,IAAT,CAAckD,OAAd,EAAuBC,OAAvB,EAAgC;AACpC,UAAIjP,OAAO,IAAX;AACA,UAAItD,SAASsD,KAAKtD,MAAlB;;AAEAsD,WAAKkP,MAAL,CAAYlX,YAAYgX,OAAZ,IAAuBA,OAAvB,GAAiCtS,OAAO8E,IAAP,GAAcP,OAAO+N,OAAP,CAA3D,EAA4EhX,YAAYiX,OAAZ,IAAuBA,OAAvB,GAAiCvS,OAAOgF,GAAP,GAAaT,OAAOgO,OAAP,CAA1H;AACD,KAjKW;;AAoKZ;;;;;;AAMAC,YAAQ,SAASA,MAAT,CAAgBxD,CAAhB,EAAmBC,CAAnB,EAAsB;AAC5B,UAAI3L,OAAO,IAAX;AACA,UAAItD,SAASsD,KAAKtD,MAAlB;AACA,UAAIyS,UAAU,KAAd;;AAEA;AACA,UAAInX,YAAY2T,CAAZ,CAAJ,EAAoB;AAClBA,YAAID,CAAJ;AACD;;AAEDA,UAAIzK,OAAOyK,CAAP,CAAJ;AACAC,UAAI1K,OAAO0K,CAAP,CAAJ;;AAEA,UAAI3L,KAAKnJ,KAAL,IAAc,CAACmJ,KAAK8D,QAApB,IAAgC9D,KAAK7E,OAAL,CAAatF,OAAjD,EAA0D;AACxD,YAAIgC,SAAS6T,CAAT,CAAJ,EAAiB;AACfhP,iBAAO8E,IAAP,GAAckK,CAAd;AACAyD,oBAAU,IAAV;AACD;;AAED,YAAItX,SAAS8T,CAAT,CAAJ,EAAiB;AACfjP,iBAAOgF,GAAP,GAAaiK,CAAb;AACAwD,oBAAU,IAAV;AACD;;AAED,YAAIA,OAAJ,EAAa;AACXnP,eAAKI,YAAL,CAAkB,IAAlB;AACD;AACF;AACF,KAtMW;;AAyMZ;;;;;;AAMAlJ,UAAM,SAASA,IAAT,CAAcmO,KAAd,EAAqB+J,MAArB,EAA6B;AACjC,UAAIpP,OAAO,IAAX;AACA,UAAItD,SAASsD,KAAKtD,MAAlB;;AAEA2I,cAAQpE,OAAOoE,KAAP,CAAR;;AAEA,UAAIA,QAAQ,CAAZ,EAAe;AACbA,gBAAQ,KAAK,IAAIA,KAAT,CAAR;AACD,OAFD,MAEO;AACLA,gBAAQ,IAAIA,KAAZ;AACD;;AAEDrF,WAAKqP,MAAL,CAAY3S,OAAO3B,KAAP,GAAesK,KAAf,GAAuB3I,OAAOlC,YAA1C,EAAwD4U,MAAxD;AACD,KA5NW;;AA+NZ;;;;;;AAMAC,YAAQ,SAASA,MAAT,CAAgBhK,KAAhB,EAAuB+J,MAAvB,EAA+B;AACrC,UAAIpP,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAI8N,WAAWjJ,KAAKiJ,QAApB;AACA,UAAIvM,SAASsD,KAAKtD,MAAlB;AACA,UAAI3B,QAAQ2B,OAAO3B,KAAnB;AACA,UAAIC,SAAS0B,OAAO1B,MAApB;AACA,UAAIR,eAAekC,OAAOlC,YAA1B;AACA,UAAIC,gBAAgBiC,OAAOjC,aAA3B;;AAEA4K,cAAQpE,OAAOoE,KAAP,CAAR;;AAEA,UAAIA,SAAS,CAAT,IAAcrF,KAAKnJ,KAAnB,IAA4B,CAACmJ,KAAK8D,QAAlC,IAA8C3I,QAAQnF,QAA1D,EAAoE;AAClE,YAAIuG,WAAW/B,eAAe6K,KAA9B;AACA,YAAI7I,YAAY/B,gBAAgB4K,KAAhC;AACA,YAAIoD,gBAAgB,KAAK,CAAzB;;AAEA,YAAI2G,MAAJ,EAAY;AACV3G,0BAAgB2G,OAAO3G,aAAvB;AACD;;AAED,YAAIzI,KAAKgE,OAAL,CAAa,MAAb,EAAqB;AACvByE,yBAAeA,aADQ;AAEvB6G,oBAAUvU,QAAQP,YAFK;AAGvB6K,iBAAO9I,WAAW/B;AAHK,SAArB,EAIDgP,kBAJC,EAAJ,EAIyB;AACvB;AACD;;AAED,YAAIf,aAAJ,EAAmB;AACjB,cAAItQ,SAAS6H,KAAKU,QAAL,CAAcvI,MAAd,EAAb;AACA,cAAI3C,SAASyT,YAAY7P,WAAW6P,QAAX,EAAqBpQ,MAAjC,GAA0CkV,kBAAkB9E,QAAlB,CAA1C,GAAwE;AACnF3B,mBAAO8H,OAAO9H,KAAP,IAAgBmB,cAAcnB,KAA9B,IAAuC,CADqC;AAEnFC,mBAAO6H,OAAO7H,KAAP,IAAgBkB,cAAclB,KAA9B,IAAuC;AAFqC,WAArF;;AAKA;AACA7K,iBAAO8E,IAAP,IAAe,CAACjF,WAAWxB,KAAZ,KAAsB,CAACvF,OAAO8R,KAAP,GAAenP,OAAOqJ,IAAtB,GAA6B9E,OAAO8E,IAArC,IAA6CzG,KAAnE,CAAf;AACA2B,iBAAOgF,GAAP,IAAc,CAAClF,YAAYxB,MAAb,KAAwB,CAACxF,OAAO+R,KAAP,GAAepP,OAAOuJ,GAAtB,GAA4BhF,OAAOgF,GAApC,IAA2C1G,MAAnE,CAAd;AACD,SAVD,MAUO;AACL;AACA0B,iBAAO8E,IAAP,IAAe,CAACjF,WAAWxB,KAAZ,IAAqB,CAApC;AACA2B,iBAAOgF,GAAP,IAAc,CAAClF,YAAYxB,MAAb,IAAuB,CAArC;AACD;;AAED0B,eAAO3B,KAAP,GAAewB,QAAf;AACAG,eAAO1B,MAAP,GAAgBwB,SAAhB;AACAwD,aAAKI,YAAL,CAAkB,IAAlB;AACD;AACF,KAtRW;;AAyRZ;;;;;AAKA7E,YAAQ,SAASA,MAAT,CAAgBS,MAAhB,EAAwB;AAC9B,UAAIgE,OAAO,IAAX;;AAEAA,WAAKuP,QAAL,CAAc,CAACvP,KAAK1F,KAAL,CAAWiB,MAAX,IAAqB,CAAtB,IAA2B0F,OAAOjF,MAAP,CAAzC;AACD,KAlSW;;AAqSZ;;;;;;AAMAuT,cAAU,SAASA,QAAT,CAAkBvT,MAAlB,EAA0B;AAClC,UAAIgE,OAAO,IAAX;;AAEAhE,eAASiF,OAAOjF,MAAP,CAAT;;AAEA,UAAInE,SAASmE,MAAT,KAAoBgE,KAAKnJ,KAAzB,IAAkC,CAACmJ,KAAK8D,QAAxC,IAAoD9D,KAAK7E,OAAL,CAAarF,SAArE,EAAgF;AAC9EkK,aAAK1F,KAAL,CAAWiB,MAAX,GAAoBS,SAAS,GAA7B;AACAgE,aAAK7C,OAAL,GAAe,IAAf;AACA6C,aAAKI,YAAL,CAAkB,IAAlB;AACD;AACF,KArTW;;AAwTZ;;;;;;;AAOA3C,WAAO,SAASA,KAAT,CAAejC,MAAf,EAAuBC,MAAvB,EAA+B;AACpC,UAAIuE,OAAO,IAAX;AACA,UAAI1F,QAAQ0F,KAAK1F,KAAjB;AACA,UAAI6U,UAAU,KAAd;;AAEA;AACA,UAAInX,YAAYyD,MAAZ,CAAJ,EAAyB;AACvBA,iBAASD,MAAT;AACD;;AAEDA,eAASyF,OAAOzF,MAAP,CAAT;AACAC,eAASwF,OAAOxF,MAAP,CAAT;;AAEA,UAAIuE,KAAKnJ,KAAL,IAAc,CAACmJ,KAAK8D,QAApB,IAAgC9D,KAAK7E,OAAL,CAAapF,QAAjD,EAA2D;AACzD,YAAI8B,SAAS2D,MAAT,CAAJ,EAAsB;AACpBlB,gBAAMkB,MAAN,GAAeA,MAAf;AACA2T,oBAAU,IAAV;AACD;;AAED,YAAItX,SAAS4D,MAAT,CAAJ,EAAsB;AACpBnB,gBAAMmB,MAAN,GAAeA,MAAf;AACA0T,oBAAU,IAAV;AACD;;AAED,YAAIA,OAAJ,EAAa;AACXnP,eAAKoD,WAAL,CAAiB,IAAjB;AACD;AACF;AACF,KA3VW;;AA8VZ;;;;;AAKA5H,YAAQ,SAASA,MAAT,CAAgBgU,OAAhB,EAAyB;AAC/B,UAAIxP,OAAO,IAAX;AACA,UAAIvE,SAASuE,KAAK1F,KAAL,CAAWmB,MAAxB;;AAEAuE,WAAKvC,KAAL,CAAW+R,OAAX,EAAoB3X,SAAS4D,MAAT,IAAmBA,MAAnB,GAA4B,CAAhD;AACD,KAxWW;;AA2WZ;;;;;AAKAA,YAAQ,SAASA,MAAT,CAAgBgU,OAAhB,EAAyB;AAC/B,UAAIzP,OAAO,IAAX;AACA,UAAIxE,SAASwE,KAAK1F,KAAL,CAAWkB,MAAxB;;AAEAwE,WAAKvC,KAAL,CAAW5F,SAAS2D,MAAT,IAAmBA,MAAnB,GAA4B,CAAvC,EAA0CiU,OAA1C;AACD,KArXW;;AAwXZ;;;;;;AAMAxL,aAAS,SAASA,OAAT,CAAiByL,SAAjB,EAA4B;AACnC,UAAI1P,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAIb,QAAQ0F,KAAK1F,KAAjB;AACA,UAAIoC,SAASsD,KAAKtD,MAAlB;AACA,UAAIwF,UAAUlC,KAAKkC,OAAnB;AACA,UAAImD,QAAQ,KAAK,CAAjB;AACA,UAAIrQ,OAAO,KAAK,CAAhB;;AAEA,UAAIgL,KAAKnJ,KAAL,IAAcmJ,KAAKK,OAAvB,EAAgC;AAC9BrL,eAAO;AACL0W,aAAGxJ,QAAQV,IAAR,GAAe9E,OAAO8E,IADpB;AAELmK,aAAGzJ,QAAQR,GAAR,GAAchF,OAAOgF,GAFnB;AAGL3G,iBAAOmH,QAAQnH,KAHV;AAILC,kBAAQkH,QAAQlH;AAJX,SAAP;;AAOAqK,gBAAQ/K,MAAMS,KAAN,GAAcT,MAAME,YAA5B;;AAEA9F,UAAE4E,IAAF,CAAOtE,IAAP,EAAa,UAAUkJ,CAAV,EAAapG,CAAb,EAAgB;AAC3BA,eAAKuN,KAAL;AACArQ,eAAKkJ,CAAL,IAAUwR,YAAY5T,KAAK6T,KAAL,CAAW7X,CAAX,CAAZ,GAA4BA,CAAtC;AACD,SAHD;AAID,OAdD,MAcO;AACL9C,eAAO;AACL0W,aAAG,CADE;AAELC,aAAG,CAFE;AAGL5Q,iBAAO,CAHF;AAILC,kBAAQ;AAJH,SAAP;AAMD;;AAED,UAAIG,QAAQrF,SAAZ,EAAuB;AACrBd,aAAKuG,MAAL,GAAcjB,MAAMiB,MAAN,IAAgB,CAA9B;AACD;;AAED,UAAIJ,QAAQpF,QAAZ,EAAsB;AACpBf,aAAKwG,MAAL,GAAclB,MAAMkB,MAAN,IAAgB,CAA9B;AACAxG,aAAKyG,MAAL,GAAcnB,MAAMmB,MAAN,IAAgB,CAA9B;AACD;;AAED,aAAOzG,IAAP;AACD,KAxaW;;AA2aZ;;;;;AAKA4a,aAAS,SAASA,OAAT,CAAiB5a,IAAjB,EAAuB;AAC9B,UAAIgL,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAIb,QAAQ0F,KAAK1F,KAAjB;AACA,UAAIoC,SAASsD,KAAKtD,MAAlB;AACA,UAAIqL,cAAc,EAAlB;AACA,UAAI5K,UAAU,KAAK,CAAnB;AACA,UAAI0S,WAAW,KAAK,CAApB;AACA,UAAIxK,QAAQ,KAAK,CAAjB;;AAEA,UAAI3Q,EAAE2R,UAAF,CAAarR,IAAb,CAAJ,EAAwB;AACtBA,eAAOA,KAAKwY,IAAL,CAAUxN,KAAK2E,OAAf,CAAP;AACD;;AAED,UAAI3E,KAAKnJ,KAAL,IAAc,CAACmJ,KAAK8D,QAApB,IAAgCpP,EAAEob,aAAF,CAAgB9a,IAAhB,CAApC,EAA2D;AACzD,YAAImG,QAAQrF,SAAZ,EAAuB;AACrB,cAAI+B,SAAS7C,KAAKuG,MAAd,KAAyBvG,KAAKuG,MAAL,KAAgBjB,MAAMiB,MAAnD,EAA2D;AACzDjB,kBAAMiB,MAAN,GAAevG,KAAKuG,MAApB;AACAyE,iBAAK7C,OAAL,GAAeA,UAAU,IAAzB;AACD;AACF;;AAED,YAAIhC,QAAQpF,QAAZ,EAAsB;AACpB,cAAI8B,SAAS7C,KAAKwG,MAAd,KAAyBxG,KAAKwG,MAAL,KAAgBlB,MAAMkB,MAAnD,EAA2D;AACzDlB,kBAAMkB,MAAN,GAAexG,KAAKwG,MAApB;AACAqU,uBAAW,IAAX;AACD;;AAED,cAAIhY,SAAS7C,KAAKyG,MAAd,KAAyBzG,KAAKyG,MAAL,KAAgBnB,MAAMmB,MAAnD,EAA2D;AACzDnB,kBAAMmB,MAAN,GAAezG,KAAKyG,MAApB;AACAoU,uBAAW,IAAX;AACD;AACF;;AAED,YAAI1S,OAAJ,EAAa;AACX6C,eAAKI,YAAL;AACD,SAFD,MAEO,IAAIyP,QAAJ,EAAc;AACnB7P,eAAKoD,WAAL;AACD;;AAEDiC,gBAAQ/K,MAAMS,KAAN,GAAcT,MAAME,YAA5B;;AAEA,YAAI3C,SAAS7C,KAAK0W,CAAd,CAAJ,EAAsB;AACpB3D,sBAAYvG,IAAZ,GAAmBxM,KAAK0W,CAAL,GAASrG,KAAT,GAAiB3I,OAAO8E,IAA3C;AACD;;AAED,YAAI3J,SAAS7C,KAAK2W,CAAd,CAAJ,EAAsB;AACpB5D,sBAAYrG,GAAZ,GAAkB1M,KAAK2W,CAAL,GAAStG,KAAT,GAAiB3I,OAAOgF,GAA1C;AACD;;AAED,YAAI7J,SAAS7C,KAAK+F,KAAd,CAAJ,EAA0B;AACxBgN,sBAAYhN,KAAZ,GAAoB/F,KAAK+F,KAAL,GAAasK,KAAjC;AACD;;AAED,YAAIxN,SAAS7C,KAAKgG,MAAd,CAAJ,EAA2B;AACzB+M,sBAAY/M,MAAZ,GAAqBhG,KAAKgG,MAAL,GAAcqK,KAAnC;AACD;;AAEDrF,aAAKmI,cAAL,CAAoBJ,WAApB;AACD;AACF,KA5eW;;AA+eZ;;;;;AAKAgI,sBAAkB,SAASA,gBAAT,GAA4B;AAC5C,aAAO,KAAKlZ,KAAL,GAAa,KAAKkK,SAAlB,GAA8B,EAArC;AACD,KAtfW;;AAyfZ;;;;;AAKAiP,kBAAc,SAASA,YAAT,GAAwB;AACpC,aAAO,KAAKpB,MAAL,GAAc,KAAKtU,KAAnB,GAA2B,EAAlC;AACD,KAhgBW;;AAmgBZ;;;;;AAKA0N,mBAAe,SAASA,aAAT,GAAyB;AACtC,UAAIhI,OAAO,IAAX;AACA,UAAItD,SAASsD,KAAKtD,MAAlB;AACA,UAAI1H,OAAO,EAAX;;AAEA,UAAIgL,KAAKnJ,KAAT,EAAgB;AACdnC,UAAE4E,IAAF,CAAO,CAAC,MAAD,EAAS,KAAT,EAAgB,OAAhB,EAAyB,QAAzB,EAAmC,cAAnC,EAAmD,eAAnD,CAAP,EAA4E,UAAU4E,CAAV,EAAapG,CAAb,EAAgB;AAC1F9C,eAAK8C,CAAL,IAAU4E,OAAO5E,CAAP,CAAV;AACD,SAFD;AAGD;;AAED,aAAO9C,IAAP;AACD,KAphBW;;AAuhBZ;;;;;AAKAkT,mBAAe,SAASA,aAAT,CAAuBlT,IAAvB,EAA6B;AAC1C,UAAIgL,OAAO,IAAX;AACA,UAAItD,SAASsD,KAAKtD,MAAlB;AACA,UAAI5H,cAAc4H,OAAO5H,WAAzB;;AAEA,UAAIJ,EAAE2R,UAAF,CAAarR,IAAb,CAAJ,EAAwB;AACtBA,eAAOA,KAAKwY,IAAL,CAAUxN,KAAKQ,QAAf,CAAP;AACD;;AAED,UAAIR,KAAKnJ,KAAL,IAAc,CAACmJ,KAAK8D,QAApB,IAAgCpP,EAAEob,aAAF,CAAgB9a,IAAhB,CAApC,EAA2D;AACzD,YAAI6C,SAAS7C,KAAKwM,IAAd,CAAJ,EAAyB;AACvB9E,iBAAO8E,IAAP,GAAcxM,KAAKwM,IAAnB;AACD;;AAED,YAAI3J,SAAS7C,KAAK0M,GAAd,CAAJ,EAAwB;AACtBhF,iBAAOgF,GAAP,GAAa1M,KAAK0M,GAAlB;AACD;;AAED,YAAI7J,SAAS7C,KAAK+F,KAAd,CAAJ,EAA0B;AACxB2B,iBAAO3B,KAAP,GAAe/F,KAAK+F,KAApB;AACA2B,iBAAO1B,MAAP,GAAgBhG,KAAK+F,KAAL,GAAajG,WAA7B;AACD,SAHD,MAGO,IAAI+C,SAAS7C,KAAKgG,MAAd,CAAJ,EAA2B;AAChC0B,iBAAO1B,MAAP,GAAgBhG,KAAKgG,MAArB;AACA0B,iBAAO3B,KAAP,GAAe/F,KAAKgG,MAAL,GAAclG,WAA7B;AACD;;AAEDkL,aAAKI,YAAL,CAAkB,IAAlB;AACD;AACF,KAxjBW;;AA2jBZ;;;;;AAKA6H,oBAAgB,SAASA,cAAT,GAA0B;AACxC,UAAIjI,OAAO,IAAX;AACA,UAAIkC,UAAUlC,KAAKkC,OAAnB;;AAEA,aAAOlC,KAAKnJ,KAAL,IAAcmJ,KAAKK,OAAnB,GAA6B;AAClCmB,cAAMU,QAAQV,IADoB;AAElCE,aAAKQ,QAAQR,GAFqB;AAGlC3G,eAAOmH,QAAQnH,KAHmB;AAIlCC,gBAAQkH,QAAQlH;AAJkB,OAA7B,GAKH,EALJ;AAMD,KA1kBW;;AA6kBZ;;;;;AAKAmN,oBAAgB,SAASA,cAAT,CAAwBnT,IAAxB,EAA8B;AAC5C,UAAIgL,OAAO,IAAX;AACA,UAAIkC,UAAUlC,KAAKkC,OAAnB;AACA,UAAIpN,cAAckL,KAAK7E,OAAL,CAAarG,WAA/B;AACA,UAAImb,eAAe,KAAK,CAAxB;AACA,UAAIC,gBAAgB,KAAK,CAAzB;;AAEA,UAAIxb,EAAE2R,UAAF,CAAarR,IAAb,CAAJ,EAAwB;AACtBA,eAAOA,KAAKwY,IAAL,CAAUxN,KAAKQ,QAAf,CAAP;AACD;;AAED,UAAIR,KAAKnJ,KAAL,IAAcmJ,KAAKK,OAAnB,IAA8B,CAACL,KAAK8D,QAApC,IAAgDpP,EAAEob,aAAF,CAAgB9a,IAAhB,CAApD,EAA2E;AACzE,YAAI6C,SAAS7C,KAAKwM,IAAd,CAAJ,EAAyB;AACvBU,kBAAQV,IAAR,GAAexM,KAAKwM,IAApB;AACD;;AAED,YAAI3J,SAAS7C,KAAK0M,GAAd,CAAJ,EAAwB;AACtBQ,kBAAQR,GAAR,GAAc1M,KAAK0M,GAAnB;AACD;;AAED,YAAI7J,SAAS7C,KAAK+F,KAAd,KAAwB/F,KAAK+F,KAAL,KAAemH,QAAQnH,KAAnD,EAA0D;AACxDkV,yBAAe,IAAf;AACA/N,kBAAQnH,KAAR,GAAgB/F,KAAK+F,KAArB;AACD;;AAED,YAAIlD,SAAS7C,KAAKgG,MAAd,KAAyBhG,KAAKgG,MAAL,KAAgBkH,QAAQlH,MAArD,EAA6D;AAC3DkV,0BAAgB,IAAhB;AACAhO,kBAAQlH,MAAR,GAAiBhG,KAAKgG,MAAtB;AACD;;AAED,YAAIlG,WAAJ,EAAiB;AACf,cAAImb,YAAJ,EAAkB;AAChB/N,oBAAQlH,MAAR,GAAiBkH,QAAQnH,KAAR,GAAgBjG,WAAjC;AACD,WAFD,MAEO,IAAIob,aAAJ,EAAmB;AACxBhO,oBAAQnH,KAAR,GAAgBmH,QAAQlH,MAAR,GAAiBlG,WAAjC;AACD;AACF;;AAEDkL,aAAKM,aAAL;AACD;AACF,KA1nBW;;AA6nBZ;;;;;;AAMA6P,sBAAkB,SAASA,gBAAT,CAA0BhV,OAA1B,EAAmC;AACnD,UAAI6E,OAAO,IAAX;;AAEA,UAAI,CAACA,KAAKnJ,KAAN,IAAe,CAACU,OAAO6Y,iBAA3B,EAA8C;AAC5C,eAAO,IAAP;AACD;;AAED,UAAI,CAAC1b,EAAEob,aAAF,CAAgB3U,OAAhB,CAAL,EAA+B;AAC7BA,kBAAU,EAAV;AACD;;AAED,UAAI,CAAC6E,KAAKK,OAAV,EAAmB;AACjB,eAAO5D,gBAAgBuD,KAAKwD,MAAL,CAAY,CAAZ,CAAhB,EAAgCxD,KAAK1F,KAArC,EAA4Ca,OAA5C,CAAP;AACD;;AAED,UAAInG,OAAOgL,KAAKiE,OAAL,EAAX;AACA,UAAIkB,gBAAgBnQ,KAAK+F,KAAzB;AACA,UAAIqK,iBAAiBpQ,KAAKgG,MAA1B;AACA,UAAIlG,cAAcqQ,gBAAgBC,cAAlC;AACA,UAAIiL,cAAc,KAAK,CAAvB;AACA,UAAIC,eAAe,KAAK,CAAxB;AACA,UAAIC,cAAc,KAAK,CAAvB;;AAEA,UAAI7b,EAAEob,aAAF,CAAgB3U,OAAhB,CAAJ,EAA8B;AAC5BkV,sBAAclV,QAAQJ,KAAtB;AACAuV,uBAAenV,QAAQH,MAAvB;;AAEA,YAAIqV,WAAJ,EAAiB;AACfC,yBAAeD,cAAcvb,WAA7B;AACAyb,wBAAcF,cAAclL,aAA5B;AACD,SAHD,MAGO,IAAImL,YAAJ,EAAkB;AACvBD,wBAAcC,eAAexb,WAA7B;AACAyb,wBAAcD,eAAelL,cAA7B;AACD;AACF;;AAED;AACA,UAAInI,cAAcnB,KAAK+B,KAAL,CAAWwS,eAAelL,aAA1B,CAAlB;AACA,UAAIjI,eAAepB,KAAK+B,KAAL,CAAWyS,gBAAgBlL,cAA3B,CAAnB;;AAEA,UAAI1I,SAAShI,EAAE,UAAF,EAAc,CAAd,CAAb;AACA,UAAIgE,UAAUgE,OAAOC,UAAP,CAAkB,IAAlB,CAAd;;AAEAD,aAAO3B,KAAP,GAAekC,WAAf;AACAP,aAAO1B,MAAP,GAAgBkC,YAAhB;;AAEA,UAAI/B,QAAQiC,SAAZ,EAAuB;AACrB1E,gBAAQ2E,SAAR,GAAoBlC,QAAQiC,SAA5B;AACA1E,gBAAQ4E,QAAR,CAAiB,CAAjB,EAAoB,CAApB,EAAuBL,WAAvB,EAAoCC,YAApC;AACD;;AAED;AACA,UAAIsT,aAAa,YAAY;AAC3B,YAAIC,SAAShU,gBAAgBuD,KAAKwD,MAAL,CAAY,CAAZ,CAAhB,EAAgCxD,KAAK1F,KAArC,EAA4Ca,OAA5C,CAAb;AACA,YAAIuV,cAAcD,OAAO1V,KAAzB;AACA,YAAI4V,eAAeF,OAAOzV,MAA1B;AACA,YAAI8M,aAAa9H,KAAKtD,MAAtB;AACA,YAAIkU,SAAS,CAACH,MAAD,CAAb;;AAEA;AACA,YAAII,OAAO7b,KAAK0W,CAAL,GAAS5D,WAAWtN,YAAX,IAA2BsB,KAAKC,GAAL,CAAS/G,KAAKwG,MAAL,IAAe,CAAxB,IAA6B,CAAxD,IAA6D,CAAjF;AACA,YAAIsV,OAAO9b,KAAK2W,CAAL,GAAS7D,WAAWrN,aAAX,IAA4BqB,KAAKC,GAAL,CAAS/G,KAAKyG,MAAL,IAAe,CAAxB,IAA6B,CAAzD,IAA8D,CAAlF;AACA,YAAIsV,WAAW,KAAK,CAApB;AACA,YAAIC,YAAY,KAAK,CAArB;;AAEA;AACA,YAAIpU,OAAO,KAAK,CAAhB;AACA,YAAIC,OAAO,KAAK,CAAhB;AACA,YAAIC,WAAW,KAAK,CAApB;AACA,YAAIC,YAAY,KAAK,CAArB;;AAEA,YAAI8T,QAAQ,CAAC1L,aAAT,IAA0B0L,OAAOH,WAArC,EAAkD;AAChDG,iBAAOE,WAAWnU,OAAOE,WAAW,CAApC;AACD,SAFD,MAEO,IAAI+T,QAAQ,CAAZ,EAAe;AACpBjU,iBAAO,CAACiU,IAAR;AACAA,iBAAO,CAAP;AACAE,qBAAWjU,WAAWhB,KAAK6G,GAAL,CAAS+N,WAAT,EAAsBvL,gBAAgB0L,IAAtC,CAAtB;AACD,SAJM,MAIA,IAAIA,QAAQH,WAAZ,EAAyB;AAC9B9T,iBAAO,CAAP;AACAmU,qBAAWjU,WAAWhB,KAAK6G,GAAL,CAASwC,aAAT,EAAwBuL,cAAcG,IAAtC,CAAtB;AACD;;AAED,YAAIE,YAAY,CAAZ,IAAiBD,QAAQ,CAAC1L,cAA1B,IAA4C0L,OAAOH,YAAvD,EAAqE;AACnEG,iBAAOE,YAAYnU,OAAOE,YAAY,CAAtC;AACD,SAFD,MAEO,IAAI+T,QAAQ,CAAZ,EAAe;AACpBjU,iBAAO,CAACiU,IAAR;AACAA,iBAAO,CAAP;AACAE,sBAAYjU,YAAYjB,KAAK6G,GAAL,CAASgO,YAAT,EAAuBvL,iBAAiB0L,IAAxC,CAAxB;AACD,SAJM,MAIA,IAAIA,QAAQH,YAAZ,EAA0B;AAC/B9T,iBAAO,CAAP;AACAmU,sBAAYjU,YAAYjB,KAAK6G,GAAL,CAASyC,cAAT,EAAyBuL,eAAeG,IAAxC,CAAxB;AACD;;AAED;AACAF,eAAOvY,IAAP,CAAYyD,KAAK+B,KAAL,CAAWgT,IAAX,CAAZ,EAA8B/U,KAAK+B,KAAL,CAAWiT,IAAX,CAA9B,EAAgDhV,KAAK+B,KAAL,CAAWkT,QAAX,CAAhD,EAAsEjV,KAAK+B,KAAL,CAAWmT,SAAX,CAAtE;;AAEA;AACA,YAAIT,WAAJ,EAAiB;AACf3T,kBAAQ2T,WAAR;AACA1T,kBAAQ0T,WAAR;AACAzT,sBAAYyT,WAAZ;AACAxT,uBAAawT,WAAb;AACD;;AAED;AACA,YAAIzT,WAAW,CAAX,IAAgBC,YAAY,CAAhC,EAAmC;AACjC6T,iBAAOvY,IAAP,CAAYyD,KAAK+B,KAAL,CAAWjB,IAAX,CAAZ,EAA8Bd,KAAK+B,KAAL,CAAWhB,IAAX,CAA9B,EAAgDf,KAAK+B,KAAL,CAAWf,QAAX,CAAhD,EAAsEhB,KAAK+B,KAAL,CAAWd,SAAX,CAAtE;AACD;;AAED,eAAO6T,MAAP;AACD,OA1DgB,EAAjB;;AA4DAlY,cAAQgF,qBAAR,GAAgC,CAAC,CAACvC,QAAQuC,qBAA1C;;AAEA,UAAIvC,QAAQwC,qBAAZ,EAAmC;AACjCjF,gBAAQiF,qBAAR,GAAgCxC,QAAQwC,qBAAxC;AACD;;AAEDjF,cAAQkF,SAAR,CAAkBrF,KAAlB,CAAwBG,OAAxB,EAAiCiV,kBAAkB6C,UAAlB,CAAjC;;AAEA,aAAO9T,MAAP;AACD,KA5vBW;;AA+vBZ;;;;;AAKAuU,oBAAgB,SAASA,cAAT,CAAwBnc,WAAxB,EAAqC;AACnD,UAAIkL,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;;AAEA,UAAI,CAAC6E,KAAK8D,QAAN,IAAkB,CAAC9L,YAAYlD,WAAZ,CAAvB,EAAiD;AAC/C;AACAqG,gBAAQrG,WAAR,GAAsBgH,KAAKkF,GAAL,CAAS,CAAT,EAAYlM,WAAZ,KAA4BC,GAAlD;;AAEA,YAAIiL,KAAKnJ,KAAT,EAAgB;AACdmJ,eAAKG,WAAL;;AAEA,cAAIH,KAAKK,OAAT,EAAkB;AAChBL,iBAAKM,aAAL;AACD;AACF;AACF;AACF,KApxBW;;AAuxBZ;;;;;AAKA8H,iBAAa,SAASA,WAAT,CAAqB8I,IAArB,EAA2B;AACtC,UAAIlR,OAAO,IAAX;AACA,UAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,UAAIgW,YAAY,KAAK,CAArB;AACA,UAAItb,UAAU,KAAK,CAAnB;;AAEA,UAAImK,KAAK4O,MAAL,IAAe,CAAC5O,KAAK8D,QAAzB,EAAmC;AACjCqN,oBAAYD,SAAS,MAArB;AACArb,kBAAUsF,QAAQtF,OAAR,IAAmBqb,SAAS,MAAtC;AACAA,eAAOC,aAAatb,OAAb,GAAuBqb,IAAvB,GAA8B,MAArC;;AAEAlR,aAAKqI,QAAL,CAAcrT,IAAd,CAAmB,QAAnB,EAA6Bkc,IAA7B,EAAmCvH,WAAnC,CAA+C,cAA/C,EAA+DwH,SAA/D,EAA0ExH,WAA1E,CAAsF,cAAtF,EAAsG9T,OAAtG;;AAEA,YAAI,CAACsF,QAAQ/E,cAAb,EAA6B;AAC3B;AACA4J,eAAK4D,KAAL,CAAW5O,IAAX,CAAgB,QAAhB,EAA0Bkc,IAA1B,EAAgCvH,WAAhC,CAA4C,cAA5C,EAA4DwH,SAA5D,EAAuExH,WAAvE,CAAmF,cAAnF,EAAmG9T,OAAnG;AACD;AACF;AACF;AA9yBW,GAAd;;AAizBA,MAAIub,eAAe,gBAAnB;AACA,MAAIC,kBAAkB,QAAtB;AACA,MAAIC,uBAAuB,2BAA3B;;AAEA,MAAIC,UAAU,YAAY;AACxB,aAASA,OAAT,CAAiB5M,OAAjB,EAA0BxJ,OAA1B,EAAmC;AACjC6Q,qBAAe,IAAf,EAAqBuF,OAArB;;AAEA,UAAIvR,OAAO,IAAX;;AAEAA,WAAKQ,QAAL,GAAgB9L,EAAEiQ,OAAF,CAAhB;AACA3E,WAAK7E,OAAL,GAAezG,EAAEoN,MAAF,CAAS,EAAT,EAAanN,QAAb,EAAuBD,EAAEob,aAAF,CAAgB3U,OAAhB,KAA4BA,OAAnD,CAAf;AACA6E,WAAK4O,MAAL,GAAc,KAAd;AACA5O,WAAKnJ,KAAL,GAAa,KAAb;AACAmJ,WAAK+D,SAAL,GAAiB,KAAjB;AACA/D,WAAK7C,OAAL,GAAe,KAAf;AACA6C,WAAKK,OAAL,GAAe,KAAf;AACAL,WAAK8D,QAAL,GAAgB,KAAhB;AACA9D,WAAKwO,QAAL,GAAgB,KAAhB;AACAxO,WAAK2B,OAAL,GAAe,KAAf;AACA3B,WAAK2I,QAAL,GAAgB,KAAhB;AACA3I,WAAKqO,KAAL,GAAa,KAAb;AACArO,WAAK6O,WAAL,GAAmB,EAAnB;AACA7O,WAAKtD,MAAL,GAAc,IAAd;AACAsD,WAAKkC,OAAL,GAAe,IAAf;AACAlC,WAAKiJ,QAAL,GAAgB,EAAhB;AACAjJ,WAAKwR,IAAL;AACD;;AAEDpF,gBAAYmF,OAAZ,EAAqB,CAAC;AACpBhY,WAAK,MADe;AAEpB+T,aAAO,SAASkE,IAAT,GAAgB;AACrB,YAAIxR,OAAO,IAAX;AACA,YAAIO,QAAQP,KAAKQ,QAAjB;AACA,YAAI/G,MAAM,KAAK,CAAf;;AAEA,YAAI8G,MAAMkR,EAAN,CAAS,KAAT,CAAJ,EAAqB;AACnBzR,eAAKqO,KAAL,GAAa,IAAb;;AAEA;AACArO,eAAK6O,WAAL,GAAmBpV,MAAM8G,MAAM+N,IAAN,CAAW,KAAX,CAAzB;;AAEA;AACA,cAAI,CAAC7U,GAAL,EAAU;AACR;AACD;;AAED;AACAA,gBAAM8G,MAAMmR,IAAN,CAAW,KAAX,CAAN;AACD,SAbD,MAaO,IAAInR,MAAMkR,EAAN,CAAS,QAAT,KAAsBla,OAAO6Y,iBAAjC,EAAoD;AACzD3W,gBAAM8G,MAAM,CAAN,EAASoR,SAAT,EAAN;AACD;;AAED3R,aAAKlF,IAAL,CAAUrB,GAAV;AACD;;AAED;;AA3BoB,KAAD,EA6BlB;AACDF,WAAK,SADJ;AAED+T,aAAO,SAAStJ,OAAT,CAAiB4N,IAAjB,EAAuB5c,IAAvB,EAA6B;AAClC,YAAIwT,IAAI9T,EAAEmd,KAAF,CAAQD,IAAR,EAAc5c,IAAd,CAAR;;AAEA,aAAKwL,QAAL,CAAcwD,OAAd,CAAsBwE,CAAtB;;AAEA,eAAOA,CAAP;AACD;AARA,KA7BkB,EAsClB;AACDjP,WAAK,MADJ;AAED+T,aAAO,SAASxS,IAAT,CAAcrB,GAAd,EAAmB;AACxB,YAAIuG,OAAO,IAAX;AACA,YAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,YAAIoF,QAAQP,KAAKQ,QAAjB;;AAEA,YAAI,CAAC/G,GAAL,EAAU;AACR;AACD;;AAEDuG,aAAKvG,GAAL,GAAWA,GAAX;AACAuG,aAAK1F,KAAL,GAAa,EAAb;;AAEA,YAAI,CAACa,QAAQ9F,gBAAT,IAA6B,CAACkC,OAAOkI,WAAzC,EAAsD;AACpDO,eAAK8R,KAAL;AACA;AACD;;AAED;AACA,YAAIT,gBAAgB5Z,IAAhB,CAAqBgC,GAArB,CAAJ,EAA+B;AAC7B,cAAI6X,qBAAqB7Z,IAArB,CAA0BgC,GAA1B,CAAJ,EAAoC;AAClCuG,iBAAK+R,IAAL,CAAU5S,qBAAqB1F,GAArB,CAAV;AACD,WAFD,MAEO;AACLuG,iBAAK8R,KAAL;AACD;AACD;AACD;;AAED,YAAIE,MAAM,IAAIC,cAAJ,EAAV;;AAEAD,YAAIE,OAAJ,GAAcF,IAAIG,OAAJ,GAAczd,EAAE8D,KAAF,CAAQ,YAAY;AAC9CwH,eAAK8R,KAAL;AACD,SAF2B,EAEzB,IAFyB,CAA5B;;AAIAE,YAAInX,MAAJ,GAAa,SAASC,IAAT,GAAgB;AAC3BkF,eAAK+R,IAAL,CAAU,KAAKK,QAAf;AACD,SAFD;;AAIA,YAAIjX,QAAQ/F,gBAAR,IAA4BoE,iBAAiBC,GAAjB,CAA5B,IAAqD8G,MAAMmR,IAAN,CAAW,aAAX,CAAzD,EAAoF;AAClFjY,gBAAMO,aAAaP,GAAb,CAAN;AACD;;AAEDuY,YAAIK,IAAJ,CAAS,KAAT,EAAgB5Y,GAAhB;AACAuY,YAAIM,YAAJ,GAAmB,aAAnB;AACAN,YAAIO,eAAJ,GAAsBhS,MAAMmR,IAAN,CAAW,aAAX,MAA8B,iBAApD;AACAM,YAAIQ,IAAJ;AACD;AA/CA,KAtCkB,EAsFlB;AACDjZ,WAAK,MADJ;AAED+T,aAAO,SAASyE,IAAT,CAAc1T,WAAd,EAA2B;AAChC,YAAI2B,OAAO,IAAX;AACA,YAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,YAAIqD,cAAcJ,eAAeC,WAAf,CAAlB;AACA,YAAI/D,QAAQ0F,KAAK1F,KAAjB;AACA,YAAIiB,SAAS,CAAb;AACA,YAAIC,SAAS,CAAb;AACA,YAAIC,SAAS,CAAb;;AAEA,YAAI+C,cAAc,CAAlB,EAAqB;AACnBwB,eAAKvG,GAAL,GAAWmG,qBAAqBvB,WAArB,CAAX;;AAEA,kBAAQG,WAAR;;AAEE;AACA,iBAAK,CAAL;AACEhD,uBAAS,CAAC,CAAV;AACA;;AAEF;AACA,iBAAK,CAAL;AACED,uBAAS,CAAC,GAAV;AACA;;AAEF;AACA,iBAAK,CAAL;AACEE,uBAAS,CAAC,CAAV;AACA;;AAEF;AACA,iBAAK,CAAL;AACEF,uBAAS,EAAT;AACAE,uBAAS,CAAC,CAAV;AACA;;AAEF;AACA,iBAAK,CAAL;AACEF,uBAAS,EAAT;AACA;;AAEF;AACA,iBAAK,CAAL;AACEA,uBAAS,EAAT;AACAC,uBAAS,CAAC,CAAV;AACA;;AAEF;AACA,iBAAK,CAAL;AACED,uBAAS,CAAC,EAAV;AACA;AArCJ;AAuCD;;AAED,YAAIJ,QAAQrF,SAAZ,EAAuB;AACrBwE,gBAAMiB,MAAN,GAAeA,MAAf;AACD;;AAED,YAAIJ,QAAQpF,QAAZ,EAAsB;AACpBuE,gBAAMkB,MAAN,GAAeA,MAAf;AACAlB,gBAAMmB,MAAN,GAAeA,MAAf;AACD;;AAEDuE,aAAK8R,KAAL;AACD;AAjEA,KAtFkB,EAwJlB;AACDvY,WAAK,OADJ;AAED+T,aAAO,SAASwE,KAAT,GAAiB;AACtB,YAAI9R,OAAO,IAAX;AACA,YAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,YAAIoF,QAAQP,KAAKQ,QAAjB;AACA,YAAI/G,MAAMuG,KAAKvG,GAAf;AACA,YAAI4K,cAAc,EAAlB;AACA,YAAIC,iBAAiB,KAAK,CAA1B;;AAEA,YAAInJ,QAAQ/F,gBAAR,IAA4BoE,iBAAiBC,GAAjB,CAAhC,EAAuD;AACrD4K,wBAAc9D,MAAMmR,IAAN,CAAW,aAAX,CAAd;;AAEA,cAAIrN,WAAJ,EAAiB;AACfC,6BAAiB7K,GAAjB;AACD,WAFD,MAEO;AACL4K,0BAAc,WAAd;;AAEA;AACAC,6BAAiBtK,aAAaP,GAAb,CAAjB;AACD;AACF;;AAEDuG,aAAKqE,WAAL,GAAmBA,WAAnB;AACArE,aAAKsE,cAAL,GAAsBA,cAAtB;;AAEA,YAAIhK,QAAQK,SAASC,aAAT,CAAuB,KAAvB,CAAZ;;AAEA,YAAIyJ,WAAJ,EAAiB;AACf/J,gBAAM+J,WAAN,GAAoBA,WAApB;AACD;;AAED/J,cAAMW,GAAN,GAAYqJ,kBAAkB7K,GAA9B;;AAEA,YAAI+J,SAAS9O,EAAE4F,KAAF,CAAb;;AAEA0F,aAAKwD,MAAL,GAAcA,MAAd;;AAEA,YAAIxD,KAAKqO,KAAT,EAAgB;AACd,cAAI9N,MAAM,CAAN,EAASkS,QAAb,EAAuB;AACrBzS,iBAAKhC,KAAL;AACD,WAFD,MAEO;AACLuC,kBAAMmS,GAAN,CAAU,MAAV,EAAkBhe,EAAE8D,KAAF,CAAQwH,KAAKhC,KAAb,EAAoB,IAApB,CAAlB;AACD;AACF,SAND,MAMO;AACLwF,iBAAOkP,GAAP,CAAW,MAAX,EAAmBhe,EAAE8D,KAAF,CAAQwH,KAAKhC,KAAb,EAAoB,IAApB,CAAnB,EAA8C0U,GAA9C,CAAkD,OAAlD,EAA2Dhe,EAAE8D,KAAF,CAAQwH,KAAK2S,IAAb,EAAmB,IAAnB,CAA3D,EAAqF/R,QAArF,CAA8F,cAA9F,EAA8GgS,WAA9G,CAA0HrS,KAA1H;AACD;AACF;AA/CA,KAxJkB,EAwMlB;AACDhH,WAAK,OADJ;AAED+T,aAAO,SAAStP,KAAT,GAAiB;AACtB,YAAIgC,OAAO,IAAX;AACA,YAAIwD,SAASxD,KAAKwD,MAAlB;AACA,YAAIqP,SAAS7S,KAAKQ,QAAlB;;AAEA,YAAI,CAACR,KAAKqO,KAAV,EAAiB;AACf7K,iBAAOyD,GAAP,CAAW,OAAX,EAAoBjH,KAAK2S,IAAzB;AACAE,mBAASrP,MAAT;AACD;;AAEDnJ,qBAAawY,OAAO,CAAP,CAAb,EAAwB,UAAUrY,YAAV,EAAwBC,aAAxB,EAAuC;AAC7D/F,YAAEoN,MAAF,CAAS9B,KAAK1F,KAAd,EAAqB;AACnBE,0BAAcA,YADK;AAEnBC,2BAAeA,aAFI;AAGnB3F,yBAAa0F,eAAeC;AAHT,WAArB;;AAMAuF,eAAK4O,MAAL,GAAc,IAAd;AACA5O,eAAK8S,KAAL;AACD,SATD;AAUD;AAtBA,KAxMkB,EA+NlB;AACDvZ,WAAK,MADJ;AAED+T,aAAO,SAASqF,IAAT,GAAgB;AACrB,YAAI3S,OAAO,IAAX;;AAEAA,aAAKwD,MAAL,CAAYuL,MAAZ;AACA/O,aAAKwD,MAAL,GAAc,IAAd;AACD;AAPA,KA/NkB,EAuOlB;AACDjK,WAAK,OADJ;AAED+T,aAAO,SAASwF,KAAT,GAAiB;AACtB,YAAI9S,OAAO,IAAX;AACA,YAAI7E,UAAU6E,KAAK7E,OAAnB;AACA,YAAIoF,QAAQP,KAAKQ,QAAjB;AACA,YAAIgD,SAASxD,KAAKwD,MAAlB;AACA,YAAI9C,WAAW,KAAK,CAApB;AACA,YAAImD,WAAW,KAAK,CAApB;AACA,YAAID,QAAQ,KAAK,CAAjB;;AAEA,YAAI,CAAC5D,KAAK4O,MAAV,EAAkB;AAChB;AACD;;AAED;AACA,YAAI5O,KAAKnJ,KAAT,EAAgB;AACdmJ,eAAK8O,OAAL;AACD;;AAED;AACA9O,aAAKS,UAAL,GAAkBF,MAAM8M,MAAN,EAAlB;AACArN,aAAKU,QAAL,GAAgBA,WAAWhM,EAAEyC,QAAF,CAA3B;AACA6I,aAAKkD,OAAL,GAAexC,SAAS4E,IAAT,CAAc,iBAAd,EAAiCyN,MAAjC,CAAwCvP,MAAxC,CAAf;AACAxD,aAAKqI,QAAL,GAAgB3H,SAAS4E,IAAT,CAAc,mBAAd,CAAhB;AACAtF,aAAK6D,QAAL,GAAgBA,WAAWnD,SAAS4E,IAAT,CAAc,mBAAd,CAA3B;AACAtF,aAAKyE,QAAL,GAAgB/D,SAAS4E,IAAT,CAAc,mBAAd,CAAhB;AACAtF,aAAK4D,KAAL,GAAaA,QAAQC,SAASyB,IAAT,CAAc,eAAd,CAArB;;AAEA;AACA/E,cAAMK,QAAN,CAAewQ,YAAf,EAA6B4B,KAA7B,CAAmCtS,QAAnC;;AAEA;AACA,YAAI,CAACV,KAAKqO,KAAV,EAAiB;AACf7K,iBAAO3C,WAAP,CAAmB,cAAnB;AACD;;AAEDb,aAAKoE,WAAL;AACApE,aAAKoG,IAAL;;AAEAjL,gBAAQrG,WAAR,GAAsBgH,KAAKkF,GAAL,CAAS,CAAT,EAAY7F,QAAQrG,WAApB,KAAoCC,GAA1D;AACAoG,gBAAQvG,QAAR,GAAmBkH,KAAKkF,GAAL,CAAS,CAAT,EAAYlF,KAAK6G,GAAL,CAAS,CAAT,EAAY7G,KAAK6T,KAAL,CAAWxU,QAAQvG,QAAnB,CAAZ,CAAZ,KAA0D,CAA7E;;AAEAoL,aAAKK,OAAL,GAAelF,QAAQxF,QAAvB;;AAEA,YAAIwF,QAAQxF,QAAZ,EAAsB;AACpB,cAAIwF,QAAQ7F,KAAZ,EAAmB;AACjB0K,iBAAKqI,QAAL,CAAczH,QAAd,CAAuB,eAAvB;AACD;AACF,SAJD,MAIO;AACLiD,mBAASjD,QAAT,CAAkBwQ,YAAlB;AACD;;AAED,YAAI,CAACjW,QAAQ5F,MAAb,EAAqB;AACnBsO,mBAASyB,IAAT,CAAc,iBAAd,EAAiC1E,QAAjC,CAA0CwQ,YAA1C;AACD;;AAED,YAAI,CAACjW,QAAQ3F,MAAb,EAAqB;AACnBqO,mBAASyB,IAAT,CAAc,iBAAd,EAAiC1E,QAAjC,CAA0CwQ,YAA1C;AACD;;AAED,YAAIjW,QAAQ/E,cAAZ,EAA4B;AAC1BwN,gBAAMhD,QAAN,CAAe,cAAf,EAA+B5L,IAA/B,CAAoC,QAApC,EAA8C,KAA9C;AACD;;AAED,YAAI,CAACmG,QAAQ1F,SAAb,EAAwB;AACtBmO,gBAAMhD,QAAN,CAAe,mBAAf;AACD;;AAED,YAAIzF,QAAQzF,UAAZ,EAAwB;AACtBgL,mBAASE,QAAT,CAAkB,YAAlB;AACD;;AAED,YAAI,CAACzF,QAAQ9E,gBAAb,EAA+B;AAC7BwN,mBAASyB,IAAT,CAAc,+BAAd,EAA+C1E,QAA/C,CAAwDwQ,YAAxD;AACD;;AAEDpR,aAAKoI,WAAL,CAAiBjN,QAAQtG,QAAzB;AACAmL,aAAKD,MAAL;AACAC,aAAKnJ,KAAL,GAAa,IAAb;AACAmJ,aAAK4P,OAAL,CAAazU,QAAQnG,IAArB;;AAEA;AACAgL,aAAKiT,UAAL,GAAkBrK,WAAW,YAAY;AACvC,cAAIlU,EAAE2R,UAAF,CAAalL,QAAQtE,KAArB,CAAJ,EAAiC;AAC/B0J,kBAAMmS,GAAN,CAAU,OAAV,EAAmBvX,QAAQtE,KAA3B;AACD;;AAEDmJ,eAAKgE,OAAL,CAAa,OAAb;AACAhE,eAAKgE,OAAL,CAAa,MAAb,EAAqBhE,KAAKiE,OAAL,EAArB;AACAjE,eAAK+D,SAAL,GAAiB,IAAjB;AACD,SARiB,EAQf,CARe,CAAlB;AASD;AA5FA,KAvOkB,EAoUlB;AACDxK,WAAK,SADJ;AAED+T,aAAO,SAASwB,OAAT,GAAmB;AACxB,YAAI9O,OAAO,IAAX;;AAEA,YAAI,CAACA,KAAKnJ,KAAV,EAAiB;AACf;AACD;;AAED,YAAI,CAACmJ,KAAK+D,SAAV,EAAqB;AACnBmP,uBAAalT,KAAKiT,UAAlB;AACD;;AAEDjT,aAAKnJ,KAAL,GAAa,KAAb;AACAmJ,aAAK+D,SAAL,GAAiB,KAAjB;AACA/D,aAAK6B,YAAL,GAAoB,IAApB;;AAEA;AACA7B,aAAK+B,aAAL,GAAqB,IAArB;AACA/B,aAAKyD,cAAL,GAAsB,IAAtB;AACAzD,aAAKe,SAAL,GAAiB,IAAjB;AACAf,aAAKtD,MAAL,GAAc,IAAd;;AAEA;AACAsD,aAAKkC,OAAL,GAAe,IAAf;AACAlC,aAAKgH,MAAL;;AAEAhH,aAAK+E,YAAL;AACA/E,aAAKwE,QAAL,GAAgB,IAAhB;;AAEAxE,aAAKyE,QAAL,GAAgB,IAAhB;AACAzE,aAAK6D,QAAL,GAAgB,IAAhB;AACA7D,aAAKqI,QAAL,GAAgB,IAAhB;AACArI,aAAKkD,OAAL,GAAe,IAAf;AACAlD,aAAKS,UAAL,GAAkB,IAAlB;;AAEAT,aAAKU,QAAL,CAAcqO,MAAd;AACA/O,aAAKU,QAAL,GAAgB,IAAhB;AACD;AAtCA,KApUkB,CAArB,EA2WI,CAAC;AACHnH,WAAK,aADF;AAEH+T,aAAO,SAAS6F,WAAT,CAAqBhY,OAArB,EAA8B;AACnCzG,UAAEoN,MAAF,CAASnN,QAAT,EAAmBD,EAAEob,aAAF,CAAgB3U,OAAhB,KAA4BA,OAA/C;AACD;AAJE,KAAD,CA3WJ;AAiXA,WAAOoW,OAAP;AACD,GA3Ya,EAAd;;AA6YA7c,IAAEoN,MAAF,CAASyP,QAAQ1E,SAAjB,EAA4B/M,QAA5B;AACApL,IAAEoN,MAAF,CAASyP,QAAQ1E,SAAjB,EAA4B1I,SAA5B;AACAzP,IAAEoN,MAAF,CAASyP,QAAQ1E,SAAjB,EAA4B1G,MAA5B;AACAzR,IAAEoN,MAAF,CAASyP,QAAQ1E,SAAjB,EAA4BhF,QAA5B;AACAnT,IAAEoN,MAAF,CAASyP,QAAQ1E,SAAjB,EAA4BzB,QAA5B;AACA1W,IAAEoN,MAAF,CAASyP,QAAQ1E,SAAjB,EAA4BoB,OAA5B;;AAEA,MAAImF,YAAY,SAAhB;AACA,MAAIC,eAAe3e,EAAE+D,EAAF,CAAK6a,OAAxB;;AAEA5e,IAAE+D,EAAF,CAAK6a,OAAL,GAAe,SAASC,aAAT,CAAuBC,MAAvB,EAA+B;AAC5C,SAAK,IAAI7a,OAAOC,UAAUC,MAArB,EAA6BT,OAAOU,MAAMH,OAAO,CAAP,GAAWA,OAAO,CAAlB,GAAsB,CAA5B,CAApC,EAAoEI,OAAO,CAAhF,EAAmFA,OAAOJ,IAA1F,EAAgGI,MAAhG,EAAwG;AACtGX,WAAKW,OAAO,CAAZ,IAAiBH,UAAUG,IAAV,CAAjB;AACD;;AAED,QAAI0a,SAAS,KAAK,CAAlB;;AAEA,SAAKna,IAAL,CAAU,UAAU4E,CAAV,EAAayG,OAAb,EAAsB;AAC9B,UAAIpE,QAAQ7L,EAAEiQ,OAAF,CAAZ;AACA,UAAI3P,OAAOuL,MAAMvL,IAAN,CAAWoe,SAAX,CAAX;;AAEA,UAAI,CAACpe,IAAL,EAAW;AACT,YAAI,UAAUyC,IAAV,CAAe+b,MAAf,CAAJ,EAA4B;AAC1B;AACD;;AAED,YAAIrY,UAAUzG,EAAEoN,MAAF,CAAS,EAAT,EAAavB,MAAMvL,IAAN,EAAb,EAA2BN,EAAEob,aAAF,CAAgB0D,MAAhB,KAA2BA,MAAtD,CAAd;AACAjT,cAAMvL,IAAN,CAAWoe,SAAX,EAAsBpe,OAAO,IAAIuc,OAAJ,CAAY5M,OAAZ,EAAqBxJ,OAArB,CAA7B;AACD;;AAED,UAAI,OAAOqY,MAAP,KAAkB,QAAtB,EAAgC;AAC9B,YAAI/a,KAAKzD,KAAKwe,MAAL,CAAT;;AAEA,YAAI9e,EAAE2R,UAAF,CAAa5N,EAAb,CAAJ,EAAsB;AACpBgb,mBAAShb,GAAGF,KAAH,CAASvD,IAAT,EAAeoD,IAAf,CAAT;AACD;AACF;AACF,KApBD;;AAsBA,WAAO,OAAOqb,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IAAhD;AACD,GA9BD;;AAgCA/e,IAAE+D,EAAF,CAAK6a,OAAL,CAAapH,WAAb,GAA2BqF,OAA3B;AACA7c,IAAE+D,EAAF,CAAK6a,OAAL,CAAaH,WAAb,GAA2B5B,QAAQ4B,WAAnC;;AAEA;AACAze,IAAE+D,EAAF,CAAK6a,OAAL,CAAaI,UAAb,GAA0B,SAASA,UAAT,GAAsB;AAC9Chf,MAAE+D,EAAF,CAAK6a,OAAL,GAAeD,YAAf;AACA,WAAO,IAAP;AACD,GAHD;AAKC,CA5lGA,CAAD","file":"cropper.js","sourcesContent":["/*!\n * Cropper v3.0.0-rc.3\n * https://github.com/fengyuanchen/cropper\n *\n * Copyright (c) 2017 Fengyuan Chen\n * Released under the MIT license\n *\n * Date: 2017-07-07T13:00:47.346Z\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(require('jquery')) :\n  typeof define === 'function' && define.amd ? define(['jquery'], factory) :\n  (factory(global.jQuery));\n}(this, (function ($) { 'use strict';\n\n$ = 'default' in $ ? $['default'] : $;\n\nvar DEFAULTS = {\n  // Define the view mode of the cropper\n  viewMode: 0, // 0, 1, 2, 3\n\n  // Define the dragging mode of the cropper\n  dragMode: 'crop', // 'crop', 'move' or 'none'\n\n  // Define the aspect ratio of the crop box\n  aspectRatio: NaN,\n\n  // An object with the previous cropping result data\n  data: null,\n\n  // A selector for adding extra containers to preview\n  preview: '',\n\n  // Re-render the cropper when resize the window\n  responsive: true,\n\n  // Restore the cropped area after resize the window\n  restore: true,\n\n  // Check if the current image is a cross-origin image\n  checkCrossOrigin: true,\n\n  // Check the current image's Exif Orientation information\n  checkOrientation: true,\n\n  // Show the black modal\n  modal: true,\n\n  // Show the dashed lines for guiding\n  guides: true,\n\n  // Show the center indicator for guiding\n  center: true,\n\n  // Show the white modal to highlight the crop box\n  highlight: true,\n\n  // Show the grid background\n  background: true,\n\n  // Enable to crop the image automatically when initialize\n  autoCrop: true,\n\n  // Define the percentage of automatic cropping area when initializes\n  autoCropArea: 0.8,\n\n  // Enable to move the image\n  movable: true,\n\n  // Enable to rotate the image\n  rotatable: true,\n\n  // Enable to scale the image\n  scalable: true,\n\n  // Enable to zoom the image\n  zoomable: true,\n\n  // Enable to zoom the image by dragging touch\n  zoomOnTouch: true,\n\n  // Enable to zoom the image by wheeling mouse\n  zoomOnWheel: true,\n\n  // Define zoom ratio when zoom the image by wheeling mouse\n  wheelZoomRatio: 0.1,\n\n  // Enable to move the crop box\n  cropBoxMovable: true,\n\n  // Enable to resize the crop box\n  cropBoxResizable: true,\n\n  // Toggle drag mode between \"crop\" and \"move\" when click twice on the cropper\n  toggleDragModeOnDblclick: true,\n\n  // Size limitation\n  minCanvasWidth: 0,\n  minCanvasHeight: 0,\n  minCropBoxWidth: 0,\n  minCropBoxHeight: 0,\n  minContainerWidth: 200,\n  minContainerHeight: 100,\n\n  // Shortcuts of events\n  ready: null,\n  cropstart: null,\n  cropmove: null,\n  cropend: null,\n  crop: null,\n  zoom: null\n};\n\nvar TEMPLATE = '<div class=\"cropper-container\">' + '<div class=\"cropper-wrap-box\">' + '<div class=\"cropper-canvas\"></div>' + '</div>' + '<div class=\"cropper-drag-box\"></div>' + '<div class=\"cropper-crop-box\">' + '<span class=\"cropper-view-box\"></span>' + '<span class=\"cropper-dashed dashed-h\"></span>' + '<span class=\"cropper-dashed dashed-v\"></span>' + '<span class=\"cropper-center\"></span>' + '<span class=\"cropper-face\"></span>' + '<span class=\"cropper-line line-e\" data-action=\"e\"></span>' + '<span class=\"cropper-line line-n\" data-action=\"n\"></span>' + '<span class=\"cropper-line line-w\" data-action=\"w\"></span>' + '<span class=\"cropper-line line-s\" data-action=\"s\"></span>' + '<span class=\"cropper-point point-e\" data-action=\"e\"></span>' + '<span class=\"cropper-point point-n\" data-action=\"n\"></span>' + '<span class=\"cropper-point point-w\" data-action=\"w\"></span>' + '<span class=\"cropper-point point-s\" data-action=\"s\"></span>' + '<span class=\"cropper-point point-ne\" data-action=\"ne\"></span>' + '<span class=\"cropper-point point-nw\" data-action=\"nw\"></span>' + '<span class=\"cropper-point point-sw\" data-action=\"sw\"></span>' + '<span class=\"cropper-point point-se\" data-action=\"se\"></span>' + '</div>' + '</div>';\n\nvar REGEXP_DATA_URL_HEAD = /^data:.*,/;\nvar REGEXP_USERAGENT = /(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i;\nvar navigator = typeof window !== 'undefined' ? window.navigator : null;\nvar IS_SAFARI_OR_UIWEBVIEW = navigator && REGEXP_USERAGENT.test(navigator.userAgent);\nvar fromCharCode = String.fromCharCode;\n\nfunction isNumber(n) {\n  return typeof n === 'number' && !isNaN(n);\n}\n\nfunction isUndefined(n) {\n  return typeof n === 'undefined';\n}\n\nfunction toArray(obj, offset) {\n  var args = [];\n\n  // This is necessary for IE8\n  if (isNumber(offset)) {\n    args.push(offset);\n  }\n\n  return args.slice.apply(obj, args);\n}\n\n// Custom proxy to avoid jQuery's guid\nfunction proxy(fn, context) {\n  for (var _len = arguments.length, args = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n\n  return function () {\n    for (var _len2 = arguments.length, args2 = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args2[_key2] = arguments[_key2];\n    }\n\n    return fn.apply(context, args.concat(toArray(args2)));\n  };\n}\n\nfunction objectKeys(obj) {\n  var keys = [];\n\n  $.each(obj, function (key) {\n    keys.push(key);\n  });\n\n  return keys;\n}\n\nfunction isCrossOriginURL(url) {\n  var parts = url.match(/^(https?:)\\/\\/([^:/?#]+):?(\\d*)/i);\n\n  return parts && (parts[1] !== location.protocol || parts[2] !== location.hostname || parts[3] !== location.port);\n}\n\nfunction addTimestamp(url) {\n  var timestamp = 'timestamp=' + new Date().getTime();\n\n  return url + (url.indexOf('?') === -1 ? '?' : '&') + timestamp;\n}\n\nfunction getImageSize(image, callback) {\n  // Modern browsers (ignore Safari, #120 & #509)\n  if (image.naturalWidth && !IS_SAFARI_OR_UIWEBVIEW) {\n    callback(image.naturalWidth, image.naturalHeight);\n    return;\n  }\n\n  // IE8: Don't use `new Image()` here (#319)\n  var newImage = document.createElement('img');\n\n  newImage.onload = function load() {\n    callback(this.width, this.height);\n  };\n\n  newImage.src = image.src;\n}\n\nfunction getTransform(options) {\n  var transforms = [];\n  var translateX = options.translateX;\n  var translateY = options.translateY;\n  var rotate = options.rotate;\n  var scaleX = options.scaleX;\n  var scaleY = options.scaleY;\n\n  if (isNumber(translateX) && translateX !== 0) {\n    transforms.push('translateX(' + translateX + 'px)');\n  }\n\n  if (isNumber(translateY) && translateY !== 0) {\n    transforms.push('translateY(' + translateY + 'px)');\n  }\n\n  // Rotate should come first before scale to match orientation transform\n  if (isNumber(rotate) && rotate !== 0) {\n    transforms.push('rotate(' + rotate + 'deg)');\n  }\n\n  if (isNumber(scaleX) && scaleX !== 1) {\n    transforms.push('scaleX(' + scaleX + ')');\n  }\n\n  if (isNumber(scaleY) && scaleY !== 1) {\n    transforms.push('scaleY(' + scaleY + ')');\n  }\n\n  return transforms.length ? transforms.join(' ') : 'none';\n}\n\nfunction getRotatedSizes(data, isReversed) {\n  var deg = Math.abs(data.degree) % 180;\n  var arc = (deg > 90 ? 180 - deg : deg) * Math.PI / 180;\n  var sinArc = Math.sin(arc);\n  var cosArc = Math.cos(arc);\n  var width = data.width;\n  var height = data.height;\n  var aspectRatio = data.aspectRatio;\n  var newWidth = void 0;\n  var newHeight = void 0;\n\n  if (!isReversed) {\n    newWidth = width * cosArc + height * sinArc;\n    newHeight = width * sinArc + height * cosArc;\n  } else {\n    newWidth = width / (cosArc + sinArc / aspectRatio);\n    newHeight = newWidth / aspectRatio;\n  }\n\n  return {\n    width: newWidth,\n    height: newHeight\n  };\n}\n\nfunction getSourceCanvas(image, data, options) {\n  var canvas = $('<canvas>')[0];\n  var context = canvas.getContext('2d');\n  var dstX = 0;\n  var dstY = 0;\n  var dstWidth = data.naturalWidth;\n  var dstHeight = data.naturalHeight;\n  var rotate = data.rotate;\n  var scaleX = data.scaleX;\n  var scaleY = data.scaleY;\n  var scalable = isNumber(scaleX) && isNumber(scaleY) && (scaleX !== 1 || scaleY !== 1);\n  var rotatable = isNumber(rotate) && rotate !== 0;\n  var advanced = rotatable || scalable;\n  var canvasWidth = dstWidth * Math.abs(scaleX || 1);\n  var canvasHeight = dstHeight * Math.abs(scaleY || 1);\n  var translateX = void 0;\n  var translateY = void 0;\n  var rotated = void 0;\n\n  if (scalable) {\n    translateX = canvasWidth / 2;\n    translateY = canvasHeight / 2;\n  }\n\n  if (rotatable) {\n    rotated = getRotatedSizes({\n      width: canvasWidth,\n      height: canvasHeight,\n      degree: rotate\n    });\n\n    canvasWidth = rotated.width;\n    canvasHeight = rotated.height;\n    translateX = canvasWidth / 2;\n    translateY = canvasHeight / 2;\n  }\n\n  canvas.width = canvasWidth;\n  canvas.height = canvasHeight;\n\n  if (options.fillColor) {\n    context.fillStyle = options.fillColor;\n    context.fillRect(0, 0, canvasWidth, canvasHeight);\n  }\n\n  if (advanced) {\n    dstX = -dstWidth / 2;\n    dstY = -dstHeight / 2;\n\n    context.save();\n    context.translate(translateX, translateY);\n  }\n\n  // Rotate should come first before scale as in the \"getTransform\" function\n  if (rotatable) {\n    context.rotate(rotate * Math.PI / 180);\n  }\n\n  if (scalable) {\n    context.scale(scaleX, scaleY);\n  }\n\n  context.imageSmoothingEnabled = !!options.imageSmoothingEnabled;\n\n  if (options.imageSmoothingQuality) {\n    context.imageSmoothingQuality = options.imageSmoothingQuality;\n  }\n\n  context.drawImage(image, Math.floor(dstX), Math.floor(dstY), Math.floor(dstWidth), Math.floor(dstHeight));\n\n  if (advanced) {\n    context.restore();\n  }\n\n  return canvas;\n}\n\nfunction getStringFromCharCode(dataView, start, length) {\n  var str = '';\n  var i = void 0;\n\n  for (i = start, length += start; i < length; i++) {\n    str += fromCharCode(dataView.getUint8(i));\n  }\n\n  return str;\n}\n\nfunction getOrientation(arrayBuffer) {\n  var dataView = new DataView(arrayBuffer);\n  var length = dataView.byteLength;\n  var orientation = void 0;\n  var exifIDCode = void 0;\n  var tiffOffset = void 0;\n  var firstIFDOffset = void 0;\n  var littleEndian = void 0;\n  var endianness = void 0;\n  var app1Start = void 0;\n  var ifdStart = void 0;\n  var offset = void 0;\n  var i = void 0;\n\n  // Only handle JPEG image (start by 0xFFD8)\n  if (dataView.getUint8(0) === 0xFF && dataView.getUint8(1) === 0xD8) {\n    offset = 2;\n\n    while (offset < length) {\n      if (dataView.getUint8(offset) === 0xFF && dataView.getUint8(offset + 1) === 0xE1) {\n        app1Start = offset;\n        break;\n      }\n\n      offset++;\n    }\n  }\n\n  if (app1Start) {\n    exifIDCode = app1Start + 4;\n    tiffOffset = app1Start + 10;\n\n    if (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\n      endianness = dataView.getUint16(tiffOffset);\n      littleEndian = endianness === 0x4949;\n\n      if (littleEndian || endianness === 0x4D4D /* bigEndian */) {\n          if (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002A) {\n            firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\n\n            if (firstIFDOffset >= 0x00000008) {\n              ifdStart = tiffOffset + firstIFDOffset;\n            }\n          }\n        }\n    }\n  }\n\n  if (ifdStart) {\n    length = dataView.getUint16(ifdStart, littleEndian);\n\n    for (i = 0; i < length; i++) {\n      offset = ifdStart + i * 12 + 2;\n\n      if (dataView.getUint16(offset, littleEndian) === 0x0112 /* Orientation */) {\n          // 8 is the offset of the current tag's value\n          offset += 8;\n\n          // Get the original orientation value\n          orientation = dataView.getUint16(offset, littleEndian);\n\n          // Override the orientation with its default value for Safari (#120)\n          if (IS_SAFARI_OR_UIWEBVIEW) {\n            dataView.setUint16(offset, 1, littleEndian);\n          }\n\n          break;\n        }\n    }\n  }\n\n  return orientation;\n}\n\nfunction dataURLToArrayBuffer(dataURL) {\n  var base64 = dataURL.replace(REGEXP_DATA_URL_HEAD, '');\n  var binary = atob(base64);\n  var length = binary.length;\n  var arrayBuffer = new ArrayBuffer(length);\n  var dataView = new Uint8Array(arrayBuffer);\n  var i = void 0;\n\n  for (i = 0; i < length; i++) {\n    dataView[i] = binary.charCodeAt(i);\n  }\n\n  return arrayBuffer;\n}\n\n// Only available for JPEG image\nfunction arrayBufferToDataURL(arrayBuffer) {\n  var dataView = new Uint8Array(arrayBuffer);\n  var length = dataView.length;\n  var base64 = '';\n  var i = void 0;\n\n  for (i = 0; i < length; i++) {\n    base64 += fromCharCode(dataView[i]);\n  }\n\n  return 'data:image/jpeg;base64,' + btoa(base64);\n}\n\nvar render$1 = {\n  render: function render() {\n    var self = this;\n\n    self.initContainer();\n    self.initCanvas();\n    self.initCropBox();\n\n    self.renderCanvas();\n\n    if (self.cropped) {\n      self.renderCropBox();\n    }\n  },\n  initContainer: function initContainer() {\n    var self = this;\n    var options = self.options;\n    var $this = self.$element;\n    var $container = self.$container;\n    var $cropper = self.$cropper;\n    var hidden = 'cropper-hidden';\n\n    $cropper.addClass(hidden);\n    $this.removeClass(hidden);\n\n    $cropper.css(self.container = {\n      width: Math.max($container.width(), Number(options.minContainerWidth) || 200),\n      height: Math.max($container.height(), Number(options.minContainerHeight) || 100)\n    });\n\n    $this.addClass(hidden);\n    $cropper.removeClass(hidden);\n  },\n\n\n  // Canvas (image wrapper)\n  initCanvas: function initCanvas() {\n    var self = this;\n    var viewMode = self.options.viewMode;\n    var container = self.container;\n    var containerWidth = container.width;\n    var containerHeight = container.height;\n    var image = self.image;\n    var imageNaturalWidth = image.naturalWidth;\n    var imageNaturalHeight = image.naturalHeight;\n    var is90Degree = Math.abs(image.rotate) % 180 === 90;\n    var naturalWidth = is90Degree ? imageNaturalHeight : imageNaturalWidth;\n    var naturalHeight = is90Degree ? imageNaturalWidth : imageNaturalHeight;\n    var aspectRatio = naturalWidth / naturalHeight;\n    var canvasWidth = containerWidth;\n    var canvasHeight = containerHeight;\n\n    if (containerHeight * aspectRatio > containerWidth) {\n      if (viewMode === 3) {\n        canvasWidth = containerHeight * aspectRatio;\n      } else {\n        canvasHeight = containerWidth / aspectRatio;\n      }\n    } else if (viewMode === 3) {\n      canvasHeight = containerWidth / aspectRatio;\n    } else {\n      canvasWidth = containerHeight * aspectRatio;\n    }\n\n    var canvas = {\n      naturalWidth: naturalWidth,\n      naturalHeight: naturalHeight,\n      aspectRatio: aspectRatio,\n      width: canvasWidth,\n      height: canvasHeight\n    };\n\n    canvas.oldLeft = canvas.left = (containerWidth - canvasWidth) / 2;\n    canvas.oldTop = canvas.top = (containerHeight - canvasHeight) / 2;\n\n    self.canvas = canvas;\n    self.limited = viewMode === 1 || viewMode === 2;\n    self.limitCanvas(true, true);\n    self.initialImage = $.extend({}, image);\n    self.initialCanvas = $.extend({}, canvas);\n  },\n  limitCanvas: function limitCanvas(isSizeLimited, isPositionLimited) {\n    var self = this;\n    var options = self.options;\n    var viewMode = options.viewMode;\n    var container = self.container;\n    var containerWidth = container.width;\n    var containerHeight = container.height;\n    var canvas = self.canvas;\n    var aspectRatio = canvas.aspectRatio;\n    var cropBox = self.cropBox;\n    var cropped = self.cropped && cropBox;\n\n    if (isSizeLimited) {\n      var minCanvasWidth = Number(options.minCanvasWidth) || 0;\n      var minCanvasHeight = Number(options.minCanvasHeight) || 0;\n\n      if (viewMode) {\n        if (viewMode > 1) {\n          minCanvasWidth = Math.max(minCanvasWidth, containerWidth);\n          minCanvasHeight = Math.max(minCanvasHeight, containerHeight);\n\n          if (viewMode === 3) {\n            if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n              minCanvasWidth = minCanvasHeight * aspectRatio;\n            } else {\n              minCanvasHeight = minCanvasWidth / aspectRatio;\n            }\n          }\n        } else if (minCanvasWidth) {\n          minCanvasWidth = Math.max(minCanvasWidth, cropped ? cropBox.width : 0);\n        } else if (minCanvasHeight) {\n          minCanvasHeight = Math.max(minCanvasHeight, cropped ? cropBox.height : 0);\n        } else if (cropped) {\n          minCanvasWidth = cropBox.width;\n          minCanvasHeight = cropBox.height;\n\n          if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n            minCanvasWidth = minCanvasHeight * aspectRatio;\n          } else {\n            minCanvasHeight = minCanvasWidth / aspectRatio;\n          }\n        }\n      }\n\n      if (minCanvasWidth && minCanvasHeight) {\n        if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n          minCanvasHeight = minCanvasWidth / aspectRatio;\n        } else {\n          minCanvasWidth = minCanvasHeight * aspectRatio;\n        }\n      } else if (minCanvasWidth) {\n        minCanvasHeight = minCanvasWidth / aspectRatio;\n      } else if (minCanvasHeight) {\n        minCanvasWidth = minCanvasHeight * aspectRatio;\n      }\n\n      canvas.minWidth = minCanvasWidth;\n      canvas.minHeight = minCanvasHeight;\n      canvas.maxWidth = Infinity;\n      canvas.maxHeight = Infinity;\n    }\n\n    if (isPositionLimited) {\n      if (viewMode) {\n        var newCanvasLeft = containerWidth - canvas.width;\n        var newCanvasTop = containerHeight - canvas.height;\n\n        canvas.minLeft = Math.min(0, newCanvasLeft);\n        canvas.minTop = Math.min(0, newCanvasTop);\n        canvas.maxLeft = Math.max(0, newCanvasLeft);\n        canvas.maxTop = Math.max(0, newCanvasTop);\n\n        if (cropped && self.limited) {\n          canvas.minLeft = Math.min(cropBox.left, cropBox.left + cropBox.width - canvas.width);\n          canvas.minTop = Math.min(cropBox.top, cropBox.top + cropBox.height - canvas.height);\n          canvas.maxLeft = cropBox.left;\n          canvas.maxTop = cropBox.top;\n\n          if (viewMode === 2) {\n            if (canvas.width >= containerWidth) {\n              canvas.minLeft = Math.min(0, newCanvasLeft);\n              canvas.maxLeft = Math.max(0, newCanvasLeft);\n            }\n\n            if (canvas.height >= containerHeight) {\n              canvas.minTop = Math.min(0, newCanvasTop);\n              canvas.maxTop = Math.max(0, newCanvasTop);\n            }\n          }\n        }\n      } else {\n        canvas.minLeft = -canvas.width;\n        canvas.minTop = -canvas.height;\n        canvas.maxLeft = containerWidth;\n        canvas.maxTop = containerHeight;\n      }\n    }\n  },\n  renderCanvas: function renderCanvas(isChanged) {\n    var self = this;\n    var canvas = self.canvas;\n    var image = self.image;\n    var rotate = image.rotate;\n    var naturalWidth = image.naturalWidth;\n    var naturalHeight = image.naturalHeight;\n\n    if (self.rotated) {\n      self.rotated = false;\n\n      // Computes rotated sizes with image sizes\n      var rotated = getRotatedSizes({\n        width: image.width,\n        height: image.height,\n        degree: rotate\n      });\n      var aspectRatio = rotated.width / rotated.height;\n      var isSquareImage = image.aspectRatio === 1;\n\n      if (isSquareImage || aspectRatio !== canvas.aspectRatio) {\n        canvas.left -= (rotated.width - canvas.width) / 2;\n        canvas.top -= (rotated.height - canvas.height) / 2;\n        canvas.width = rotated.width;\n        canvas.height = rotated.height;\n        canvas.aspectRatio = aspectRatio;\n        canvas.naturalWidth = naturalWidth;\n        canvas.naturalHeight = naturalHeight;\n\n        // Computes rotated sizes with natural image sizes\n        if (isSquareImage && rotate % 90 || rotate % 180) {\n          var rotated2 = getRotatedSizes({\n            width: naturalWidth,\n            height: naturalHeight,\n            degree: rotate\n          });\n\n          canvas.naturalWidth = rotated2.width;\n          canvas.naturalHeight = rotated2.height;\n        }\n\n        self.limitCanvas(true, false);\n      }\n    }\n\n    if (canvas.width > canvas.maxWidth || canvas.width < canvas.minWidth) {\n      canvas.left = canvas.oldLeft;\n    }\n\n    if (canvas.height > canvas.maxHeight || canvas.height < canvas.minHeight) {\n      canvas.top = canvas.oldTop;\n    }\n\n    canvas.width = Math.min(Math.max(canvas.width, canvas.minWidth), canvas.maxWidth);\n    canvas.height = Math.min(Math.max(canvas.height, canvas.minHeight), canvas.maxHeight);\n\n    self.limitCanvas(false, true);\n\n    canvas.oldLeft = canvas.left = Math.min(Math.max(canvas.left, canvas.minLeft), canvas.maxLeft);\n    canvas.oldTop = canvas.top = Math.min(Math.max(canvas.top, canvas.minTop), canvas.maxTop);\n\n    self.$canvas.css({\n      width: canvas.width,\n      height: canvas.height,\n      transform: getTransform({\n        translateX: canvas.left,\n        translateY: canvas.top\n      })\n    });\n\n    self.renderImage();\n\n    if (self.cropped && self.limited) {\n      self.limitCropBox(true, true);\n    }\n\n    if (isChanged) {\n      self.output();\n    }\n  },\n  renderImage: function renderImage(isChanged) {\n    var self = this;\n    var canvas = self.canvas;\n    var image = self.image;\n    var reversed = void 0;\n\n    if (image.rotate) {\n      reversed = getRotatedSizes({\n        width: canvas.width,\n        height: canvas.height,\n        degree: image.rotate,\n        aspectRatio: image.aspectRatio\n      }, true);\n    }\n\n    $.extend(image, reversed ? {\n      width: reversed.width,\n      height: reversed.height,\n      left: (canvas.width - reversed.width) / 2,\n      top: (canvas.height - reversed.height) / 2\n    } : {\n      width: canvas.width,\n      height: canvas.height,\n      left: 0,\n      top: 0\n    });\n\n    self.$clone.css({\n      width: image.width,\n      height: image.height,\n      transform: getTransform($.extend({\n        translateX: image.left,\n        translateY: image.top\n      }, image))\n    });\n\n    if (isChanged) {\n      self.output();\n    }\n  },\n  initCropBox: function initCropBox() {\n    var self = this;\n    var options = self.options;\n    var canvas = self.canvas;\n    var aspectRatio = options.aspectRatio;\n    var autoCropArea = Number(options.autoCropArea) || 0.8;\n    var cropBox = {\n      width: canvas.width,\n      height: canvas.height\n    };\n\n    if (aspectRatio) {\n      if (canvas.height * aspectRatio > canvas.width) {\n        cropBox.height = cropBox.width / aspectRatio;\n      } else {\n        cropBox.width = cropBox.height * aspectRatio;\n      }\n    }\n\n    self.cropBox = cropBox;\n    self.limitCropBox(true, true);\n\n    // Initialize auto crop area\n    cropBox.width = Math.min(Math.max(cropBox.width, cropBox.minWidth), cropBox.maxWidth);\n    cropBox.height = Math.min(Math.max(cropBox.height, cropBox.minHeight), cropBox.maxHeight);\n\n    // The width of auto crop area must large than \"minWidth\", and the height too. (#164)\n    cropBox.width = Math.max(cropBox.minWidth, cropBox.width * autoCropArea);\n    cropBox.height = Math.max(cropBox.minHeight, cropBox.height * autoCropArea);\n    cropBox.oldLeft = cropBox.left = canvas.left + (canvas.width - cropBox.width) / 2;\n    cropBox.oldTop = cropBox.top = canvas.top + (canvas.height - cropBox.height) / 2;\n\n    self.initialCropBox = $.extend({}, cropBox);\n  },\n  limitCropBox: function limitCropBox(isSizeLimited, isPositionLimited) {\n    var self = this;\n    var options = self.options;\n    var aspectRatio = options.aspectRatio;\n    var container = self.container;\n    var containerWidth = container.width;\n    var containerHeight = container.height;\n    var canvas = self.canvas;\n    var cropBox = self.cropBox;\n    var limited = self.limited;\n\n    if (isSizeLimited) {\n      var minCropBoxWidth = Number(options.minCropBoxWidth) || 0;\n      var minCropBoxHeight = Number(options.minCropBoxHeight) || 0;\n      var maxCropBoxWidth = Math.min(containerWidth, limited ? canvas.width : containerWidth);\n      var maxCropBoxHeight = Math.min(containerHeight, limited ? canvas.height : containerHeight);\n\n      // The min/maxCropBoxWidth/Height must be less than containerWidth/Height\n      minCropBoxWidth = Math.min(minCropBoxWidth, containerWidth);\n      minCropBoxHeight = Math.min(minCropBoxHeight, containerHeight);\n\n      if (aspectRatio) {\n        if (minCropBoxWidth && minCropBoxHeight) {\n          if (minCropBoxHeight * aspectRatio > minCropBoxWidth) {\n            minCropBoxHeight = minCropBoxWidth / aspectRatio;\n          } else {\n            minCropBoxWidth = minCropBoxHeight * aspectRatio;\n          }\n        } else if (minCropBoxWidth) {\n          minCropBoxHeight = minCropBoxWidth / aspectRatio;\n        } else if (minCropBoxHeight) {\n          minCropBoxWidth = minCropBoxHeight * aspectRatio;\n        }\n\n        if (maxCropBoxHeight * aspectRatio > maxCropBoxWidth) {\n          maxCropBoxHeight = maxCropBoxWidth / aspectRatio;\n        } else {\n          maxCropBoxWidth = maxCropBoxHeight * aspectRatio;\n        }\n      }\n\n      // The minWidth/Height must be less than maxWidth/Height\n      cropBox.minWidth = Math.min(minCropBoxWidth, maxCropBoxWidth);\n      cropBox.minHeight = Math.min(minCropBoxHeight, maxCropBoxHeight);\n      cropBox.maxWidth = maxCropBoxWidth;\n      cropBox.maxHeight = maxCropBoxHeight;\n    }\n\n    if (isPositionLimited) {\n      if (limited) {\n        cropBox.minLeft = Math.max(0, canvas.left);\n        cropBox.minTop = Math.max(0, canvas.top);\n        cropBox.maxLeft = Math.min(containerWidth, canvas.left + canvas.width) - cropBox.width;\n        cropBox.maxTop = Math.min(containerHeight, canvas.top + canvas.height) - cropBox.height;\n      } else {\n        cropBox.minLeft = 0;\n        cropBox.minTop = 0;\n        cropBox.maxLeft = containerWidth - cropBox.width;\n        cropBox.maxTop = containerHeight - cropBox.height;\n      }\n    }\n  },\n  renderCropBox: function renderCropBox() {\n    var self = this;\n    var options = self.options;\n    var container = self.container;\n    var containerWidth = container.width;\n    var containerHeight = container.height;\n    var cropBox = self.cropBox;\n\n    if (cropBox.width > cropBox.maxWidth || cropBox.width < cropBox.minWidth) {\n      cropBox.left = cropBox.oldLeft;\n    }\n\n    if (cropBox.height > cropBox.maxHeight || cropBox.height < cropBox.minHeight) {\n      cropBox.top = cropBox.oldTop;\n    }\n\n    cropBox.width = Math.min(Math.max(cropBox.width, cropBox.minWidth), cropBox.maxWidth);\n    cropBox.height = Math.min(Math.max(cropBox.height, cropBox.minHeight), cropBox.maxHeight);\n\n    self.limitCropBox(false, true);\n\n    cropBox.oldLeft = cropBox.left = Math.min(Math.max(cropBox.left, cropBox.minLeft), cropBox.maxLeft);\n    cropBox.oldTop = cropBox.top = Math.min(Math.max(cropBox.top, cropBox.minTop), cropBox.maxTop);\n\n    if (options.movable && options.cropBoxMovable) {\n      // Turn to move the canvas when the crop box is equal to the container\n      self.$face.data('action', cropBox.width === containerWidth && cropBox.height === containerHeight ? 'move' : 'all');\n    }\n\n    self.$cropBox.css({\n      width: cropBox.width,\n      height: cropBox.height,\n      transform: getTransform({\n        translateX: cropBox.left,\n        translateY: cropBox.top\n      })\n    });\n\n    if (self.cropped && self.limited) {\n      self.limitCanvas(true, true);\n    }\n\n    if (!self.disabled) {\n      self.output();\n    }\n  },\n  output: function output() {\n    var self = this;\n\n    self.preview();\n\n    if (self.completed) {\n      self.trigger('crop', self.getData());\n    }\n  }\n};\n\nvar DATA_PREVIEW = 'preview';\n\nvar preview$1 = {\n  initPreview: function initPreview() {\n    var self = this;\n    var crossOrigin = self.crossOrigin;\n    var url = crossOrigin ? self.crossOriginUrl : self.url;\n    var image = document.createElement('img');\n\n    if (crossOrigin) {\n      image.crossOrigin = crossOrigin;\n    }\n\n    image.src = url;\n\n    var $clone2 = $(image);\n\n    self.$preview = $(self.options.preview);\n    self.$clone2 = $clone2;\n    self.$viewBox.html($clone2);\n    self.$preview.each(function (i, element) {\n      var $this = $(element);\n      var img = document.createElement('img');\n\n      // Save the original size for recover\n      $this.data(DATA_PREVIEW, {\n        width: $this.width(),\n        height: $this.height(),\n        html: $this.html()\n      });\n\n      if (crossOrigin) {\n        img.crossOrigin = crossOrigin;\n      }\n\n      img.src = url;\n\n      /**\n       * Override img element styles\n       * Add `display:block` to avoid margin top issue\n       * Add `height:auto` to override `height` attribute on IE8\n       * (Occur only when margin-top <= -height)\n       */\n      img.style.cssText = 'display:block;' + 'width:100%;' + 'height:auto;' + 'min-width:0!important;' + 'min-height:0!important;' + 'max-width:none!important;' + 'max-height:none!important;' + 'image-orientation:0deg!important;\"';\n\n      $this.html(img);\n    });\n  },\n  resetPreview: function resetPreview() {\n    this.$preview.each(function (i, element) {\n      var $this = $(element);\n      var data = $this.data(DATA_PREVIEW);\n\n      $this.css({\n        width: data.width,\n        height: data.height\n      }).html(data.html).removeData(DATA_PREVIEW);\n    });\n  },\n  preview: function preview() {\n    var self = this;\n    var image = self.image;\n    var canvas = self.canvas;\n    var cropBox = self.cropBox;\n    var cropBoxWidth = cropBox.width;\n    var cropBoxHeight = cropBox.height;\n    var width = image.width;\n    var height = image.height;\n    var left = cropBox.left - canvas.left - image.left;\n    var top = cropBox.top - canvas.top - image.top;\n\n    if (!self.cropped || self.disabled) {\n      return;\n    }\n\n    self.$clone2.css({\n      width: width,\n      height: height,\n      transform: getTransform($.extend({\n        translateX: -left,\n        translateY: -top\n      }, image))\n    });\n\n    self.$preview.each(function (i, element) {\n      var $this = $(element);\n      var data = $this.data(DATA_PREVIEW);\n      var originalWidth = data.width;\n      var originalHeight = data.height;\n      var newWidth = originalWidth;\n      var newHeight = originalHeight;\n      var ratio = 1;\n\n      if (cropBoxWidth) {\n        ratio = originalWidth / cropBoxWidth;\n        newHeight = cropBoxHeight * ratio;\n      }\n\n      if (cropBoxHeight && newHeight > originalHeight) {\n        ratio = originalHeight / cropBoxHeight;\n        newWidth = cropBoxWidth * ratio;\n        newHeight = originalHeight;\n      }\n\n      $this.css({\n        width: newWidth,\n        height: newHeight\n      }).find('img').css({\n        width: width * ratio,\n        height: height * ratio,\n        transform: getTransform($.extend({\n          translateX: -left * ratio,\n          translateY: -top * ratio\n        }, image))\n      });\n    });\n  }\n};\n\n// Globals\nvar PointerEvent = typeof window !== 'undefined' ? window.PointerEvent : null;\n\n// Events\nvar EVENT_POINTER_DOWN = PointerEvent ? 'pointerdown' : 'touchstart mousedown';\nvar EVENT_POINTER_MOVE = PointerEvent ? 'pointermove' : 'touchmove mousemove';\nvar EVENT_POINTER_UP = PointerEvent ? ' pointerup pointercancel' : 'touchend touchcancel mouseup';\nvar EVENT_WHEEL = 'wheel mousewheel DOMMouseScroll';\nvar EVENT_DBLCLICK = 'dblclick';\nvar EVENT_RESIZE = 'resize';\nvar EVENT_CROP_START = 'cropstart';\nvar EVENT_CROP_MOVE = 'cropmove';\nvar EVENT_CROP_END = 'cropend';\nvar EVENT_CROP = 'crop';\nvar EVENT_ZOOM = 'zoom';\n\nvar events = {\n  bind: function bind() {\n    var self = this;\n    var options = self.options;\n    var $this = self.$element;\n    var $cropper = self.$cropper;\n\n    if ($.isFunction(options.cropstart)) {\n      $this.on(EVENT_CROP_START, options.cropstart);\n    }\n\n    if ($.isFunction(options.cropmove)) {\n      $this.on(EVENT_CROP_MOVE, options.cropmove);\n    }\n\n    if ($.isFunction(options.cropend)) {\n      $this.on(EVENT_CROP_END, options.cropend);\n    }\n\n    if ($.isFunction(options.crop)) {\n      $this.on(EVENT_CROP, options.crop);\n    }\n\n    if ($.isFunction(options.zoom)) {\n      $this.on(EVENT_ZOOM, options.zoom);\n    }\n\n    $cropper.on(EVENT_POINTER_DOWN, proxy(self.cropStart, this));\n\n    if (options.zoomable && options.zoomOnWheel) {\n      $cropper.on(EVENT_WHEEL, proxy(self.wheel, this));\n    }\n\n    if (options.toggleDragModeOnDblclick) {\n      $cropper.on(EVENT_DBLCLICK, proxy(self.dblclick, this));\n    }\n\n    $(document).on(EVENT_POINTER_MOVE, self.onCropMove = proxy(self.cropMove, this)).on(EVENT_POINTER_UP, self.onCropEnd = proxy(self.cropEnd, this));\n\n    if (options.responsive) {\n      $(window).on(EVENT_RESIZE, self.onResize = proxy(self.resize, this));\n    }\n  },\n  unbind: function unbind() {\n    var self = this;\n    var options = self.options;\n    var $this = self.$element;\n    var $cropper = self.$cropper;\n\n    if ($.isFunction(options.cropstart)) {\n      $this.off(EVENT_CROP_START, options.cropstart);\n    }\n\n    if ($.isFunction(options.cropmove)) {\n      $this.off(EVENT_CROP_MOVE, options.cropmove);\n    }\n\n    if ($.isFunction(options.cropend)) {\n      $this.off(EVENT_CROP_END, options.cropend);\n    }\n\n    if ($.isFunction(options.crop)) {\n      $this.off(EVENT_CROP, options.crop);\n    }\n\n    if ($.isFunction(options.zoom)) {\n      $this.off(EVENT_ZOOM, options.zoom);\n    }\n\n    $cropper.off(EVENT_POINTER_DOWN, self.cropStart);\n\n    if (options.zoomable && options.zoomOnWheel) {\n      $cropper.off(EVENT_WHEEL, self.wheel);\n    }\n\n    if (options.toggleDragModeOnDblclick) {\n      $cropper.off(EVENT_DBLCLICK, self.dblclick);\n    }\n\n    $(document).off(EVENT_POINTER_MOVE, self.onCropMove).off(EVENT_POINTER_UP, self.onCropEnd);\n\n    if (options.responsive) {\n      $(window).off(EVENT_RESIZE, self.onResize);\n    }\n  }\n};\n\nvar REGEXP_ACTIONS = /^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/;\n\nfunction getPointer(_ref, endOnly) {\n  var pageX = _ref.pageX,\n      pageY = _ref.pageY;\n\n  var end = {\n    endX: pageX,\n    endY: pageY\n  };\n\n  if (endOnly) {\n    return end;\n  }\n\n  return $.extend({\n    startX: pageX,\n    startY: pageY\n  }, end);\n}\n\nvar handlers = {\n  resize: function resize() {\n    var self = this;\n    var options = self.options;\n    var $container = self.$container;\n    var container = self.container;\n    var minContainerWidth = Number(options.minContainerWidth) || 200;\n    var minContainerHeight = Number(options.minContainerHeight) || 100;\n\n    if (self.disabled || container.width === minContainerWidth || container.height === minContainerHeight) {\n      return;\n    }\n\n    var ratio = $container.width() / container.width;\n\n    // Resize when width changed or height changed\n    if (ratio !== 1 || $container.height() !== container.height) {\n      (function () {\n        var canvasData = void 0;\n        var cropBoxData = void 0;\n\n        if (options.restore) {\n          canvasData = self.getCanvasData();\n          cropBoxData = self.getCropBoxData();\n        }\n\n        self.render();\n\n        if (options.restore) {\n          self.setCanvasData($.each(canvasData, function (i, n) {\n            canvasData[i] = n * ratio;\n          }));\n          self.setCropBoxData($.each(cropBoxData, function (i, n) {\n            cropBoxData[i] = n * ratio;\n          }));\n        }\n      })();\n    }\n  },\n  dblclick: function dblclick() {\n    var self = this;\n\n    if (self.disabled || self.options.dragMode === 'none') {\n      return;\n    }\n\n    self.setDragMode(self.$dragBox.hasClass('cropper-crop') ? 'move' : 'crop');\n  },\n  wheel: function wheel(event) {\n    var self = this;\n    var e = event.originalEvent || event;\n    var ratio = Number(self.options.wheelZoomRatio) || 0.1;\n\n    if (self.disabled) {\n      return;\n    }\n\n    event.preventDefault();\n\n    // Limit wheel speed to prevent zoom too fast\n    if (self.wheeling) {\n      return;\n    }\n\n    self.wheeling = true;\n\n    setTimeout(function () {\n      self.wheeling = false;\n    }, 50);\n\n    var delta = 1;\n\n    if (e.deltaY) {\n      delta = e.deltaY > 0 ? 1 : -1;\n    } else if (e.wheelDelta) {\n      delta = -e.wheelDelta / 120;\n    } else if (e.detail) {\n      delta = e.detail > 0 ? 1 : -1;\n    }\n\n    self.zoom(-delta * ratio, event);\n  },\n  cropStart: function cropStart(e) {\n    var self = this;\n\n    if (self.disabled) {\n      return;\n    }\n\n    var options = self.options;\n    var pointers = self.pointers;\n    var originalEvent = e.originalEvent;\n    var action = void 0;\n\n    if (originalEvent && originalEvent.changedTouches) {\n      // Handle touch event\n      $.each(originalEvent.changedTouches, function (i, touch) {\n        pointers[touch.identifier] = getPointer(touch);\n      });\n    } else {\n      // Handle mouse event and pointer event\n      pointers[originalEvent && originalEvent.pointerId || 0] = getPointer(originalEvent || e);\n    }\n\n    if (objectKeys(pointers).length > 1 && options.zoomable && options.zoomOnTouch) {\n      action = 'zoom';\n    } else {\n      action = $(e.target).data('action');\n    }\n\n    if (!REGEXP_ACTIONS.test(action)) {\n      return;\n    }\n\n    if (self.trigger('cropstart', {\n      originalEvent: originalEvent,\n      action: action\n    }).isDefaultPrevented()) {\n      return;\n    }\n\n    e.preventDefault();\n\n    self.action = action;\n    self.cropping = false;\n\n    if (action === 'crop') {\n      self.cropping = true;\n      self.$dragBox.addClass('cropper-modal');\n    }\n  },\n  cropMove: function cropMove(e) {\n    var self = this;\n    var action = self.action;\n\n    if (self.disabled || !action) {\n      return;\n    }\n\n    var pointers = self.pointers;\n    var originalEvent = e.originalEvent;\n\n    e.preventDefault();\n\n    if (self.trigger('cropmove', {\n      originalEvent: originalEvent,\n      action: action\n    }).isDefaultPrevented()) {\n      return;\n    }\n\n    if (originalEvent && originalEvent.changedTouches) {\n      $.each(originalEvent.changedTouches, function (i, touch) {\n        $.extend(pointers[touch.identifier], getPointer(touch, true));\n      });\n    } else {\n      $.extend(pointers[originalEvent && originalEvent.pointerId || 0], getPointer(originalEvent || e, true));\n    }\n\n    self.change(e);\n  },\n  cropEnd: function cropEnd(e) {\n    var self = this;\n\n    if (self.disabled) {\n      return;\n    }\n\n    var action = self.action;\n    var pointers = self.pointers;\n    var originalEvent = e.originalEvent;\n\n    if (originalEvent && originalEvent.changedTouches) {\n      $.each(originalEvent.changedTouches, function (i, touch) {\n        delete pointers[touch.identifier];\n      });\n    } else {\n      delete pointers[originalEvent && originalEvent.pointerId || 0];\n    }\n\n    if (!action) {\n      return;\n    }\n\n    e.preventDefault();\n\n    if (!objectKeys(pointers).length) {\n      self.action = '';\n    }\n\n    if (self.cropping) {\n      self.cropping = false;\n      self.$dragBox.toggleClass('cropper-modal', self.cropped && self.options.modal);\n    }\n\n    self.trigger('cropend', {\n      originalEvent: originalEvent,\n      action: action\n    });\n  }\n};\n\n// Actions\nvar ACTION_EAST = 'e';\nvar ACTION_WEST = 'w';\nvar ACTION_SOUTH = 's';\nvar ACTION_NORTH = 'n';\nvar ACTION_SOUTH_EAST = 'se';\nvar ACTION_SOUTH_WEST = 'sw';\nvar ACTION_NORTH_EAST = 'ne';\nvar ACTION_NORTH_WEST = 'nw';\n\nfunction getMaxZoomRatio(pointers) {\n  var pointers2 = $.extend({}, pointers);\n  var ratios = [];\n\n  $.each(pointers, function (pointerId, pointer) {\n    delete pointers2[pointerId];\n\n    $.each(pointers2, function (pointerId2, pointer2) {\n      var x1 = Math.abs(pointer.startX - pointer2.startX);\n      var y1 = Math.abs(pointer.startY - pointer2.startY);\n      var x2 = Math.abs(pointer.endX - pointer2.endX);\n      var y2 = Math.abs(pointer.endY - pointer2.endY);\n      var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n      var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n      var ratio = (z2 - z1) / z1;\n\n      ratios.push(ratio);\n    });\n  });\n\n  ratios.sort(function (a, b) {\n    return Math.abs(a) < Math.abs(b);\n  });\n\n  return ratios[0];\n}\n\nvar change$1 = {\n  change: function change(e) {\n    var self = this;\n    var options = self.options;\n    var pointers = self.pointers;\n    var pointer = pointers[objectKeys(pointers)[0]];\n    var container = self.container;\n    var canvas = self.canvas;\n    var cropBox = self.cropBox;\n    var action = self.action;\n    var aspectRatio = options.aspectRatio;\n    var width = cropBox.width;\n    var height = cropBox.height;\n    var left = cropBox.left;\n    var top = cropBox.top;\n    var right = left + width;\n    var bottom = top + height;\n    var minLeft = 0;\n    var minTop = 0;\n    var maxWidth = container.width;\n    var maxHeight = container.height;\n    var renderable = true;\n    var offset = void 0;\n\n    // Locking aspect ratio in \"free mode\" by holding shift key (#259)\n    if (!aspectRatio && e.shiftKey) {\n      aspectRatio = width && height ? width / height : 1;\n    }\n\n    if (self.limited) {\n      minLeft = cropBox.minLeft;\n      minTop = cropBox.minTop;\n      maxWidth = minLeft + Math.min(container.width, canvas.width, canvas.left + canvas.width);\n      maxHeight = minTop + Math.min(container.height, canvas.height, canvas.top + canvas.height);\n    }\n\n    var range = {\n      x: pointer.endX - pointer.startX,\n      y: pointer.endY - pointer.startY\n    };\n\n    if (aspectRatio) {\n      range.X = range.y * aspectRatio;\n      range.Y = range.x / aspectRatio;\n    }\n\n    switch (action) {\n      // Move crop box\n      case 'all':\n        left += range.x;\n        top += range.y;\n        break;\n\n      // Resize crop box\n      case ACTION_EAST:\n        if (range.x >= 0 && (right >= maxWidth || aspectRatio && (top <= minTop || bottom >= maxHeight))) {\n          renderable = false;\n          break;\n        }\n\n        width += range.x;\n\n        if (aspectRatio) {\n          height = width / aspectRatio;\n          top -= range.Y / 2;\n        }\n\n        if (width < 0) {\n          action = ACTION_WEST;\n          width = 0;\n        }\n\n        break;\n\n      case ACTION_NORTH:\n        if (range.y <= 0 && (top <= minTop || aspectRatio && (left <= minLeft || right >= maxWidth))) {\n          renderable = false;\n          break;\n        }\n\n        height -= range.y;\n        top += range.y;\n\n        if (aspectRatio) {\n          width = height * aspectRatio;\n          left += range.X / 2;\n        }\n\n        if (height < 0) {\n          action = ACTION_SOUTH;\n          height = 0;\n        }\n\n        break;\n\n      case ACTION_WEST:\n        if (range.x <= 0 && (left <= minLeft || aspectRatio && (top <= minTop || bottom >= maxHeight))) {\n          renderable = false;\n          break;\n        }\n\n        width -= range.x;\n        left += range.x;\n\n        if (aspectRatio) {\n          height = width / aspectRatio;\n          top += range.Y / 2;\n        }\n\n        if (width < 0) {\n          action = ACTION_EAST;\n          width = 0;\n        }\n\n        break;\n\n      case ACTION_SOUTH:\n        if (range.y >= 0 && (bottom >= maxHeight || aspectRatio && (left <= minLeft || right >= maxWidth))) {\n          renderable = false;\n          break;\n        }\n\n        height += range.y;\n\n        if (aspectRatio) {\n          width = height * aspectRatio;\n          left -= range.X / 2;\n        }\n\n        if (height < 0) {\n          action = ACTION_NORTH;\n          height = 0;\n        }\n\n        break;\n\n      case ACTION_NORTH_EAST:\n        if (aspectRatio) {\n          if (range.y <= 0 && (top <= minTop || right >= maxWidth)) {\n            renderable = false;\n            break;\n          }\n\n          height -= range.y;\n          top += range.y;\n          width = height * aspectRatio;\n        } else {\n          if (range.x >= 0) {\n            if (right < maxWidth) {\n              width += range.x;\n            } else if (range.y <= 0 && top <= minTop) {\n              renderable = false;\n            }\n          } else {\n            width += range.x;\n          }\n\n          if (range.y <= 0) {\n            if (top > minTop) {\n              height -= range.y;\n              top += range.y;\n            }\n          } else {\n            height -= range.y;\n            top += range.y;\n          }\n        }\n\n        if (width < 0 && height < 0) {\n          action = ACTION_SOUTH_WEST;\n          height = 0;\n          width = 0;\n        } else if (width < 0) {\n          action = ACTION_NORTH_WEST;\n          width = 0;\n        } else if (height < 0) {\n          action = ACTION_SOUTH_EAST;\n          height = 0;\n        }\n\n        break;\n\n      case ACTION_NORTH_WEST:\n        if (aspectRatio) {\n          if (range.y <= 0 && (top <= minTop || left <= minLeft)) {\n            renderable = false;\n            break;\n          }\n\n          height -= range.y;\n          top += range.y;\n          width = height * aspectRatio;\n          left += range.X;\n        } else {\n          if (range.x <= 0) {\n            if (left > minLeft) {\n              width -= range.x;\n              left += range.x;\n            } else if (range.y <= 0 && top <= minTop) {\n              renderable = false;\n            }\n          } else {\n            width -= range.x;\n            left += range.x;\n          }\n\n          if (range.y <= 0) {\n            if (top > minTop) {\n              height -= range.y;\n              top += range.y;\n            }\n          } else {\n            height -= range.y;\n            top += range.y;\n          }\n        }\n\n        if (width < 0 && height < 0) {\n          action = ACTION_SOUTH_EAST;\n          height = 0;\n          width = 0;\n        } else if (width < 0) {\n          action = ACTION_NORTH_EAST;\n          width = 0;\n        } else if (height < 0) {\n          action = ACTION_SOUTH_WEST;\n          height = 0;\n        }\n\n        break;\n\n      case ACTION_SOUTH_WEST:\n        if (aspectRatio) {\n          if (range.x <= 0 && (left <= minLeft || bottom >= maxHeight)) {\n            renderable = false;\n            break;\n          }\n\n          width -= range.x;\n          left += range.x;\n          height = width / aspectRatio;\n        } else {\n          if (range.x <= 0) {\n            if (left > minLeft) {\n              width -= range.x;\n              left += range.x;\n            } else if (range.y >= 0 && bottom >= maxHeight) {\n              renderable = false;\n            }\n          } else {\n            width -= range.x;\n            left += range.x;\n          }\n\n          if (range.y >= 0) {\n            if (bottom < maxHeight) {\n              height += range.y;\n            }\n          } else {\n            height += range.y;\n          }\n        }\n\n        if (width < 0 && height < 0) {\n          action = ACTION_NORTH_EAST;\n          height = 0;\n          width = 0;\n        } else if (width < 0) {\n          action = ACTION_SOUTH_EAST;\n          width = 0;\n        } else if (height < 0) {\n          action = ACTION_NORTH_WEST;\n          height = 0;\n        }\n\n        break;\n\n      case ACTION_SOUTH_EAST:\n        if (aspectRatio) {\n          if (range.x >= 0 && (right >= maxWidth || bottom >= maxHeight)) {\n            renderable = false;\n            break;\n          }\n\n          width += range.x;\n          height = width / aspectRatio;\n        } else {\n          if (range.x >= 0) {\n            if (right < maxWidth) {\n              width += range.x;\n            } else if (range.y >= 0 && bottom >= maxHeight) {\n              renderable = false;\n            }\n          } else {\n            width += range.x;\n          }\n\n          if (range.y >= 0) {\n            if (bottom < maxHeight) {\n              height += range.y;\n            }\n          } else {\n            height += range.y;\n          }\n        }\n\n        if (width < 0 && height < 0) {\n          action = ACTION_NORTH_WEST;\n          height = 0;\n          width = 0;\n        } else if (width < 0) {\n          action = ACTION_SOUTH_WEST;\n          width = 0;\n        } else if (height < 0) {\n          action = ACTION_NORTH_EAST;\n          height = 0;\n        }\n\n        break;\n\n      // Move canvas\n      case 'move':\n        self.move(range.x, range.y);\n        renderable = false;\n        break;\n\n      // Zoom canvas\n      case 'zoom':\n        self.zoom(getMaxZoomRatio(pointers), e.originalEvent);\n        renderable = false;\n        break;\n\n      // Create crop box\n      case 'crop':\n        if (!range.x || !range.y) {\n          renderable = false;\n          break;\n        }\n\n        offset = self.$cropper.offset();\n        left = pointer.startX - offset.left;\n        top = pointer.startY - offset.top;\n        width = cropBox.minWidth;\n        height = cropBox.minHeight;\n\n        if (range.x > 0) {\n          action = range.y > 0 ? ACTION_SOUTH_EAST : ACTION_NORTH_EAST;\n        } else if (range.x < 0) {\n          left -= width;\n          action = range.y > 0 ? ACTION_SOUTH_WEST : ACTION_NORTH_WEST;\n        }\n\n        if (range.y < 0) {\n          top -= height;\n        }\n\n        // Show the crop box if is hidden\n        if (!self.cropped) {\n          self.$cropBox.removeClass('cropper-hidden');\n          self.cropped = true;\n\n          if (self.limited) {\n            self.limitCropBox(true, true);\n          }\n        }\n\n        break;\n\n      // No default\n    }\n\n    if (renderable) {\n      cropBox.width = width;\n      cropBox.height = height;\n      cropBox.left = left;\n      cropBox.top = top;\n      self.action = action;\n      self.renderCropBox();\n    }\n\n    // Override\n    $.each(pointers, function (i, p) {\n      p.startX = p.endX;\n      p.startY = p.endY;\n    });\n  }\n};\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n\n\n\n\n\nvar get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar set = function set(object, property, value, receiver) {\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent !== null) {\n      set(parent, property, value, receiver);\n    }\n  } else if (\"value\" in desc && desc.writable) {\n    desc.value = value;\n  } else {\n    var setter = desc.set;\n\n    if (setter !== undefined) {\n      setter.call(receiver, value);\n    }\n  }\n\n  return value;\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar toConsumableArray = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n};\n\nfunction getPointersCenter(pointers) {\n  var pageX = 0;\n  var pageY = 0;\n  var count = 0;\n\n  $.each(pointers, function (i, _ref) {\n    var startX = _ref.startX,\n        startY = _ref.startY;\n\n    pageX += startX;\n    pageY += startY;\n    count += 1;\n  });\n\n  pageX /= count;\n  pageY /= count;\n\n  return {\n    pageX: pageX,\n    pageY: pageY\n  };\n}\n\nvar methods = {\n  // Show the crop box manually\n  crop: function crop() {\n    var self = this;\n\n    if (!self.ready || self.disabled) {\n      return;\n    }\n\n    if (!self.cropped) {\n      self.cropped = true;\n      self.limitCropBox(true, true);\n\n      if (self.options.modal) {\n        self.$dragBox.addClass('cropper-modal');\n      }\n\n      self.$cropBox.removeClass('cropper-hidden');\n    }\n\n    self.setCropBoxData(self.initialCropBox);\n  },\n\n\n  // Reset the image and crop box to their initial states\n  reset: function reset() {\n    var self = this;\n\n    if (!self.ready || self.disabled) {\n      return;\n    }\n\n    self.image = $.extend({}, self.initialImage);\n    self.canvas = $.extend({}, self.initialCanvas);\n    self.cropBox = $.extend({}, self.initialCropBox);\n\n    self.renderCanvas();\n\n    if (self.cropped) {\n      self.renderCropBox();\n    }\n  },\n\n\n  // Clear the crop box\n  clear: function clear() {\n    var self = this;\n\n    if (!self.cropped || self.disabled) {\n      return;\n    }\n\n    $.extend(self.cropBox, {\n      left: 0,\n      top: 0,\n      width: 0,\n      height: 0\n    });\n\n    self.cropped = false;\n    self.renderCropBox();\n\n    self.limitCanvas(true, true);\n\n    // Render canvas after crop box rendered\n    self.renderCanvas();\n\n    self.$dragBox.removeClass('cropper-modal');\n    self.$cropBox.addClass('cropper-hidden');\n  },\n\n\n  /**\n   * Replace the image's src and rebuild the cropper\n   *\n   * @param {String} url\n   * @param {Boolean} onlyColorChanged (optional)\n   */\n  replace: function replace(url, onlyColorChanged) {\n    var self = this;\n\n    if (!self.disabled && url) {\n      if (self.isImg) {\n        self.$element.attr('src', url);\n      }\n\n      if (onlyColorChanged) {\n        self.url = url;\n        self.$clone.attr('src', url);\n\n        if (self.ready) {\n          self.$preview.find('img').add(self.$clone2).attr('src', url);\n        }\n      } else {\n        if (self.isImg) {\n          self.replaced = true;\n        }\n\n        // Clear previous data\n        self.options.data = null;\n        self.load(url);\n      }\n    }\n  },\n\n\n  // Enable (unfreeze) the cropper\n  enable: function enable() {\n    var self = this;\n\n    if (self.ready) {\n      self.disabled = false;\n      self.$cropper.removeClass('cropper-disabled');\n    }\n  },\n\n\n  // Disable (freeze) the cropper\n  disable: function disable() {\n    var self = this;\n\n    if (self.ready) {\n      self.disabled = true;\n      self.$cropper.addClass('cropper-disabled');\n    }\n  },\n\n\n  // Destroy the cropper and remove the instance from the image\n  destroy: function destroy() {\n    var self = this;\n    var $this = self.$element;\n\n    if (self.loaded) {\n      if (self.isImg && self.replaced) {\n        $this.attr('src', self.originalUrl);\n      }\n\n      self.unbuild();\n      $this.removeClass('cropper-hidden');\n    } else if (self.isImg) {\n      $this.off('load', self.start);\n    } else if (self.$clone) {\n      self.$clone.remove();\n    }\n\n    $this.removeData('cropper');\n  },\n\n\n  /**\n   * Move the canvas with relative offsets\n   *\n   * @param {Number} offsetX\n   * @param {Number} offsetY (optional)\n   */\n  move: function move(offsetX, offsetY) {\n    var self = this;\n    var canvas = self.canvas;\n\n    self.moveTo(isUndefined(offsetX) ? offsetX : canvas.left + Number(offsetX), isUndefined(offsetY) ? offsetY : canvas.top + Number(offsetY));\n  },\n\n\n  /**\n   * Move the canvas to an absolute point\n   *\n   * @param {Number} x\n   * @param {Number} y (optional)\n   */\n  moveTo: function moveTo(x, y) {\n    var self = this;\n    var canvas = self.canvas;\n    var changed = false;\n\n    // If \"y\" is not present, its default value is \"x\"\n    if (isUndefined(y)) {\n      y = x;\n    }\n\n    x = Number(x);\n    y = Number(y);\n\n    if (self.ready && !self.disabled && self.options.movable) {\n      if (isNumber(x)) {\n        canvas.left = x;\n        changed = true;\n      }\n\n      if (isNumber(y)) {\n        canvas.top = y;\n        changed = true;\n      }\n\n      if (changed) {\n        self.renderCanvas(true);\n      }\n    }\n  },\n\n\n  /**\n   * Zoom the canvas with a relative ratio\n   *\n   * @param {Number} ratio\n   * @param {jQuery Event} _event (private)\n   */\n  zoom: function zoom(ratio, _event) {\n    var self = this;\n    var canvas = self.canvas;\n\n    ratio = Number(ratio);\n\n    if (ratio < 0) {\n      ratio = 1 / (1 - ratio);\n    } else {\n      ratio = 1 + ratio;\n    }\n\n    self.zoomTo(canvas.width * ratio / canvas.naturalWidth, _event);\n  },\n\n\n  /**\n   * Zoom the canvas to an absolute ratio\n   *\n   * @param {Number} ratio\n   * @param {jQuery Event} _event (private)\n   */\n  zoomTo: function zoomTo(ratio, _event) {\n    var self = this;\n    var options = self.options;\n    var pointers = self.pointers;\n    var canvas = self.canvas;\n    var width = canvas.width;\n    var height = canvas.height;\n    var naturalWidth = canvas.naturalWidth;\n    var naturalHeight = canvas.naturalHeight;\n\n    ratio = Number(ratio);\n\n    if (ratio >= 0 && self.ready && !self.disabled && options.zoomable) {\n      var newWidth = naturalWidth * ratio;\n      var newHeight = naturalHeight * ratio;\n      var originalEvent = void 0;\n\n      if (_event) {\n        originalEvent = _event.originalEvent;\n      }\n\n      if (self.trigger('zoom', {\n        originalEvent: originalEvent,\n        oldRatio: width / naturalWidth,\n        ratio: newWidth / naturalWidth\n      }).isDefaultPrevented()) {\n        return;\n      }\n\n      if (originalEvent) {\n        var offset = self.$cropper.offset();\n        var center = pointers && objectKeys(pointers).length ? getPointersCenter(pointers) : {\n          pageX: _event.pageX || originalEvent.pageX || 0,\n          pageY: _event.pageY || originalEvent.pageY || 0\n        };\n\n        // Zoom from the triggering point of the event\n        canvas.left -= (newWidth - width) * ((center.pageX - offset.left - canvas.left) / width);\n        canvas.top -= (newHeight - height) * ((center.pageY - offset.top - canvas.top) / height);\n      } else {\n        // Zoom from the center of the canvas\n        canvas.left -= (newWidth - width) / 2;\n        canvas.top -= (newHeight - height) / 2;\n      }\n\n      canvas.width = newWidth;\n      canvas.height = newHeight;\n      self.renderCanvas(true);\n    }\n  },\n\n\n  /**\n   * Rotate the canvas with a relative degree\n   *\n   * @param {Number} degree\n   */\n  rotate: function rotate(degree) {\n    var self = this;\n\n    self.rotateTo((self.image.rotate || 0) + Number(degree));\n  },\n\n\n  /**\n   * Rotate the canvas to an absolute degree\n   * https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function#rotate()\n   *\n   * @param {Number} degree\n   */\n  rotateTo: function rotateTo(degree) {\n    var self = this;\n\n    degree = Number(degree);\n\n    if (isNumber(degree) && self.ready && !self.disabled && self.options.rotatable) {\n      self.image.rotate = degree % 360;\n      self.rotated = true;\n      self.renderCanvas(true);\n    }\n  },\n\n\n  /**\n   * Scale the image\n   * https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function#scale()\n   *\n   * @param {Number} scaleX\n   * @param {Number} scaleY (optional)\n   */\n  scale: function scale(scaleX, scaleY) {\n    var self = this;\n    var image = self.image;\n    var changed = false;\n\n    // If \"scaleY\" is not present, its default value is \"scaleX\"\n    if (isUndefined(scaleY)) {\n      scaleY = scaleX;\n    }\n\n    scaleX = Number(scaleX);\n    scaleY = Number(scaleY);\n\n    if (self.ready && !self.disabled && self.options.scalable) {\n      if (isNumber(scaleX)) {\n        image.scaleX = scaleX;\n        changed = true;\n      }\n\n      if (isNumber(scaleY)) {\n        image.scaleY = scaleY;\n        changed = true;\n      }\n\n      if (changed) {\n        self.renderImage(true);\n      }\n    }\n  },\n\n\n  /**\n   * Scale the abscissa of the image\n   *\n   * @param {Number} scaleX\n   */\n  scaleX: function scaleX(_scaleX) {\n    var self = this;\n    var scaleY = self.image.scaleY;\n\n    self.scale(_scaleX, isNumber(scaleY) ? scaleY : 1);\n  },\n\n\n  /**\n   * Scale the ordinate of the image\n   *\n   * @param {Number} scaleY\n   */\n  scaleY: function scaleY(_scaleY) {\n    var self = this;\n    var scaleX = self.image.scaleX;\n\n    self.scale(isNumber(scaleX) ? scaleX : 1, _scaleY);\n  },\n\n\n  /**\n   * Get the cropped area position and size data (base on the original image)\n   *\n   * @param {Boolean} isRounded (optional)\n   * @return {Object} data\n   */\n  getData: function getData(isRounded) {\n    var self = this;\n    var options = self.options;\n    var image = self.image;\n    var canvas = self.canvas;\n    var cropBox = self.cropBox;\n    var ratio = void 0;\n    var data = void 0;\n\n    if (self.ready && self.cropped) {\n      data = {\n        x: cropBox.left - canvas.left,\n        y: cropBox.top - canvas.top,\n        width: cropBox.width,\n        height: cropBox.height\n      };\n\n      ratio = image.width / image.naturalWidth;\n\n      $.each(data, function (i, n) {\n        n /= ratio;\n        data[i] = isRounded ? Math.round(n) : n;\n      });\n    } else {\n      data = {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0\n      };\n    }\n\n    if (options.rotatable) {\n      data.rotate = image.rotate || 0;\n    }\n\n    if (options.scalable) {\n      data.scaleX = image.scaleX || 1;\n      data.scaleY = image.scaleY || 1;\n    }\n\n    return data;\n  },\n\n\n  /**\n   * Set the cropped area position and size with new data\n   *\n   * @param {Object} data\n   */\n  setData: function setData(data) {\n    var self = this;\n    var options = self.options;\n    var image = self.image;\n    var canvas = self.canvas;\n    var cropBoxData = {};\n    var rotated = void 0;\n    var isScaled = void 0;\n    var ratio = void 0;\n\n    if ($.isFunction(data)) {\n      data = data.call(self.element);\n    }\n\n    if (self.ready && !self.disabled && $.isPlainObject(data)) {\n      if (options.rotatable) {\n        if (isNumber(data.rotate) && data.rotate !== image.rotate) {\n          image.rotate = data.rotate;\n          self.rotated = rotated = true;\n        }\n      }\n\n      if (options.scalable) {\n        if (isNumber(data.scaleX) && data.scaleX !== image.scaleX) {\n          image.scaleX = data.scaleX;\n          isScaled = true;\n        }\n\n        if (isNumber(data.scaleY) && data.scaleY !== image.scaleY) {\n          image.scaleY = data.scaleY;\n          isScaled = true;\n        }\n      }\n\n      if (rotated) {\n        self.renderCanvas();\n      } else if (isScaled) {\n        self.renderImage();\n      }\n\n      ratio = image.width / image.naturalWidth;\n\n      if (isNumber(data.x)) {\n        cropBoxData.left = data.x * ratio + canvas.left;\n      }\n\n      if (isNumber(data.y)) {\n        cropBoxData.top = data.y * ratio + canvas.top;\n      }\n\n      if (isNumber(data.width)) {\n        cropBoxData.width = data.width * ratio;\n      }\n\n      if (isNumber(data.height)) {\n        cropBoxData.height = data.height * ratio;\n      }\n\n      self.setCropBoxData(cropBoxData);\n    }\n  },\n\n\n  /**\n   * Get the container size data\n   *\n   * @return {Object} data\n   */\n  getContainerData: function getContainerData() {\n    return this.ready ? this.container : {};\n  },\n\n\n  /**\n   * Get the image position and size data\n   *\n   * @return {Object} data\n   */\n  getImageData: function getImageData() {\n    return this.loaded ? this.image : {};\n  },\n\n\n  /**\n   * Get the canvas position and size data\n   *\n   * @return {Object} data\n   */\n  getCanvasData: function getCanvasData() {\n    var self = this;\n    var canvas = self.canvas;\n    var data = {};\n\n    if (self.ready) {\n      $.each(['left', 'top', 'width', 'height', 'naturalWidth', 'naturalHeight'], function (i, n) {\n        data[n] = canvas[n];\n      });\n    }\n\n    return data;\n  },\n\n\n  /**\n   * Set the canvas position and size with new data\n   *\n   * @param {Object} data\n   */\n  setCanvasData: function setCanvasData(data) {\n    var self = this;\n    var canvas = self.canvas;\n    var aspectRatio = canvas.aspectRatio;\n\n    if ($.isFunction(data)) {\n      data = data.call(self.$element);\n    }\n\n    if (self.ready && !self.disabled && $.isPlainObject(data)) {\n      if (isNumber(data.left)) {\n        canvas.left = data.left;\n      }\n\n      if (isNumber(data.top)) {\n        canvas.top = data.top;\n      }\n\n      if (isNumber(data.width)) {\n        canvas.width = data.width;\n        canvas.height = data.width / aspectRatio;\n      } else if (isNumber(data.height)) {\n        canvas.height = data.height;\n        canvas.width = data.height * aspectRatio;\n      }\n\n      self.renderCanvas(true);\n    }\n  },\n\n\n  /**\n   * Get the crop box position and size data\n   *\n   * @return {Object} data\n   */\n  getCropBoxData: function getCropBoxData() {\n    var self = this;\n    var cropBox = self.cropBox;\n\n    return self.ready && self.cropped ? {\n      left: cropBox.left,\n      top: cropBox.top,\n      width: cropBox.width,\n      height: cropBox.height\n    } : {};\n  },\n\n\n  /**\n   * Set the crop box position and size with new data\n   *\n   * @param {Object} data\n   */\n  setCropBoxData: function setCropBoxData(data) {\n    var self = this;\n    var cropBox = self.cropBox;\n    var aspectRatio = self.options.aspectRatio;\n    var widthChanged = void 0;\n    var heightChanged = void 0;\n\n    if ($.isFunction(data)) {\n      data = data.call(self.$element);\n    }\n\n    if (self.ready && self.cropped && !self.disabled && $.isPlainObject(data)) {\n      if (isNumber(data.left)) {\n        cropBox.left = data.left;\n      }\n\n      if (isNumber(data.top)) {\n        cropBox.top = data.top;\n      }\n\n      if (isNumber(data.width) && data.width !== cropBox.width) {\n        widthChanged = true;\n        cropBox.width = data.width;\n      }\n\n      if (isNumber(data.height) && data.height !== cropBox.height) {\n        heightChanged = true;\n        cropBox.height = data.height;\n      }\n\n      if (aspectRatio) {\n        if (widthChanged) {\n          cropBox.height = cropBox.width / aspectRatio;\n        } else if (heightChanged) {\n          cropBox.width = cropBox.height * aspectRatio;\n        }\n      }\n\n      self.renderCropBox();\n    }\n  },\n\n\n  /**\n   * Get a canvas drawn the cropped image\n   *\n   * @param {Object} options (optional)\n   * @return {HTMLCanvasElement} canvas\n   */\n  getCroppedCanvas: function getCroppedCanvas(options) {\n    var self = this;\n\n    if (!self.ready || !window.HTMLCanvasElement) {\n      return null;\n    }\n\n    if (!$.isPlainObject(options)) {\n      options = {};\n    }\n\n    if (!self.cropped) {\n      return getSourceCanvas(self.$clone[0], self.image, options);\n    }\n\n    var data = self.getData();\n    var originalWidth = data.width;\n    var originalHeight = data.height;\n    var aspectRatio = originalWidth / originalHeight;\n    var scaledWidth = void 0;\n    var scaledHeight = void 0;\n    var scaledRatio = void 0;\n\n    if ($.isPlainObject(options)) {\n      scaledWidth = options.width;\n      scaledHeight = options.height;\n\n      if (scaledWidth) {\n        scaledHeight = scaledWidth / aspectRatio;\n        scaledRatio = scaledWidth / originalWidth;\n      } else if (scaledHeight) {\n        scaledWidth = scaledHeight * aspectRatio;\n        scaledRatio = scaledHeight / originalHeight;\n      }\n    }\n\n    // The canvas element will use `Math.Math.floor` on a float number, so Math.floor first\n    var canvasWidth = Math.floor(scaledWidth || originalWidth);\n    var canvasHeight = Math.floor(scaledHeight || originalHeight);\n\n    var canvas = $('<canvas>')[0];\n    var context = canvas.getContext('2d');\n\n    canvas.width = canvasWidth;\n    canvas.height = canvasHeight;\n\n    if (options.fillColor) {\n      context.fillStyle = options.fillColor;\n      context.fillRect(0, 0, canvasWidth, canvasHeight);\n    }\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D.drawImage\n    var parameters = function () {\n      var source = getSourceCanvas(self.$clone[0], self.image, options);\n      var sourceWidth = source.width;\n      var sourceHeight = source.height;\n      var canvasData = self.canvas;\n      var params = [source];\n\n      // Source canvas\n      var srcX = data.x + canvasData.naturalWidth * (Math.abs(data.scaleX || 1) - 1) / 2;\n      var srcY = data.y + canvasData.naturalHeight * (Math.abs(data.scaleY || 1) - 1) / 2;\n      var srcWidth = void 0;\n      var srcHeight = void 0;\n\n      // Destination canvas\n      var dstX = void 0;\n      var dstY = void 0;\n      var dstWidth = void 0;\n      var dstHeight = void 0;\n\n      if (srcX <= -originalWidth || srcX > sourceWidth) {\n        srcX = srcWidth = dstX = dstWidth = 0;\n      } else if (srcX <= 0) {\n        dstX = -srcX;\n        srcX = 0;\n        srcWidth = dstWidth = Math.min(sourceWidth, originalWidth + srcX);\n      } else if (srcX <= sourceWidth) {\n        dstX = 0;\n        srcWidth = dstWidth = Math.min(originalWidth, sourceWidth - srcX);\n      }\n\n      if (srcWidth <= 0 || srcY <= -originalHeight || srcY > sourceHeight) {\n        srcY = srcHeight = dstY = dstHeight = 0;\n      } else if (srcY <= 0) {\n        dstY = -srcY;\n        srcY = 0;\n        srcHeight = dstHeight = Math.min(sourceHeight, originalHeight + srcY);\n      } else if (srcY <= sourceHeight) {\n        dstY = 0;\n        srcHeight = dstHeight = Math.min(originalHeight, sourceHeight - srcY);\n      }\n\n      // All the numerical parameters should be integer for `drawImage` (#476)\n      params.push(Math.floor(srcX), Math.floor(srcY), Math.floor(srcWidth), Math.floor(srcHeight));\n\n      // Scale destination sizes\n      if (scaledRatio) {\n        dstX *= scaledRatio;\n        dstY *= scaledRatio;\n        dstWidth *= scaledRatio;\n        dstHeight *= scaledRatio;\n      }\n\n      // Avoid \"IndexSizeError\" in IE and Firefox\n      if (dstWidth > 0 && dstHeight > 0) {\n        params.push(Math.floor(dstX), Math.floor(dstY), Math.floor(dstWidth), Math.floor(dstHeight));\n      }\n\n      return params;\n    }();\n\n    context.imageSmoothingEnabled = !!options.imageSmoothingEnabled;\n\n    if (options.imageSmoothingQuality) {\n      context.imageSmoothingQuality = options.imageSmoothingQuality;\n    }\n\n    context.drawImage.apply(context, toConsumableArray(parameters));\n\n    return canvas;\n  },\n\n\n  /**\n   * Change the aspect ratio of the crop box\n   *\n   * @param {Number} aspectRatio\n   */\n  setAspectRatio: function setAspectRatio(aspectRatio) {\n    var self = this;\n    var options = self.options;\n\n    if (!self.disabled && !isUndefined(aspectRatio)) {\n      // 0 -> NaN\n      options.aspectRatio = Math.max(0, aspectRatio) || NaN;\n\n      if (self.ready) {\n        self.initCropBox();\n\n        if (self.cropped) {\n          self.renderCropBox();\n        }\n      }\n    }\n  },\n\n\n  /**\n   * Change the drag mode\n   *\n   * @param {String} mode (optional)\n   */\n  setDragMode: function setDragMode(mode) {\n    var self = this;\n    var options = self.options;\n    var croppable = void 0;\n    var movable = void 0;\n\n    if (self.loaded && !self.disabled) {\n      croppable = mode === 'crop';\n      movable = options.movable && mode === 'move';\n      mode = croppable || movable ? mode : 'none';\n\n      self.$dragBox.data('action', mode).toggleClass('cropper-crop', croppable).toggleClass('cropper-move', movable);\n\n      if (!options.cropBoxMovable) {\n        // Sync drag mode to crop box when it is not movable(#300)\n        self.$face.data('action', mode).toggleClass('cropper-crop', croppable).toggleClass('cropper-move', movable);\n      }\n    }\n  }\n};\n\nvar CLASS_HIDDEN = 'cropper-hidden';\nvar REGEXP_DATA_URL = /^data:/;\nvar REGEXP_DATA_URL_JPEG = /^data:image\\/jpeg;base64,/;\n\nvar Cropper = function () {\n  function Cropper(element, options) {\n    classCallCheck(this, Cropper);\n\n    var self = this;\n\n    self.$element = $(element);\n    self.options = $.extend({}, DEFAULTS, $.isPlainObject(options) && options);\n    self.loaded = false;\n    self.ready = false;\n    self.completed = false;\n    self.rotated = false;\n    self.cropped = false;\n    self.disabled = false;\n    self.replaced = false;\n    self.limited = false;\n    self.wheeling = false;\n    self.isImg = false;\n    self.originalUrl = '';\n    self.canvas = null;\n    self.cropBox = null;\n    self.pointers = {};\n    self.init();\n  }\n\n  createClass(Cropper, [{\n    key: 'init',\n    value: function init() {\n      var self = this;\n      var $this = self.$element;\n      var url = void 0;\n\n      if ($this.is('img')) {\n        self.isImg = true;\n\n        // Should use `$.fn.attr` here. e.g.: \"img/picture.jpg\"\n        self.originalUrl = url = $this.attr('src');\n\n        // Stop when it's a blank image\n        if (!url) {\n          return;\n        }\n\n        // Should use `$.fn.prop` here. e.g.: \"http://example.com/img/picture.jpg\"\n        url = $this.prop('src');\n      } else if ($this.is('canvas') && window.HTMLCanvasElement) {\n        url = $this[0].toDataURL();\n      }\n\n      self.load(url);\n    }\n\n    // A shortcut for triggering custom events\n\n  }, {\n    key: 'trigger',\n    value: function trigger(type, data) {\n      var e = $.Event(type, data);\n\n      this.$element.trigger(e);\n\n      return e;\n    }\n  }, {\n    key: 'load',\n    value: function load(url) {\n      var self = this;\n      var options = self.options;\n      var $this = self.$element;\n\n      if (!url) {\n        return;\n      }\n\n      self.url = url;\n      self.image = {};\n\n      if (!options.checkOrientation || !window.ArrayBuffer) {\n        self.clone();\n        return;\n      }\n\n      // XMLHttpRequest disallows to open a Data URL in some browsers like IE11 and Safari\n      if (REGEXP_DATA_URL.test(url)) {\n        if (REGEXP_DATA_URL_JPEG.test(url)) {\n          self.read(dataURLToArrayBuffer(url));\n        } else {\n          self.clone();\n        }\n        return;\n      }\n\n      var xhr = new XMLHttpRequest();\n\n      xhr.onerror = xhr.onabort = $.proxy(function () {\n        self.clone();\n      }, this);\n\n      xhr.onload = function load() {\n        self.read(this.response);\n      };\n\n      if (options.checkCrossOrigin && isCrossOriginURL(url) && $this.prop('crossOrigin')) {\n        url = addTimestamp(url);\n      }\n\n      xhr.open('get', url);\n      xhr.responseType = 'arraybuffer';\n      xhr.withCredentials = $this.prop('crossOrigin') === 'use-credentials';\n      xhr.send();\n    }\n  }, {\n    key: 'read',\n    value: function read(arrayBuffer) {\n      var self = this;\n      var options = self.options;\n      var orientation = getOrientation(arrayBuffer);\n      var image = self.image;\n      var rotate = 0;\n      var scaleX = 1;\n      var scaleY = 1;\n\n      if (orientation > 1) {\n        self.url = arrayBufferToDataURL(arrayBuffer);\n\n        switch (orientation) {\n\n          // flip horizontal\n          case 2:\n            scaleX = -1;\n            break;\n\n          // rotate left 180\n          case 3:\n            rotate = -180;\n            break;\n\n          // flip vertical\n          case 4:\n            scaleY = -1;\n            break;\n\n          // flip vertical + rotate right 90\n          case 5:\n            rotate = 90;\n            scaleY = -1;\n            break;\n\n          // rotate right 90\n          case 6:\n            rotate = 90;\n            break;\n\n          // flip horizontal + rotate right 90\n          case 7:\n            rotate = 90;\n            scaleX = -1;\n            break;\n\n          // rotate left 90\n          case 8:\n            rotate = -90;\n            break;\n        }\n      }\n\n      if (options.rotatable) {\n        image.rotate = rotate;\n      }\n\n      if (options.scalable) {\n        image.scaleX = scaleX;\n        image.scaleY = scaleY;\n      }\n\n      self.clone();\n    }\n  }, {\n    key: 'clone',\n    value: function clone() {\n      var self = this;\n      var options = self.options;\n      var $this = self.$element;\n      var url = self.url;\n      var crossOrigin = '';\n      var crossOriginUrl = void 0;\n\n      if (options.checkCrossOrigin && isCrossOriginURL(url)) {\n        crossOrigin = $this.prop('crossOrigin');\n\n        if (crossOrigin) {\n          crossOriginUrl = url;\n        } else {\n          crossOrigin = 'anonymous';\n\n          // Bust cache (#148) when there is not a \"crossOrigin\" property\n          crossOriginUrl = addTimestamp(url);\n        }\n      }\n\n      self.crossOrigin = crossOrigin;\n      self.crossOriginUrl = crossOriginUrl;\n\n      var image = document.createElement('img');\n\n      if (crossOrigin) {\n        image.crossOrigin = crossOrigin;\n      }\n\n      image.src = crossOriginUrl || url;\n\n      var $clone = $(image);\n\n      self.$clone = $clone;\n\n      if (self.isImg) {\n        if ($this[0].complete) {\n          self.start();\n        } else {\n          $this.one('load', $.proxy(self.start, this));\n        }\n      } else {\n        $clone.one('load', $.proxy(self.start, this)).one('error', $.proxy(self.stop, this)).addClass('cropper-hide').insertAfter($this);\n      }\n    }\n  }, {\n    key: 'start',\n    value: function start() {\n      var self = this;\n      var $clone = self.$clone;\n      var $image = self.$element;\n\n      if (!self.isImg) {\n        $clone.off('error', self.stop);\n        $image = $clone;\n      }\n\n      getImageSize($image[0], function (naturalWidth, naturalHeight) {\n        $.extend(self.image, {\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight,\n          aspectRatio: naturalWidth / naturalHeight\n        });\n\n        self.loaded = true;\n        self.build();\n      });\n    }\n  }, {\n    key: 'stop',\n    value: function stop() {\n      var self = this;\n\n      self.$clone.remove();\n      self.$clone = null;\n    }\n  }, {\n    key: 'build',\n    value: function build() {\n      var self = this;\n      var options = self.options;\n      var $this = self.$element;\n      var $clone = self.$clone;\n      var $cropper = void 0;\n      var $cropBox = void 0;\n      var $face = void 0;\n\n      if (!self.loaded) {\n        return;\n      }\n\n      // Unbuild first when replace\n      if (self.ready) {\n        self.unbuild();\n      }\n\n      // Create cropper elements\n      self.$container = $this.parent();\n      self.$cropper = $cropper = $(TEMPLATE);\n      self.$canvas = $cropper.find('.cropper-canvas').append($clone);\n      self.$dragBox = $cropper.find('.cropper-drag-box');\n      self.$cropBox = $cropBox = $cropper.find('.cropper-crop-box');\n      self.$viewBox = $cropper.find('.cropper-view-box');\n      self.$face = $face = $cropBox.find('.cropper-face');\n\n      // Hide the original image\n      $this.addClass(CLASS_HIDDEN).after($cropper);\n\n      // Show the clone image if is hidden\n      if (!self.isImg) {\n        $clone.removeClass('cropper-hide');\n      }\n\n      self.initPreview();\n      self.bind();\n\n      options.aspectRatio = Math.max(0, options.aspectRatio) || NaN;\n      options.viewMode = Math.max(0, Math.min(3, Math.round(options.viewMode))) || 0;\n\n      self.cropped = options.autoCrop;\n\n      if (options.autoCrop) {\n        if (options.modal) {\n          self.$dragBox.addClass('cropper-modal');\n        }\n      } else {\n        $cropBox.addClass(CLASS_HIDDEN);\n      }\n\n      if (!options.guides) {\n        $cropBox.find('.cropper-dashed').addClass(CLASS_HIDDEN);\n      }\n\n      if (!options.center) {\n        $cropBox.find('.cropper-center').addClass(CLASS_HIDDEN);\n      }\n\n      if (options.cropBoxMovable) {\n        $face.addClass('cropper-move').data('action', 'all');\n      }\n\n      if (!options.highlight) {\n        $face.addClass('cropper-invisible');\n      }\n\n      if (options.background) {\n        $cropper.addClass('cropper-bg');\n      }\n\n      if (!options.cropBoxResizable) {\n        $cropBox.find('.cropper-line, .cropper-point').addClass(CLASS_HIDDEN);\n      }\n\n      self.setDragMode(options.dragMode);\n      self.render();\n      self.ready = true;\n      self.setData(options.data);\n\n      // Trigger the ready event asynchronously to keep `data('cropper')` is defined\n      self.completing = setTimeout(function () {\n        if ($.isFunction(options.ready)) {\n          $this.one('ready', options.ready);\n        }\n\n        self.trigger('ready');\n        self.trigger('crop', self.getData());\n        self.completed = true;\n      }, 0);\n    }\n  }, {\n    key: 'unbuild',\n    value: function unbuild() {\n      var self = this;\n\n      if (!self.ready) {\n        return;\n      }\n\n      if (!self.completed) {\n        clearTimeout(self.completing);\n      }\n\n      self.ready = false;\n      self.completed = false;\n      self.initialImage = null;\n\n      // Clear `initialCanvas` is necessary when replace\n      self.initialCanvas = null;\n      self.initialCropBox = null;\n      self.container = null;\n      self.canvas = null;\n\n      // Clear `cropBox` is necessary when replace\n      self.cropBox = null;\n      self.unbind();\n\n      self.resetPreview();\n      self.$preview = null;\n\n      self.$viewBox = null;\n      self.$cropBox = null;\n      self.$dragBox = null;\n      self.$canvas = null;\n      self.$container = null;\n\n      self.$cropper.remove();\n      self.$cropper = null;\n    }\n  }], [{\n    key: 'setDefaults',\n    value: function setDefaults(options) {\n      $.extend(DEFAULTS, $.isPlainObject(options) && options);\n    }\n  }]);\n  return Cropper;\n}();\n\n$.extend(Cropper.prototype, render$1);\n$.extend(Cropper.prototype, preview$1);\n$.extend(Cropper.prototype, events);\n$.extend(Cropper.prototype, handlers);\n$.extend(Cropper.prototype, change$1);\n$.extend(Cropper.prototype, methods);\n\nvar NAMESPACE = 'cropper';\nvar OtherCropper = $.fn.cropper;\n\n$.fn.cropper = function jQueryCropper(option) {\n  for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  var result = void 0;\n\n  this.each(function (i, element) {\n    var $this = $(element);\n    var data = $this.data(NAMESPACE);\n\n    if (!data) {\n      if (/destroy/.test(option)) {\n        return;\n      }\n\n      var options = $.extend({}, $this.data(), $.isPlainObject(option) && option);\n      $this.data(NAMESPACE, data = new Cropper(element, options));\n    }\n\n    if (typeof option === 'string') {\n      var fn = data[option];\n\n      if ($.isFunction(fn)) {\n        result = fn.apply(data, args);\n      }\n    }\n  });\n\n  return typeof result !== 'undefined' ? result : this;\n};\n\n$.fn.cropper.Constructor = Cropper;\n$.fn.cropper.setDefaults = Cropper.setDefaults;\n\n// No conflict\n$.fn.cropper.noConflict = function noConflict() {\n  $.fn.cropper = OtherCropper;\n  return this;\n};\n\n})));\n"]}